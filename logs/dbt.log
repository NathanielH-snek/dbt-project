[0m09:56:15.868258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fdfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050fd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407c0b0>]}


============================== 09:56:15.871127 | 9ab9972b-4ade-4174-a125-6d40ab6280c7 ==============================
[0m09:56:15.871127 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:56:15.871486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:17.174347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:56:17.174748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f500>]}
[0m09:56:17.257424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2fe00>]}
[0m09:56:17.294557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdbda0>]}
[0m09:56:17.295063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:56:17.317085 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:56:17.317725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:17.317964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10523f560>]}
[0m09:56:18.018414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:56:18.024191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051418b0>]}
[0m09:56:18.074345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df3140>]}
[0m09:56:18.074647 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:56:18.074845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057efc80>]}
[0m09:56:18.075837 [info ] [MainThread]: 
[0m09:56:18.076140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:56:18.078550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:56:18.116730 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:56:18.116989 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:56:18.117159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.263774 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.146 seconds
[0m09:56:18.265566 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:56:18.267263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:56:18.267871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:56:18.273780 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.275431 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.275768 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:56:18.276064 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:56:18.276328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:56:18.276600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:18.377691 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.378287 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m09:56:18.378931 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:56:18.379416 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:56:18.379919 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:56:18.380487 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:56:18.404606 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:56:18.405271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m09:56:18.408106 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:56:18.410372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:56:18.421693 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:56:18.422252 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:56:18.431394 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.431951 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.432423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:56:18.537799 [debug] [MainThread]: SQL status: BEGIN in 0.105 seconds
[0m09:56:18.538854 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.539622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:56:18.566751 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m09:56:18.571605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057794c0>]}
[0m09:56:18.572635 [debug] [MainThread]: On master: ROLLBACK
[0m09:56:18.581812 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.582671 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.601926 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:56:18.603558 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.604494 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.605154 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.613824 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:56:18.614992 [debug] [MainThread]: On master: Close
[0m09:56:18.616353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:56:18.617215 [info ] [MainThread]: 
[0m09:56:18.622629 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:56:18.623851 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:56:18.624609 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:56:18.625494 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:56:18.626564 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:56:18.627371 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:56:18.628182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:56:18.628892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:56:18.629614 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:56:18.630176 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:56:18.630713 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:56:18.631214 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:56:18.640294 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:56:18.643527 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:56:18.646281 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:56:18.647718 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:56:18.648165 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:56:18.648580 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:56:18.686685 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:56:18.687029 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:56:18.689008 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:56:18.689954 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.690250 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:56:18.690527 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.690805 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.691018 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:56:18.691256 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:56:18.691489 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:56:18.691782 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:56:18.692000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:18.786450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.786856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m09:56:18.787244 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:56:18.787581 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:56:18.787923 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales;
  );
[0m09:56:18.788290 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers;
  );
[0m09:56:18.798906 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM raw_sales;
                       ^

[0m09:56:18.799277 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM raw_customers;
                           ^

[0m09:56:18.799625 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:56:18.799946 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:56:18.803208 [debug] [Thread-2 (]: SQL status: BEGIN in 0.111 seconds
[0m09:56:18.803546 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:56:18.803885 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products;
  );
[0m09:56:18.810410 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:56:18.810870 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:56:18.815719 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM raw_products;
                          ^

[0m09:56:18.816362 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:56:18.819286 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.820662 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.822055 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447f80>]}
[0m09:56:18.822462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5850>]}
[0m09:56:18.823026 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.19s]
[0m09:56:18.823524 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:56:18.824006 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:56:18.824416 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:56:18.825488 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:56:18.825834 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:56:18.826155 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:56:18.826540 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m09:56:18.826858 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:56:18.827230 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:56:18.827608 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:56:18.827933 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:56:18.828286 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:56:18.828721 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m09:56:18.830958 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.831307 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab9972b-4ade-4174-a125-6d40ab6280c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106368920>]}
[0m09:56:18.831788 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:56:18.832239 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:56:18.833129 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.833398 [debug] [MainThread]: On master: BEGIN
[0m09:56:18.833617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:56:18.934442 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m09:56:18.935015 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.935410 [debug] [MainThread]: Using postgres connection "master"
[0m09:56:18.935780 [debug] [MainThread]: On master: COMMIT
[0m09:56:18.947744 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:56:18.948131 [debug] [MainThread]: On master: Close
[0m09:56:18.948731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:18.949090 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:56:18.949421 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:56:18.949740 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:56:18.950197 [info ] [MainThread]: 
[0m09:56:18.950609 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m09:56:18.951802 [debug] [MainThread]: Command end result
[0m09:56:18.981802 [info ] [MainThread]: 
[0m09:56:18.982217 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:56:18.982483 [info ] [MainThread]: 
[0m09:56:18.982815 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM raw_sales;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:56:18.983075 [info ] [MainThread]: 
[0m09:56:18.983365 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM raw_customers;
                             ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:56:18.983607 [info ] [MainThread]: 
[0m09:56:18.983889 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM raw_products;
                            ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:56:18.984133 [info ] [MainThread]: 
[0m09:56:18.984390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:56:18.998358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1822715, "process_user_time": 2.035665, "process_kernel_time": 0.209253, "process_mem_max_rss": "140115968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:56:18.998864 [debug] [MainThread]: Command `dbt run` failed at 09:56:18.998792 after 3.18 seconds
[0m09:56:18.999192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104764b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105142000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc890>]}
[0m09:56:18.999500 [debug] [MainThread]: Flushing usage events
[0m09:57:24.329741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f5cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb4110>]}


============================== 09:57:24.333104 | c322a947-d386-4167-a618-6ea445755716 ==============================
[0m09:57:24.333104 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:57:24.333462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:24.369099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:57:24.369403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090475f0>]}
[0m09:57:24.431253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0620>]}
[0m09:57:24.467473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c114f0>]}
[0m09:57:24.468006 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:57:24.477430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:57:24.540520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:57:24.540898 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:57:24.541115 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:57:24.541329 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:57:24.681317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:57:24.687723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095be810>]}
[0m09:57:24.736615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670230>]}
[0m09:57:24.736923 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:57:24.737118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c81af0>]}
[0m09:57:24.738170 [info ] [MainThread]: 
[0m09:57:24.738493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:24.740840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:57:24.768408 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:57:24.768663 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:57:24.768829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:24.916974 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.148 seconds
[0m09:57:24.919016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:57:24.920737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m09:57:24.921291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m09:57:24.927832 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:24.929515 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:24.929868 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:57:24.930161 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:57:24.930444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:24.930705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:25.052158 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:57:25.053030 [debug] [ThreadPool]: SQL status: BEGIN in 0.122 seconds
[0m09:57:25.053801 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:57:25.054299 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:57:25.054820 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:57:25.055361 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:25.071451 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m09:57:25.072101 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:57:25.074562 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:57:25.076622 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:57:25.087943 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:57:25.088811 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:57:25.097065 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.097640 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.098095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:25.225433 [debug] [MainThread]: SQL status: BEGIN in 0.127 seconds
[0m09:57:25.226717 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.227677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:25.246198 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m09:57:25.251025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b6930>]}
[0m09:57:25.252305 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:25.265375 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.266145 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.289479 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:57:25.290909 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.291896 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.292956 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.305269 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:57:25.305823 [debug] [MainThread]: On master: Close
[0m09:57:25.306898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:57:25.307473 [info ] [MainThread]: 
[0m09:57:25.311675 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:57:25.312411 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:57:25.313226 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:57:25.313881 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:57:25.314644 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:57:25.315363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m09:57:25.316060 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:57:25.316676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m09:57:25.317507 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:57:25.318169 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:57:25.318684 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:57:25.329099 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:57:25.329762 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:57:25.334453 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:57:25.337267 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:57:25.337984 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:57:25.344286 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:57:25.363054 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:57:25.380554 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:57:25.380890 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:57:25.382657 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:57:25.383197 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.383499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.383734 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:57:25.383951 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.384172 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:57:25.384385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:25.384586 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:57:25.384780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:57:25.385067 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:57:25.478618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m09:57:25.479040 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:57:25.479362 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM customers;
  );
[0m09:57:25.487146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.102 seconds
[0m09:57:25.487430 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:57:25.487721 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM products;
  );
[0m09:57:25.491122 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: FROM customers;
                       ^

[0m09:57:25.491415 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: ROLLBACK
[0m09:57:25.499671 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM products;
                      ^

[0m09:57:25.500040 [debug] [Thread-3 (]: SQL status: BEGIN in 0.115 seconds
[0m09:57:25.500388 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: ROLLBACK
[0m09:57:25.500743 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:57:25.501147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM sales;
  );
[0m09:57:25.502669 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:57:25.506773 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.508027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b170>]}
[0m09:57:25.508559 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_customers ...................... [[31mERROR[0m in 0.19s]
[0m09:57:25.509075 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:57:25.511138 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:57:25.512377 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24: FROM sales;
                   ^

[0m09:57:25.512693 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: ROLLBACK
[0m09:57:25.513865 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.514190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109619dc0>]}
[0m09:57:25.514643 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.20s]
[0m09:57:25.515079 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:57:25.523885 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:57:25.525865 [debug] [Thread-3 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.526184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c322a947-d386-4167-a618-6ea445755716', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e3d70>]}
[0m09:57:25.526601 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.21s]
[0m09:57:25.527029 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:57:25.527660 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:57:25.527989 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:57:25.528335 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m09:57:25.528652 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.orders_by_customer ................................. [[33mSKIP[0m]
[0m09:57:25.529016 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.orders_by_day ...................................... [[33mSKIP[0m]
[0m09:57:25.529335 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m09:57:25.529702 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:57:25.530048 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:57:25.530381 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m09:57:25.531349 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.531619 [debug] [MainThread]: On master: BEGIN
[0m09:57:25.531857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:57:25.643923 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m09:57:25.644520 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.644931 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:25.645315 [debug] [MainThread]: On master: COMMIT
[0m09:57:25.655785 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m09:57:25.656163 [debug] [MainThread]: On master: Close
[0m09:57:25.656743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:25.657097 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:57:25.657430 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_products' was properly closed.
[0m09:57:25.657747 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m09:57:25.658217 [info ] [MainThread]: 
[0m09:57:25.658634 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:57:25.659830 [debug] [MainThread]: Command end result
[0m09:57:25.687411 [info ] [MainThread]: 
[0m09:57:25.687833 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:57:25.688105 [info ] [MainThread]: 
[0m09:57:25.688447 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  syntax error at or near ";"
  LINE 25: FROM customers;
                         ^
  compiled code at target/run/ecommerce_project/models/staging/stg_customers.sql
[0m09:57:25.688700 [info ] [MainThread]: 
[0m09:57:25.688985 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  syntax error at or near ";"
  LINE 20: FROM products;
                        ^
  compiled code at target/run/ecommerce_project/models/staging/stg_products.sql
[0m09:57:25.689231 [info ] [MainThread]: 
[0m09:57:25.689510 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  syntax error at or near ";"
  LINE 24: FROM sales;
                     ^
  compiled code at target/run/ecommerce_project/models/staging/stg_sales.sql
[0m09:57:25.689751 [info ] [MainThread]: 
[0m09:57:25.690006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 TOTAL=6
[0m09:57:25.691282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3996309, "process_user_time": 1.373889, "process_kernel_time": 0.15575, "process_mem_max_rss": "134873088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:25.691775 [debug] [MainThread]: Command `dbt run` failed at 09:57:25.691703 after 1.40 seconds
[0m09:57:25.692125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aea270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a93260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fc350>]}
[0m09:57:25.692425 [debug] [MainThread]: Flushing usage events
[0m09:58:30.035221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d27f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1c0b0>]}


============================== 09:58:30.038634 | 304f6678-d684-4f6d-9887-a428fb1c79f5 ==============================
[0m09:58:30.038634 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:30.039011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:58:30.085032 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:30.085337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f3710>]}
[0m09:58:30.147817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10373bd70>]}
[0m09:58:30.184572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5aa50>]}
[0m09:58:30.185609 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:30.195860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:30.262895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m09:58:30.263311 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_sales.sql
[0m09:58:30.263537 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_products.sql
[0m09:58:30.263745 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/staging/stg_customers.sql
[0m09:58:30.407090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:30.413538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f9460>]}
[0m09:58:30.465292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744cd40>]}
[0m09:58:30.465597 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:30.465791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b34a0>]}
[0m09:58:30.466817 [info ] [MainThread]: 
[0m09:58:30.467125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:58:30.469541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:58:30.500658 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:58:30.500922 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:58:30.501091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.669920 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.169 seconds
[0m09:58:30.671679 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:58:30.673345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m09:58:30.673892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:58:30.679587 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.681231 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.681557 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:58:30.681846 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:58:30.682116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:30.682380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:30.795975 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.796617 [debug] [ThreadPool]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.797266 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:58:30.797775 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:58:30.798299 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:58:30.798895 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:58:30.811393 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m09:58:30.811918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m09:58:30.814035 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:58:30.816097 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:58:30.827783 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:58:30.828258 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:58:30.836951 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.837555 [debug] [MainThread]: On master: BEGIN
[0m09:58:30.838017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:30.952113 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m09:58:30.953123 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.953866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:58:30.968834 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m09:58:30.971650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bf680>]}
[0m09:58:30.972523 [debug] [MainThread]: On master: ROLLBACK
[0m09:58:30.983916 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:30.984656 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.008255 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m09:58:31.009557 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.010320 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.010896 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.019898 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m09:58:31.020775 [debug] [MainThread]: On master: Close
[0m09:58:31.022293 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:58:31.023167 [info ] [MainThread]: 
[0m09:58:31.029134 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m09:58:31.029847 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m09:58:31.030475 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m09:58:31.031220 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m09:58:31.032022 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m09:58:31.033755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m09:58:31.033040 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m09:58:31.034608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m09:58:31.035531 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m09:58:31.036232 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m09:58:31.036877 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m09:58:31.045835 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m09:58:31.046363 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m09:58:31.050863 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m09:58:31.053707 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m09:58:31.054489 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m09:58:31.054927 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m09:58:31.072805 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m09:58:31.087937 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m09:58:31.089940 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m09:58:31.091848 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m09:58:31.092447 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.092714 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m09:58:31.092978 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.093190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:31.093410 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.093633 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m09:58:31.093966 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m09:58:31.094216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.094450 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:58:31.208087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m09:58:31.208570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.114 seconds
[0m09:58:31.209014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.209422 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.209823 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m09:58:31.210264 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m09:58:31.213150 [debug] [Thread-3 (]: SQL status: BEGIN in 0.119 seconds
[0m09:58:31.213552 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.213944 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m09:58:31.238748 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m09:58:31.245889 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m09:58:31.246312 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m09:58:31.247651 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.250526 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.253205 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.253686 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m09:58:31.254047 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m09:58:31.254383 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m09:58:31.264427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.264825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.277439 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m09:58:31.281442 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.282590 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.283620 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.283938 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.284222 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.284499 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.284774 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m09:58:31.285044 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m09:58:31.285306 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m09:58:31.305559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.305962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m09:58:31.311776 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m09:58:31.312124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.026 seconds
[0m09:58:31.314022 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m09:58:31.319532 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m09:58:31.321229 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m09:58:31.321668 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m09:58:31.321989 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m09:58:31.322397 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m09:58:31.322697 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m09:58:31.323054 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m09:58:31.332582 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.009 seconds
[0m09:58:31.332870 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m09:58:31.334791 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m09:58:31.335107 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.012 seconds
[0m09:58:31.336152 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m09:58:31.337226 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m09:58:31.338389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104feeff0>]}
[0m09:58:31.338973 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.339369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107882bd0>]}
[0m09:58:31.339697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107883ec0>]}
[0m09:58:31.340093 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m09:58:31.340507 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.30s]
[0m09:58:31.340910 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:58:31.341401 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m09:58:31.341761 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m09:58:31.342224 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m09:58:31.342574 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m09:58:31.342885 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m09:58:31.343214 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m09:58:31.343461 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m09:58:31.343772 [info ] [Thread-2 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m09:58:31.344049 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m09:58:31.344344 [info ] [Thread-3 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m09:58:31.344624 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m09:58:31.346550 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.346855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.product_performance)
[0m09:58:31.347116 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m09:58:31.347461 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m09:58:31.349295 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.351107 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m09:58:31.351613 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m09:58:31.351920 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m09:58:31.363902 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m09:58:31.366784 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m09:58:31.368515 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m09:58:31.370097 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m09:58:31.370718 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.370961 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.371184 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.371389 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m09:58:31.371596 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m09:58:31.371789 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m09:58:31.371982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:58:31.372173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:58:31.372374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:31.483733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.112 seconds
[0m09:58:31.484171 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.484521 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m09:58:31.488098 [debug] [Thread-4 (]: SQL status: BEGIN in 0.116 seconds
[0m09:58:31.488413 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.488736 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m09:58:31.493197 [debug] [Thread-2 (]: SQL status: BEGIN in 0.121 seconds
[0m09:58:31.493530 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.493845 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m09:58:31.544820 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.056 seconds
[0m09:58:31.549408 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.550017 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.065 seconds
[0m09:58:31.550562 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.056 seconds
[0m09:58:31.551052 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m09:58:31.554519 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.557850 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.558410 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m09:58:31.558889 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m09:58:31.568074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m09:58:31.568536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m09:58:31.574848 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m09:58:31.575678 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.577259 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.580322 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.580763 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.581171 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.581528 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.581938 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m09:58:31.582328 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m09:58:31.582667 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m09:58:31.596680 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m09:58:31.645295 [debug] [Thread-3 (]: SQL status: COMMIT in 0.062 seconds
[0m09:58:31.645704 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m09:58:31.645966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.063 seconds
[0m09:58:31.647318 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m09:58:31.649090 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m09:58:31.650340 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m09:58:31.650676 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m09:58:31.650922 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m09:58:31.651237 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m09:58:31.651469 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m09:58:31.651774 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m09:58:31.663981 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m09:58:31.664233 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.665263 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m09:58:31.665507 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m09:58:31.666342 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m09:58:31.667244 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m09:58:31.667573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742a210>]}
[0m09:58:31.667836 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107429670>]}
[0m09:58:31.668259 [info ] [Thread-3 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.32s]
[0m09:58:31.668539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '304f6678-d684-4f6d-9887-a428fb1c79f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742b020>]}
[0m09:58:31.668851 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.32s]
[0m09:58:31.669190 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m09:58:31.669495 [info ] [Thread-2 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.32s]
[0m09:58:31.669815 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m09:58:31.670178 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m09:58:31.670924 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.671123 [debug] [MainThread]: On master: BEGIN
[0m09:58:31.671297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:58:31.784088 [debug] [MainThread]: SQL status: BEGIN in 0.113 seconds
[0m09:58:31.784548 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.784833 [debug] [MainThread]: Using postgres connection "master"
[0m09:58:31.785100 [debug] [MainThread]: On master: COMMIT
[0m09:58:31.795995 [debug] [MainThread]: SQL status: COMMIT in 0.011 seconds
[0m09:58:31.796324 [debug] [MainThread]: On master: Close
[0m09:58:31.796852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:31.797157 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_customers' was properly closed.
[0m09:58:31.797434 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m09:58:31.797703 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m09:58:31.797963 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m09:58:31.798377 [info ] [MainThread]: 
[0m09:58:31.798733 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m09:58:31.800068 [debug] [MainThread]: Command end result
[0m09:58:31.823222 [info ] [MainThread]: 
[0m09:58:31.823592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:31.823841 [info ] [MainThread]: 
[0m09:58:31.824085 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:58:31.825964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.830401, "process_user_time": 1.55683, "process_kernel_time": 0.195031, "process_mem_max_rss": "136577024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:31.826359 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:31.826295 after 1.83 seconds
[0m09:58:31.826634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d25640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071267b0>]}
[0m09:58:31.826899 [debug] [MainThread]: Flushing usage events
[0m09:58:55.552238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b9a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574c1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1ab70>]}


============================== 09:58:55.555379 | c1ff4414-3dfc-4358-89ff-8ff2b7027a79 ==============================
[0m09:58:55.555379 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:55.555739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:55.601451 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:58:55.601765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cf4d0>]}
[0m09:58:55.665131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068eb2f0>]}
[0m09:58:55.701492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106272330>]}
[0m09:58:55.702128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:58:55.712372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:58:55.779041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:55.779302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:55.782160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:58:55.802464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106531910>]}
[0m09:58:55.862881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e6840>]}
[0m09:58:55.863190 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:58:55.863389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ff4414-3dfc-4358-89ff-8ff2b7027a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bf7d0>]}
[0m09:58:55.864286 [info ] [MainThread]: 
[0m09:58:55.864485 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:58:55.865423 [debug] [MainThread]: Command end result
[0m09:58:55.879186 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.367541, "process_user_time": 1.019725, "process_kernel_time": 0.143396, "process_mem_max_rss": "118718464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:58:55.879533 [debug] [MainThread]: Command `dbt test` succeeded at 09:58:55.879486 after 0.37 seconds
[0m09:58:55.879759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106823b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624e120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051deea0>]}
[0m09:58:55.879953 [debug] [MainThread]: Flushing usage events
[0m09:59:08.091691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270170>]}


============================== 09:59:08.094220 | 34a76b21-d77d-48ad-b6f2-11f5c340b395 ==============================
[0m09:59:08.094220 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:59:08.094570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:08.130043 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:59:08.130348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742fb30>]}
[0m09:59:08.193041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742eb10>]}
[0m09:59:08.229139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f740>]}
[0m09:59:08.229631 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:59:08.238327 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:59:08.300716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:08.300978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:08.303807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m09:59:08.324191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107366030>]}
[0m09:59:08.374498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d2930>]}
[0m09:59:08.374790 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m09:59:08.374984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107973e60>]}
[0m09:59:08.375970 [info ] [MainThread]: 
[0m09:59:08.376292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:08.376745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m09:59:08.408227 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m09:59:08.408500 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m09:59:08.408682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.589307 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.180 seconds
[0m09:59:08.590902 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m09:59:08.591643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now create_d9snqvovhsjpqs_snapshots)
[0m09:59:08.592083 [debug] [ThreadPool]: Creating schema "database: "d9snqvovhsjpqs"
schema: "snapshots"
"
[0m09:59:08.597216 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.597564 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.597846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.706585 [debug] [ThreadPool]: SQL status: BEGIN in 0.109 seconds
[0m09:59:08.707452 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.708095 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "create_d9snqvovhsjpqs_snapshots"} */
create schema if not exists "snapshots"
[0m09:59:08.728028 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.019 seconds
[0m09:59:08.730660 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.731285 [debug] [ThreadPool]: Using postgres connection "create_d9snqvovhsjpqs_snapshots"
[0m09:59:08.731786 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: COMMIT
[0m09:59:08.744246 [debug] [ThreadPool]: SQL status: COMMIT in 0.012 seconds
[0m09:59:08.744939 [debug] [ThreadPool]: On create_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.754610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_d9snqvovhsjpqs_snapshots, now list_d9snqvovhsjpqs_snapshots)
[0m09:59:08.761716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m09:59:08.764311 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.768218 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.768698 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m09:59:08.769101 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m09:59:08.769469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:08.769826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:08.887811 [debug] [ThreadPool]: SQL status: BEGIN in 0.118 seconds
[0m09:59:08.888805 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m09:59:08.889927 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:59:08.890765 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m09:59:08.891331 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m09:59:08.891836 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m09:59:08.910368 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m09:59:08.913939 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m09:59:08.915011 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.023 seconds
[0m09:59:08.917116 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m09:59:08.926425 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m09:59:08.927317 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m09:59:08.936658 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:08.937334 [debug] [MainThread]: On master: BEGIN
[0m09:59:08.937815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:09.063828 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m09:59:09.064733 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.065534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:09.085916 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m09:59:09.090706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ccc80>]}
[0m09:59:09.091740 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:09.105148 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.105885 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.132053 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m09:59:09.133370 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.134338 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.135267 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.147731 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.148359 [debug] [MainThread]: On master: Close
[0m09:59:09.149723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:59:09.150407 [info ] [MainThread]: 
[0m09:59:09.155605 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.156579 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m09:59:09.157701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m09:59:09.158288 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.169620 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.225367 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.225745 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.225991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:09.349993 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.124 seconds
[0m09:59:09.357387 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.357871 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m09:59:09.374594 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.016 seconds
[0m09:59:09.375259 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376419 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.376850 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m09:59:09.387800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:59:09.388249 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.388707 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      
  
    

  create  table "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id,
        order_date as dbt_updated_at,
        order_date as dbt_valid_from,
        nullif(order_date, order_date) as dbt_valid_to
    from (
        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"

    ) sbq



  );
  
  
[0m09:59:09.419310 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.030 seconds
[0m09:59:09.447043 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.447632 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m09:59:09.448037 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m09:59:09.463503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m09:59:09.465685 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m09:59:09.467871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a76b21-d77d-48ad-b6f2-11f5c340b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c77200>]}
[0m09:59:09.468904 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mSELECT 1000[0m in 0.31s]
[0m09:59:09.469643 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m09:59:09.470899 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.471254 [debug] [MainThread]: On master: BEGIN
[0m09:59:09.471565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:09.591494 [debug] [MainThread]: SQL status: BEGIN in 0.120 seconds
[0m09:59:09.592961 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.593577 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:09.594348 [debug] [MainThread]: On master: COMMIT
[0m09:59:09.607395 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m09:59:09.608308 [debug] [MainThread]: On master: Close
[0m09:59:09.609601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:09.610174 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m09:59:09.610692 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m09:59:09.611544 [info ] [MainThread]: 
[0m09:59:09.612330 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:59:09.613618 [debug] [MainThread]: Command end result
[0m09:59:09.649350 [info ] [MainThread]: 
[0m09:59:09.649876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:09.650206 [info ] [MainThread]: 
[0m09:59:09.650523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:59:09.652096 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5995879, "process_user_time": 1.329639, "process_kernel_time": 0.157388, "process_mem_max_rss": "130924544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:09.652646 [debug] [MainThread]: Command `dbt snapshot` succeeded at 09:59:09.652565 after 1.60 seconds
[0m09:59:09.653026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc7320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849af00>]}
[0m09:59:09.653378 [debug] [MainThread]: Flushing usage events
[0m11:53:40.153738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105490b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106117fb0>]}


============================== 11:53:40.156962 | 0cecca54-21bd-4530-b3bc-a148eadc00fb ==============================
[0m11:53:40.156962 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:40.157469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:40.197115 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:40.197411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106677a40>]}
[0m11:53:40.274071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106587e00>]}
[0m11:53:40.310831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493ef0>]}
[0m11:53:40.311590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:40.328580 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:40.399429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:40.399708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:40.402650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:40.422776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664bfb0>]}
[0m11:53:40.478722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a728a0>]}
[0m11:53:40.479040 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:40.479231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b99070>]}
[0m11:53:40.480276 [info ] [MainThread]: 
[0m11:53:40.480590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:40.482693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:40.515704 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:40.515968 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:40.516141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.675736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.159 seconds
[0m11:53:40.677946 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:40.679831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m11:53:40.680397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m11:53:40.687262 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.689066 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.689410 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:40.689700 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:40.689973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:40.690232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.806151 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m11:53:40.807004 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:53:40.807582 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:40.808195 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:40.808853 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:53:40.809625 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:53:40.826011 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m11:53:40.829232 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:53:40.830045 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.020 seconds
[0m11:53:40.832477 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:53:40.842026 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:53:40.842593 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:53:40.854875 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.855370 [debug] [MainThread]: On master: BEGIN
[0m11:53:40.855746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:40.974608 [debug] [MainThread]: SQL status: BEGIN in 0.119 seconds
[0m11:53:40.975272 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:40.975918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:40.993339 [debug] [MainThread]: SQL status: SELECT 3 in 0.017 seconds
[0m11:53:40.996449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295d30>]}
[0m11:53:40.997185 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:41.006833 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.007340 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.030273 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:53:41.031531 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.032281 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.032910 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.045687 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:53:41.046647 [debug] [MainThread]: On master: Close
[0m11:53:41.048291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:41.049156 [info ] [MainThread]: 
[0m11:53:41.054359 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m11:53:41.055273 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m11:53:41.056274 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m11:53:41.057169 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_customers ............................... [RUN]
[0m11:53:41.057981 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_products ................................ [RUN]
[0m11:53:41.058694 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_sales ................................... [RUN]
[0m11:53:41.059434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m11:53:41.060032 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m11:53:41.060692 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m11:53:41.061230 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m11:53:41.061742 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m11:53:41.062233 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m11:53:41.072523 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m11:53:41.075801 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m11:53:41.078585 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m11:53:41.079731 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m11:53:41.080179 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m11:53:41.080603 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m11:53:41.116157 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m11:53:41.118944 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m11:53:41.120999 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m11:53:41.121673 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.121962 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.122242 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.122474 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m11:53:41.122716 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m11:53:41.122930 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m11:53:41.123137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.123336 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:41.123529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.227276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m11:53:41.227737 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.228094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.105 seconds
[0m11:53:41.228472 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m11:53:41.228860 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.229260 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m11:53:41.237353 [debug] [Thread-3 (]: SQL status: BEGIN in 0.114 seconds
[0m11:53:41.237751 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.238146 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m11:53:41.253259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m11:53:41.260750 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.261179 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m11:53:41.261552 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:53:41.265618 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.265986 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m11:53:41.266444 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:53:41.269190 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.269626 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:53:41.275821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m11:53:41.278285 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.278650 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:53:41.280244 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.282625 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.283037 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:53:41.283381 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.285822 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.286147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:53:41.287537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m11:53:41.298722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.302715 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.302997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m11:53:41.304289 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.304629 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.305787 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.306162 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.306607 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m11:53:41.306910 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.307158 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m11:53:41.307447 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m11:53:41.321155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.326186 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m11:53:41.326609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.327010 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m11:53:41.330884 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m11:53:41.332528 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m11:53:41.334129 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m11:53:41.334441 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m11:53:41.334867 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m11:53:41.335263 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m11:53:41.335688 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m11:53:41.336009 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m11:53:41.345968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m11:53:41.347835 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m11:53:41.348962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7f290>]}
[0m11:53:41.349413 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.349828 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m11:53:41.350835 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.014 seconds
[0m11:53:41.351758 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m11:53:41.352026 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.016 seconds
[0m11:53:41.352957 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m11:53:41.353284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107115220>]}
[0m11:53:41.353614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cff20>]}
[0m11:53:41.353984 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354404 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.29s]
[0m11:53:41.354759 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m11:53:41.355062 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m11:53:41.356199 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_customer
[0m11:53:41.356513 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m11:53:41.356803 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m11:53:41.357105 [info ] [Thread-4 (]: 4 of 6 START sql table model public.orders_by_customer ......................... [RUN]
[0m11:53:41.357418 [info ] [Thread-1 (]: 5 of 6 START sql table model public.orders_by_day .............................. [RUN]
[0m11:53:41.357848 [info ] [Thread-2 (]: 6 of 6 START sql table model public.product_performance ........................ [RUN]
[0m11:53:41.358693 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.orders_by_customer'
[0m11:53:41.359042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m11:53:41.359302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m11:53:41.359580 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m11:53:41.359890 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m11:53:41.360130 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m11:53:41.361968 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.363469 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.365207 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m11:53:41.366646 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m11:53:41.366902 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m11:53:41.367117 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m11:53:41.381507 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m11:53:41.383334 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m11:53:41.384810 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m11:53:41.385296 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.385504 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m11:53:41.385712 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.385924 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.386110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:41.386300 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m11:53:41.386478 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m11:53:41.386737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:41.386919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:41.483317 [debug] [Thread-4 (]: SQL status: BEGIN in 0.097 seconds
[0m11:53:41.483792 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.484130 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m11:53:41.504656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.118 seconds
[0m11:53:41.505021 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.505364 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m11:53:41.505745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.119 seconds
[0m11:53:41.506154 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.506481 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m11:53:41.516223 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.032 seconds
[0m11:53:41.519174 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.519543 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m11:53:41.531004 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:53:41.533619 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.534018 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m11:53:41.540384 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.034 seconds
[0m11:53:41.543384 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.543774 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.037 seconds
[0m11:53:41.544146 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m11:53:41.544558 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m11:53:41.547220 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.552464 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.552924 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m11:53:41.553269 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.553645 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m11:53:41.565037 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.567553 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.567923 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:53:41.568261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.568563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m11:53:41.570804 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m11:53:41.573268 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.575869 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m11:53:41.576252 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m11:53:41.576570 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m11:53:41.580791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m11:53:41.582081 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.582420 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.582731 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m11:53:41.589796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m11:53:41.591141 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.591485 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.591795 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m11:53:41.593294 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m11:53:41.594473 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_customer: Close
[0m11:53:41.595104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b75f0>]}
[0m11:53:41.595689 [info ] [Thread-4 (]: 4 of 6 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.24s]
[0m11:53:41.596242 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m11:53:41.597401 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m11:53:41.600972 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m11:53:41.601499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m11:53:41.601834 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m11:53:41.602718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m11:53:41.604248 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m11:53:41.604743 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m11:53:41.605034 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m11:53:41.616436 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.014 seconds
[0m11:53:41.617868 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m11:53:41.618439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071351f0>]}
[0m11:53:41.618932 [info ] [Thread-2 (]: 6 of 6 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.26s]
[0m11:53:41.619396 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m11:53:41.623530 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m11:53:41.624601 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m11:53:41.625028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cecca54-21bd-4530-b3bc-a148eadc00fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136210>]}
[0m11:53:41.625461 [info ] [Thread-1 (]: 5 of 6 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.27s]
[0m11:53:41.625884 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m11:53:41.626808 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.627071 [debug] [MainThread]: On master: BEGIN
[0m11:53:41.627302 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:41.739884 [debug] [MainThread]: SQL status: BEGIN in 0.112 seconds
[0m11:53:41.740606 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.741097 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:41.741553 [debug] [MainThread]: On master: COMMIT
[0m11:53:41.751741 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:53:41.752194 [debug] [MainThread]: On master: Close
[0m11:53:41.752909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:41.753339 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m11:53:41.753745 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m11:53:41.754133 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m11:53:41.754513 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m11:53:41.755076 [info ] [MainThread]: 
[0m11:53:41.755588 [info ] [MainThread]: Finished running 3 view models, 3 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m11:53:41.757424 [debug] [MainThread]: Command end result
[0m11:53:41.801447 [info ] [MainThread]: 
[0m11:53:41.802299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:41.802716 [info ] [MainThread]: 
[0m11:53:41.806729 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:53:41.816854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.705324, "process_user_time": 1.443455, "process_kernel_time": 0.213564, "process_mem_max_rss": "127516672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:41.817604 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:41.817492 after 1.71 seconds
[0m11:53:41.818057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573d2e0>]}
[0m11:53:41.818485 [debug] [MainThread]: Flushing usage events
[0m11:53:52.067234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857e90>]}


============================== 11:53:52.070681 | db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07 ==============================
[0m11:53:52.070681 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:52.071032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:53:52.108334 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:52.108642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068860f0>]}
[0m11:53:52.174669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caa690>]}
[0m11:53:52.211688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068feba0>]}
[0m11:53:52.212341 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:52.221128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:52.288311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:52.288576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:52.291451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:52.311594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ccb4a0>]}
[0m11:53:52.377919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713f170>]}
[0m11:53:52.378287 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:52.378483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db02a62d-bc1e-4d54-9d8c-3d0eaaf3df07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068579b0>]}
[0m11:53:52.379437 [info ] [MainThread]: 
[0m11:53:52.379642 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:53:52.380598 [debug] [MainThread]: Command end result
[0m11:53:52.395081 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.36842787, "process_user_time": 1.003717, "process_kernel_time": 0.097488, "process_mem_max_rss": "119750656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:53:52.395461 [debug] [MainThread]: Command `dbt test` succeeded at 11:53:52.395410 after 0.37 seconds
[0m11:53:52.395696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dce0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106887560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4d730>]}
[0m11:53:52.395886 [debug] [MainThread]: Flushing usage events
[0m11:53:59.450286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105994440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}


============================== 11:53:59.452774 | a537a1ae-3ccf-4d14-9c45-caa981091474 ==============================
[0m11:53:59.452774 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:53:59.453132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tyler/Downloads/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tyler/Downloads/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:59.487099 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m11:53:59.487402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5bdd0>]}
[0m11:53:59.550669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bf9e0>]}
[0m11:53:59.587297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b07e30>]}
[0m11:53:59.587793 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:59.596721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:53:59.658921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:53:59.659179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:53:59.661997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m11:53:59.681860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed33b0>]}
[0m11:53:59.733578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fae870>]}
[0m11:53:59.733889 [info ] [MainThread]: Found 6 models, 1 snapshot, 3 sources, 424 macros
[0m11:53:59.734103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107147e90>]}
[0m11:53:59.735071 [info ] [MainThread]: 
[0m11:53:59.735399 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:59.735837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m11:53:59.767555 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m11:53:59.767826 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m11:53:59.768000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:59.921892 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.154 seconds
[0m11:53:59.923963 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m11:53:59.929230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m11:53:59.929841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m11:53:59.936381 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:53:59.938016 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:53:59.938372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m11:53:59.938674 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m11:53:59.938953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:59.939222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:00.056544 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.057247 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m11:54:00.057888 [debug] [ThreadPool]: SQL status: BEGIN in 0.119 seconds
[0m11:54:00.058635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m11:54:00.059281 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m11:54:00.059894 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:54:00.072561 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m11:54:00.075185 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m11:54:00.082609 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.022 seconds
[0m11:54:00.085113 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m11:54:00.085662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m11:54:00.098662 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m11:54:00.111257 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.111933 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.112356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:00.229310 [debug] [MainThread]: SQL status: BEGIN in 0.117 seconds
[0m11:54:00.230636 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.231754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:54:00.251498 [debug] [MainThread]: SQL status: SELECT 3 in 0.018 seconds
[0m11:54:00.257326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6b140>]}
[0m11:54:00.258372 [debug] [MainThread]: On master: ROLLBACK
[0m11:54:00.269233 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.270084 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.293302 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m11:54:00.294614 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.295586 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.296535 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.309300 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m11:54:00.310972 [debug] [MainThread]: On master: Close
[0m11:54:00.313027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:00.314200 [info ] [MainThread]: 
[0m11:54:00.320519 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.321584 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m11:54:00.322369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now snapshot.ecommerce_project.sales_snapshot)
[0m11:54:00.322973 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.334569 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.385340 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.385716 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m11:54:00.385963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:54:00.499016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m11:54:00.499624 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.500166 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.537066 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.036 seconds
[0m11:54:00.577180 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.577762 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp115400569448"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m11:54:00.604063 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m11:54:00.607032 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.607460 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.621290 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.013 seconds
[0m11:54:00.624828 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.625218 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.640802 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m11:54:00.644076 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.644552 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.656818 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.659911 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.660473 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m11:54:00.672951 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m11:54:00.683501 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.683987 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp115400569448'
        
      order by ordinal_position

  
[0m11:54:00.696623 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.012 seconds
[0m11:54:00.714620 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.715106 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.727064 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m11:54:00.732621 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.733021 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m11:54:00.742670 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m11:54:00.743164 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744318 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.744722 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp115400569448" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m11:54:00.757732 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.013 seconds
[0m11:54:00.773363 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.773747 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m11:54:00.774035 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m11:54:00.791242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m11:54:00.794709 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m11:54:00.796221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a537a1ae-3ccf-4d14-9c45-caa981091474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a30b0>]}
[0m11:54:00.797015 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.47s]
[0m11:54:00.797612 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m11:54:00.798736 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.799037 [debug] [MainThread]: On master: BEGIN
[0m11:54:00.799304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:54:00.915207 [debug] [MainThread]: SQL status: BEGIN in 0.116 seconds
[0m11:54:00.915966 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.916444 [debug] [MainThread]: Using postgres connection "master"
[0m11:54:00.916885 [debug] [MainThread]: On master: COMMIT
[0m11:54:00.927212 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m11:54:00.927675 [debug] [MainThread]: On master: Close
[0m11:54:00.928448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:00.928885 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m11:54:00.929285 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m11:54:00.929736 [info ] [MainThread]: 
[0m11:54:00.930251 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m11:54:00.931220 [debug] [MainThread]: Command end result
[0m11:54:00.960684 [info ] [MainThread]: 
[0m11:54:00.961171 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:00.961486 [info ] [MainThread]: 
[0m11:54:00.961808 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:00.963199 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 1.5510751, "process_user_time": 1.345932, "process_kernel_time": 0.150261, "process_mem_max_rss": "127991808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:54:00.963746 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:54:00.963670 after 1.55 seconds
[0m11:54:00.964075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059943b0>]}
[0m11:54:00.964389 [debug] [MainThread]: Flushing usage events
[0m13:21:07.451404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10356d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053efed0>]}


============================== 13:21:07.454449 | 1d4bcd7b-6908-4666-b1aa-1f962a555f94 ==============================
[0m13:21:07.454449 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:21:07.454832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:21:08.762148 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:21:08.762504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524510>]}
[0m13:21:08.823135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff7ce0>]}
[0m13:21:08.850569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052efa50>]}
[0m13:21:08.851033 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:21:08.974268 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:21:09.043212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:21:09.043601 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models/marts/sales_reporting/customer_lifetime_value.sql
[0m13:21:09.158996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:21:09.165404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054532f0>]}
[0m13:21:09.217869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782d010>]}
[0m13:21:09.218214 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m13:21:09.218391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefba0>]}
[0m13:21:09.219530 [info ] [MainThread]: 
[0m13:21:09.219890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:09.222285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m13:21:09.262774 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m13:21:09.263035 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m13:21:09.263190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:10.010232 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.747 seconds
[0m13:21:10.015130 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m13:21:10.018567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m13:21:10.019030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m13:21:10.023203 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:21:10.024281 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:21:10.024495 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m13:21:10.024698 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m13:21:10.024901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:10.025086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:10.290814 [debug] [ThreadPool]: SQL status: BEGIN in 0.265 seconds
[0m13:21:10.291762 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:21:10.292399 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:21:10.305372 [debug] [ThreadPool]: SQL status: BEGIN in 0.280 seconds
[0m13:21:10.306054 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:21:10.306511 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:21:10.321458 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m13:21:10.324812 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m13:21:10.354048 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.047 seconds
[0m13:21:10.357908 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m13:21:10.358249 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m13:21:10.390130 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m13:21:10.399035 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:10.399625 [debug] [MainThread]: On master: BEGIN
[0m13:21:10.399987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:10.673689 [debug] [MainThread]: SQL status: BEGIN in 0.273 seconds
[0m13:21:10.675133 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:10.676154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:10.713487 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m13:21:10.717475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eff590>]}
[0m13:21:10.718430 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:10.746184 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:10.747424 [debug] [MainThread]: On master: BEGIN
[0m13:21:10.806219 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m13:21:10.807357 [debug] [MainThread]: On master: COMMIT
[0m13:21:10.808191 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:10.808732 [debug] [MainThread]: On master: COMMIT
[0m13:21:10.838245 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m13:21:10.839493 [debug] [MainThread]: On master: Close
[0m13:21:10.841733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:10.842415 [info ] [MainThread]: 
[0m13:21:10.845384 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m13:21:10.845718 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m13:21:10.846025 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m13:21:10.846435 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:21:10.846792 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m13:21:10.847091 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:21:10.847415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m13:21:10.847741 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m13:21:10.847976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m13:21:10.848204 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m13:21:10.848429 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m13:21:10.848639 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m13:21:10.855679 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m13:21:10.857933 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m13:21:10.859539 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m13:21:10.860334 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m13:21:10.873203 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m13:21:10.879828 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m13:21:10.896202 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m13:21:10.897007 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m13:21:10.899200 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m13:21:10.899796 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:10.900041 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:10.900245 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m13:21:10.900453 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:10.900644 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m13:21:10.900830 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:21:10.901018 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m13:21:10.901225 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:10.901495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:11.173046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.271 seconds
[0m13:21:11.173468 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:11.173716 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m13:21:11.185314 [debug] [Thread-3 (]: SQL status: BEGIN in 0.284 seconds
[0m13:21:11.185525 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:11.185743 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m13:21:11.219051 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m13:21:11.228168 [debug] [Thread-2 (]: SQL status: BEGIN in 0.327 seconds
[0m13:21:11.228538 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:11.228758 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:11.228985 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:21:11.229217 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m13:21:11.229893 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m13:21:11.231990 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:11.232235 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:21:11.257784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:21:11.263002 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:11.263645 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:21:11.266156 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m13:21:11.267850 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:11.268067 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:21:11.273208 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m13:21:11.276575 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:11.276806 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:21:11.290457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:21:11.304046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m13:21:11.310819 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m13:21:11.310623 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:21:11.312250 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:21:11.314560 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:11.314900 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:11.315182 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:11.315444 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:21:11.315701 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:21:11.315940 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:21:11.348285 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m13:21:11.349359 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:21:11.349614 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:11.349822 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:21:11.351479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m13:21:11.351752 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m13:21:11.358105 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m13:21:11.359464 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m13:21:11.362696 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:21:11.363037 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:21:11.363227 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m13:21:11.363415 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m13:21:11.386490 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m13:21:11.388435 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m13:21:11.388819 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:21:11.389058 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m13:21:11.393007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.029 seconds
[0m13:21:11.394646 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m13:21:11.394878 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.031 seconds
[0m13:21:11.395720 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m13:21:11.396688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4520>]}
[0m13:21:11.397129 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.55s]
[0m13:21:11.397510 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m13:21:11.397916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db8e10>]}
[0m13:21:11.398380 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.55s]
[0m13:21:11.398797 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m13:21:11.399172 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m13:21:11.399408 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m13:21:11.399691 [info ] [Thread-4 (]: 4 of 7 START sql table model public.customer_lifetime_value .................... [RUN]
[0m13:21:11.399945 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m13:21:11.400205 [info ] [Thread-1 (]: 5 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m13:21:11.400521 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m13:21:11.400781 [info ] [Thread-3 (]: 6 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m13:21:11.401027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m13:21:11.401292 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m13:21:11.401534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m13:21:11.401756 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m13:21:11.403841 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m13:21:11.404238 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m13:21:11.406318 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m13:21:11.407923 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m13:21:11.408479 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m13:21:11.422180 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m13:21:11.424183 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m13:21:11.426185 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m13:21:11.426484 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m13:21:11.426771 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.037 seconds
[0m13:21:11.428992 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m13:21:11.430179 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m13:21:11.430665 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m13:21:11.430946 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.431266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acd450>]}
[0m13:21:11.431504 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m13:21:11.431739 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m13:21:11.432396 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.432137 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.58s]
[0m13:21:11.432723 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:21:11.432974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:11.433204 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m13:21:11.433535 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m13:21:11.433903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:21:11.434190 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m13:21:11.434584 [info ] [Thread-2 (]: 7 of 7 START sql table model public.product_performance ........................ [RUN]
[0m13:21:11.434859 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m13:21:11.435053 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m13:21:11.436397 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m13:21:11.436778 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m13:21:11.438633 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m13:21:11.438992 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.439182 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m13:21:11.439359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:21:11.701199 [debug] [Thread-3 (]: SQL status: BEGIN in 0.267 seconds
[0m13:21:11.701557 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.701803 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m13:21:11.709852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m13:21:11.710135 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.710367 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m13:21:11.717383 [debug] [Thread-4 (]: SQL status: BEGIN in 0.285 seconds
[0m13:21:11.717605 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m13:21:11.717827 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC;
  );
  
[0m13:21:11.727980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.289 seconds
[0m13:21:11.728189 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.728397 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m13:21:11.748703 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: ORDER BY total_revenue DESC;
                                    ^

[0m13:21:11.749517 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: ROLLBACK
[0m13:21:11.755478 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.053 seconds
[0m13:21:11.760896 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.761158 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m13:21:11.775086 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.064 seconds
[0m13:21:11.780306 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.780543 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.052 seconds
[0m13:21:11.780750 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m13:21:11.782688 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.782992 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m13:21:11.783248 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m13:21:11.787440 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:21:11.789159 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.789663 [debug] [Thread-4 (]: Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m13:21:11.789918 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m13:21:11.790188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d99f60>]}
[0m13:21:11.790654 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model public.customer_lifetime_value ........... [[31mERROR[0m in 0.39s]
[0m13:21:11.791082 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m13:21:11.814914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m13:21:11.816876 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.817115 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m13:21:11.817340 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m13:21:11.819230 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.819507 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m13:21:11.820652 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m13:21:11.824006 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:21:11.824252 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.824457 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:21:11.849483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m13:21:11.850344 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:21:11.850562 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.850760 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:21:11.851364 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m13:21:11.852198 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:21:11.852413 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.852608 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:21:11.858426 [debug] [Thread-3 (]: SQL status: COMMIT in 0.034 seconds
[0m13:21:11.859622 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m13:21:11.861464 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:21:11.861711 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m13:21:11.882786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m13:21:11.884174 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m13:21:11.884393 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m13:21:11.884699 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:21:11.885814 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m13:21:11.886030 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m13:21:11.886327 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:21:11.886588 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m13:21:11.900173 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.038 seconds
[0m13:21:11.901018 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m13:21:11.901413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8cb0>]}
[0m13:21:11.901779 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.50s]
[0m13:21:11.902117 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m13:21:11.941868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m13:21:11.943367 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.056 seconds
[0m13:21:11.945460 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m13:21:11.946328 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m13:21:11.946789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae1df0>]}
[0m13:21:11.947067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d4bcd7b-6908-4666-b1aa-1f962a555f94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae2ff0>]}
[0m13:21:11.947451 [info ] [Thread-2 (]: 7 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.51s]
[0m13:21:11.947783 [info ] [Thread-1 (]: 5 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.55s]
[0m13:21:11.948367 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m13:21:11.948687 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m13:21:11.949608 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:11.949813 [debug] [MainThread]: On master: BEGIN
[0m13:21:11.950093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:12.218182 [debug] [MainThread]: SQL status: BEGIN in 0.268 seconds
[0m13:21:12.219261 [debug] [MainThread]: On master: COMMIT
[0m13:21:12.219813 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:12.220541 [debug] [MainThread]: On master: COMMIT
[0m13:21:12.250680 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m13:21:12.251626 [debug] [MainThread]: On master: Close
[0m13:21:12.253711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:12.254421 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m13:21:12.254703 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m13:21:12.254882 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m13:21:12.255042 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m13:21:12.255322 [info ] [MainThread]: 
[0m13:21:12.255553 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m13:21:12.257254 [debug] [MainThread]: Command end result
[0m13:21:12.325138 [info ] [MainThread]: 
[0m13:21:12.325562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:21:12.325781 [info ] [MainThread]: 
[0m13:21:12.326013 [error] [MainThread]:   Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m13:21:12.326184 [info ] [MainThread]: 
[0m13:21:12.326350 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:21:12.327844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9179235, "process_user_time": 1.506017, "process_kernel_time": 0.214616, "process_mem_max_rss": "127041536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:21:12.328253 [debug] [MainThread]: Command `dbt run` failed at 13:21:12.328190 after 4.92 seconds
[0m13:21:12.328475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110872c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104757ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8bf0>]}
[0m13:21:12.328713 [debug] [MainThread]: Flushing usage events
[0m13:21:12.649818 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:22:35.250646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069116a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108243c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108243ed0>]}


============================== 13:22:35.253778 | bea54772-4621-40e8-a771-4eae8c46340a ==============================
[0m13:22:35.253778 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:22:35.254161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:35.290870 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:22:35.291193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108378510>]}
[0m13:22:35.343486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4bce0>]}
[0m13:22:35.369908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007a50>]}
[0m13:22:35.370425 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:22:35.380142 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:22:35.441379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:35.441671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:35.444600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:22:35.465417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892da90>]}
[0m13:22:35.519531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108332cf0>]}
[0m13:22:35.519865 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m13:22:35.520050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f37930>]}
[0m13:22:35.521294 [info ] [MainThread]: 
[0m13:22:35.521623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:35.523766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m13:22:35.553687 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m13:22:35.553971 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m13:22:35.554134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:35.988752 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.434 seconds
[0m13:22:35.992481 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m13:22:35.993916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m13:22:35.998525 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:22:35.998838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m13:22:35.999049 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m13:22:36.000008 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:22:36.000229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:36.000417 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m13:22:36.000685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:36.279537 [debug] [ThreadPool]: SQL status: BEGIN in 0.279 seconds
[0m13:22:36.280604 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m13:22:36.281307 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:22:36.282888 [debug] [ThreadPool]: SQL status: BEGIN in 0.282 seconds
[0m13:22:36.283101 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m13:22:36.283295 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:22:36.315500 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.034 seconds
[0m13:22:36.316185 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.033 seconds
[0m13:22:36.318386 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m13:22:36.320609 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m13:22:36.347559 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m13:22:36.349172 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m13:22:36.356513 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:36.356769 [debug] [MainThread]: On master: BEGIN
[0m13:22:36.356930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:36.628539 [debug] [MainThread]: SQL status: BEGIN in 0.271 seconds
[0m13:22:36.628973 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:36.629343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:36.667265 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m13:22:36.671419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1a8d0>]}
[0m13:22:36.672312 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:36.699751 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:36.700881 [debug] [MainThread]: On master: BEGIN
[0m13:22:36.763064 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m13:22:36.764243 [debug] [MainThread]: On master: COMMIT
[0m13:22:36.765091 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:36.765664 [debug] [MainThread]: On master: COMMIT
[0m13:22:36.795630 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m13:22:36.797329 [debug] [MainThread]: On master: Close
[0m13:22:36.798932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:36.799278 [info ] [MainThread]: 
[0m13:22:36.801506 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m13:22:36.801798 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m13:22:36.802045 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m13:22:36.802407 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m13:22:36.802730 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:22:36.803132 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:22:36.803491 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m13:22:36.803757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m13:22:36.803996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m13:22:36.804217 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m13:22:36.804428 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m13:22:36.804626 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m13:22:36.809771 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m13:22:36.811667 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m13:22:36.813350 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m13:22:36.813944 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m13:22:36.814202 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m13:22:36.822536 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m13:22:36.852191 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m13:22:36.852973 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m13:22:36.854801 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m13:22:36.855455 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:36.855736 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:36.855963 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m13:22:36.856199 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m13:22:36.856424 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:36.856630 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:22:36.856825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:36.857015 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m13:22:36.857370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:37.127072 [debug] [Thread-3 (]: SQL status: BEGIN in 0.270 seconds
[0m13:22:37.127475 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:37.127719 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m13:22:37.146144 [debug] [Thread-2 (]: SQL status: BEGIN in 0.289 seconds
[0m13:22:37.146948 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:37.147499 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m13:22:37.154100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.297 seconds
[0m13:22:37.155048 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:37.155886 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m13:22:37.168814 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m13:22:37.177018 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:37.177317 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:22:37.193260 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m13:22:37.198758 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:37.199055 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:22:37.199953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m13:22:37.201905 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:37.202134 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:22:37.204025 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m13:22:37.205637 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:37.205852 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:22:37.229508 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m13:22:37.234025 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:37.234269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m13:22:37.234471 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:22:37.234663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m13:22:37.246273 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:22:37.248010 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:37.248264 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:37.248489 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:22:37.248697 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m13:22:37.273784 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m13:22:37.274857 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:22:37.275087 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:37.275290 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m13:22:37.281673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m13:22:37.282622 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:22:37.282876 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:37.283082 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m13:22:37.285523 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m13:22:37.289649 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m13:22:37.292877 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m13:22:37.293146 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m13:22:37.310198 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m13:22:37.311784 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m13:22:37.312150 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m13:22:37.312380 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m13:22:37.315226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m13:22:37.317157 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m13:22:37.317992 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m13:22:37.318368 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m13:22:37.322245 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.029 seconds
[0m13:22:37.324206 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m13:22:37.325526 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931c890>]}
[0m13:22:37.325975 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.52s]
[0m13:22:37.326370 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m13:22:37.326891 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m13:22:37.327249 [info ] [Thread-4 (]: 4 of 7 START sql table model public.customer_lifetime_value .................... [RUN]
[0m13:22:37.327534 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m13:22:37.327845 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m13:22:37.328134 [info ] [Thread-3 (]: 5 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m13:22:37.328390 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m13:22:37.328640 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m13:22:37.330367 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m13:22:37.330674 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m13:22:37.332505 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m13:22:37.333023 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m13:22:37.351797 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.039 seconds
[0m13:22:37.352257 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m13:22:37.353224 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m13:22:37.353442 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m13:22:37.353634 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m13:22:37.355699 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m13:22:37.356093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109365630>]}
[0m13:22:37.356919 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m13:22:37.357277 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m13:22:37.357560 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m13:22:37.357752 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:22:37.358100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935e7b0>]}
[0m13:22:37.358514 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.55s]
[0m13:22:37.358853 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m13:22:37.359141 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.55s]
[0m13:22:37.359373 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m13:22:37.359561 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.359816 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m13:22:37.360077 [info ] [Thread-2 (]: 6 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m13:22:37.360270 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m13:22:37.360464 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m13:22:37.360678 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m13:22:37.360901 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:22:37.361262 [info ] [Thread-1 (]: 7 of 7 START sql table model public.product_performance ........................ [RUN]
[0m13:22:37.361553 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m13:22:37.361883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.product_performance)
[0m13:22:37.363863 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m13:22:37.364203 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m13:22:37.365675 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m13:22:37.366110 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m13:22:37.367711 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m13:22:37.367973 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m13:22:37.369815 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m13:22:37.370229 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.370456 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m13:22:37.370661 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.370859 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:22:37.371038 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m13:22:37.371297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:37.622861 [debug] [Thread-4 (]: SQL status: BEGIN in 0.265 seconds
[0m13:22:37.623214 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m13:22:37.623460 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC;
  );
  
[0m13:22:37.654820 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: ORDER BY total_revenue DESC;
                                    ^

[0m13:22:37.655126 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: ROLLBACK
[0m13:22:37.656707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.286 seconds
[0m13:22:37.656916 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.657202 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m13:22:37.658683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.298 seconds
[0m13:22:37.658933 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.659171 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m13:22:37.664963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.294 seconds
[0m13:22:37.665163 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.665378 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m13:22:37.686828 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m13:22:37.700931 [debug] [Thread-4 (]: Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m13:22:37.701406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093999b0>]}
[0m13:22:37.702342 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model public.customer_lifetime_value ........... [[31mERROR[0m in 0.37s]
[0m13:22:37.703252 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m13:22:37.729481 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.072 seconds
[0m13:22:37.734468 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.735053 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m13:22:37.738491 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.079 seconds
[0m13:22:37.740425 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.740842 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.075 seconds
[0m13:22:37.741367 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m13:22:37.745741 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.746297 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m13:22:37.764792 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m13:22:37.766490 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.766719 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m13:22:37.777709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m13:22:37.779759 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.779991 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m13:22:37.780216 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m13:22:37.781808 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.782040 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m13:22:37.793590 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m13:22:37.797983 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:22:37.798211 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.798368 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m13:22:37.813596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m13:22:37.816921 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:22:37.817194 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m13:22:37.817406 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.818199 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:22:37.818408 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m13:22:37.818603 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.818815 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m13:22:37.831292 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m13:22:37.835340 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m13:22:37.837856 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m13:22:37.838097 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m13:22:37.850247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m13:22:37.852985 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m13:22:37.853325 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m13:22:37.853526 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m13:22:37.853734 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m13:22:37.854770 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m13:22:37.855060 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m13:22:37.855259 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m13:22:37.869720 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.031 seconds
[0m13:22:37.872232 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m13:22:37.873521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10923c410>]}
[0m13:22:37.873895 [info ] [Thread-2 (]: 6 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.51s]
[0m13:22:37.874218 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m13:22:37.893817 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.038 seconds
[0m13:22:37.894651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m13:22:37.896891 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m13:22:37.897802 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m13:22:37.898205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e8830>]}
[0m13:22:37.898500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bea54772-4621-40e8-a771-4eae8c46340a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e8890>]}
[0m13:22:37.898948 [info ] [Thread-3 (]: 5 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.57s]
[0m13:22:37.899283 [info ] [Thread-1 (]: 7 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.54s]
[0m13:22:37.899616 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m13:22:37.899864 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m13:22:37.900711 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:37.900876 [debug] [MainThread]: On master: BEGIN
[0m13:22:37.901011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:38.171113 [debug] [MainThread]: SQL status: BEGIN in 0.270 seconds
[0m13:22:38.172807 [debug] [MainThread]: On master: COMMIT
[0m13:22:38.173634 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:38.174049 [debug] [MainThread]: On master: COMMIT
[0m13:22:38.202327 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m13:22:38.202969 [debug] [MainThread]: On master: Close
[0m13:22:38.204456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:38.205396 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m13:22:38.205966 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m13:22:38.206402 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m13:22:38.207040 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m13:22:38.207862 [info ] [MainThread]: 
[0m13:22:38.208424 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m13:22:38.209518 [debug] [MainThread]: Command end result
[0m13:22:38.234286 [info ] [MainThread]: 
[0m13:22:38.234663 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:22:38.234906 [info ] [MainThread]: 
[0m13:22:38.235209 [error] [MainThread]:   Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m13:22:38.235447 [info ] [MainThread]: 
[0m13:22:38.235849 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m13:22:38.237499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0281203, "process_user_time": 1.31236, "process_kernel_time": 0.173371, "process_mem_max_rss": "125304832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:22:38.237937 [debug] [MainThread]: Command `dbt run` failed at 13:22:38.237862 after 3.03 seconds
[0m13:22:38.238239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109386c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109386b70>]}
[0m13:22:38.238500 [debug] [MainThread]: Flushing usage events
[0m13:22:38.326196 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:10:35.418480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806fed0>]}


============================== 16:10:35.422012 | 64f9c2ec-ef81-4deb-a94d-a21cce64735b ==============================
[0m16:10:35.422012 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:10:35.422379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:35.516045 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:10:35.516334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a4510>]}
[0m16:10:35.569870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d77ce0>]}
[0m16:10:35.597418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e33a50>]}
[0m16:10:35.598065 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:10:35.613829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:10:35.686959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:35.687221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:35.690481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:10:35.711211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108759a90>]}
[0m16:10:35.771199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815ecf0>]}
[0m16:10:35.771547 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m16:10:35.771732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6b930>]}
[0m16:10:35.772937 [info ] [MainThread]: 
[0m16:10:35.773270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:35.775624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m16:10:35.821415 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m16:10:35.821678 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m16:10:35.821836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:36.187650 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.366 seconds
[0m16:10:36.188838 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m16:10:36.190125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m16:10:36.195148 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m16:10:36.195746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m16:10:36.195982 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m16:10:36.197204 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m16:10:36.197455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:36.197679 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m16:10:36.198045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:36.497403 [debug] [ThreadPool]: SQL status: BEGIN in 0.298 seconds
[0m16:10:36.498786 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m16:10:36.502727 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:10:36.503097 [debug] [ThreadPool]: SQL status: BEGIN in 0.305 seconds
[0m16:10:36.503385 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m16:10:36.503641 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:10:36.526873 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.023 seconds
[0m16:10:36.528145 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m16:10:36.532863 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m16:10:36.534936 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m16:10:36.553241 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m16:10:36.555258 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m16:10:36.565463 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.565929 [debug] [MainThread]: On master: BEGIN
[0m16:10:36.566259 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:36.774266 [debug] [MainThread]: SQL status: BEGIN in 0.207 seconds
[0m16:10:36.776081 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.777062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:36.805428 [debug] [MainThread]: SQL status: SELECT 3 in 0.027 seconds
[0m16:10:36.815675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4ab10>]}
[0m16:10:36.816358 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:36.838124 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.841633 [debug] [MainThread]: On master: BEGIN
[0m16:10:36.884178 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m16:10:36.885461 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.886116 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:36.886579 [debug] [MainThread]: On master: COMMIT
[0m16:10:36.909176 [debug] [MainThread]: SQL status: COMMIT in 0.022 seconds
[0m16:10:36.910302 [debug] [MainThread]: On master: Close
[0m16:10:36.911883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:36.912847 [info ] [MainThread]: 
[0m16:10:36.915819 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m16:10:36.916300 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m16:10:36.917049 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m16:10:36.916743 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m16:10:36.917557 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m16:10:36.918038 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m16:10:36.918521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m16:10:36.918926 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m16:10:36.919198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m16:10:36.919453 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m16:10:36.919684 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m16:10:36.919899 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m16:10:36.925738 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m16:10:36.928149 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m16:10:36.930013 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m16:10:36.930846 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m16:10:36.937153 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m16:10:36.937523 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m16:10:36.959087 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m16:10:36.961280 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m16:10:36.962891 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m16:10:36.963673 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:36.963961 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:36.964181 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:36.964369 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m16:10:36.964556 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m16:10:36.964733 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m16:10:36.964951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:10:36.965159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:36.965340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:37.264457 [debug] [Thread-2 (]: SQL status: BEGIN in 0.298 seconds
[0m16:10:37.265896 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:37.266640 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m16:10:37.267072 [debug] [Thread-3 (]: SQL status: BEGIN in 0.302 seconds
[0m16:10:37.267348 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:37.267592 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m16:10:37.273253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.308 seconds
[0m16:10:37.274249 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:37.274915 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m16:10:37.300938 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m16:10:37.311265 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m16:10:37.311813 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:37.314180 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:37.314417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m16:10:37.314661 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m16:10:37.314876 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m16:10:37.316697 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:37.317249 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:10:37.336129 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m16:10:37.337993 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:37.338279 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m16:10:37.338504 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m16:10:37.338706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m16:10:37.340515 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:37.342194 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:37.342464 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m16:10:37.342676 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:10:37.360422 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:10:37.370998 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m16:10:37.372042 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m16:10:37.372905 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m16:10:37.373123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m16:10:37.373341 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:37.373547 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:37.374313 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m16:10:37.374528 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m16:10:37.374726 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m16:10:37.374922 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:37.375205 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m16:10:37.400885 [debug] [Thread-2 (]: SQL status: COMMIT in 0.026 seconds
[0m16:10:37.405350 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m16:10:37.405618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m16:10:37.408699 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:10:37.408928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m16:10:37.410118 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m16:10:37.410346 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m16:10:37.411695 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m16:10:37.412066 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:10:37.412486 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:10:37.412705 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m16:10:37.412914 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m16:10:37.434626 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.022 seconds
[0m16:10:37.437031 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m16:10:37.437500 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.024 seconds
[0m16:10:37.437734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.025 seconds
[0m16:10:37.439049 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m16:10:37.440246 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m16:10:37.441583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109124890>]}
[0m16:10:37.442295 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.52s]
[0m16:10:37.442855 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m16:10:37.443280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109141a90>]}
[0m16:10:37.443623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091859a0>]}
[0m16:10:37.444211 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.52s]
[0m16:10:37.444743 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.52s]
[0m16:10:37.445258 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m16:10:37.445688 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m16:10:37.446380 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m16:10:37.446676 [info ] [Thread-3 (]: 6 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m16:10:37.446955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m16:10:37.447177 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m16:10:37.448905 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m16:10:37.449352 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m16:10:37.449747 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m16:10:37.450021 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m16:10:37.450447 [info ] [Thread-4 (]: 4 of 7 START sql table model public.customer_lifetime_value .................... [RUN]
[0m16:10:37.450805 [info ] [Thread-1 (]: 7 of 7 START sql table model public.product_performance ........................ [RUN]
[0m16:10:37.451137 [info ] [Thread-2 (]: 5 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m16:10:37.451388 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m16:10:37.451805 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m16:10:37.452039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.product_performance)
[0m16:10:37.452263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m16:10:37.467001 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m16:10:37.472416 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m16:10:37.472741 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m16:10:37.472952 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m16:10:37.474431 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m16:10:37.476051 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m16:10:37.477602 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m16:10:37.478018 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.478446 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m16:10:37.478664 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:37.479002 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m16:10:37.481118 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m16:10:37.481449 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m16:10:37.483031 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m16:10:37.483379 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m16:10:37.483674 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:10:37.485423 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m16:10:37.485686 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m16:10:37.485917 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.486165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:10:37.486353 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m16:10:37.486673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:37.486944 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.487262 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m16:10:37.487472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:37.748393 [debug] [Thread-3 (]: SQL status: BEGIN in 0.270 seconds
[0m16:10:37.748907 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.749170 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m16:10:37.760711 [debug] [Thread-2 (]: SQL status: BEGIN in 0.273 seconds
[0m16:10:37.761006 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.761297 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m16:10:37.771664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.285 seconds
[0m16:10:37.771959 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:10:37.772207 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC;
  );
  
[0m16:10:37.774934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.288 seconds
[0m16:10:37.775162 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.775405 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m16:10:37.791127 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.042 seconds
[0m16:10:37.793858 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.794151 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: ORDER BY total_revenue DESC;
                                    ^

[0m16:10:37.794396 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m16:10:37.794642 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: ROLLBACK
[0m16:10:37.810442 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.049 seconds
[0m16:10:37.812615 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.812871 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m16:10:37.814408 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:10:37.816035 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.816381 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m16:10:37.816604 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m16:10:37.824195 [debug] [Thread-4 (]: Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m16:10:37.824586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109240130>]}
[0m16:10:37.825031 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model public.customer_lifetime_value ........... [[31mERROR[0m in 0.37s]
[0m16:10:37.825431 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m16:10:37.826730 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.051 seconds
[0m16:10:37.828704 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.828967 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m16:10:37.831696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m16:10:37.834682 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.835083 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m16:10:37.838372 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m16:10:37.841954 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m16:10:37.842220 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.842435 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m16:10:37.852437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m16:10:37.854251 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.854495 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m16:10:37.854737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m16:10:37.855658 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m16:10:37.855882 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.856085 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m16:10:37.865587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m16:10:37.866787 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m16:10:37.868647 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:10:37.868894 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m16:10:37.875169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:10:37.876097 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m16:10:37.876627 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m16:10:37.876859 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.878047 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m16:10:37.878296 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m16:10:37.878617 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:10:37.878869 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m16:10:37.892724 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.024 seconds
[0m16:10:37.893651 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m16:10:37.894101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920c890>]}
[0m16:10:37.894524 [info ] [Thread-3 (]: 6 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.45s]
[0m16:10:37.894880 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m16:10:37.904654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m16:10:37.906682 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m16:10:37.907232 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:10:37.907568 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m16:10:37.908195 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.029 seconds
[0m16:10:37.909566 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m16:10:37.910170 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906f350>]}
[0m16:10:37.910688 [info ] [Thread-2 (]: 5 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.46s]
[0m16:10:37.911124 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m16:10:37.953705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m16:10:37.954716 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m16:10:37.955160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f9c2ec-ef81-4deb-a94d-a21cce64735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109022870>]}
[0m16:10:37.955519 [info ] [Thread-1 (]: 7 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.50s]
[0m16:10:37.955847 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m16:10:37.956876 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:37.957142 [debug] [MainThread]: On master: BEGIN
[0m16:10:37.957315 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:38.269180 [debug] [MainThread]: SQL status: BEGIN in 0.311 seconds
[0m16:10:38.271642 [debug] [MainThread]: On master: COMMIT
[0m16:10:38.272319 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:38.272839 [debug] [MainThread]: On master: COMMIT
[0m16:10:38.293676 [debug] [MainThread]: SQL status: COMMIT in 0.020 seconds
[0m16:10:38.294886 [debug] [MainThread]: On master: Close
[0m16:10:38.297294 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:38.297969 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m16:10:38.298194 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m16:10:38.298372 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m16:10:38.298534 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m16:10:38.298884 [info ] [MainThread]: 
[0m16:10:38.299172 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m16:10:38.301318 [debug] [MainThread]: Command end result
[0m16:10:38.327223 [info ] [MainThread]: 
[0m16:10:38.327634 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:10:38.327927 [info ] [MainThread]: 
[0m16:10:38.328245 [error] [MainThread]:   Database Error in model customer_lifetime_value (models/marts/sales_reporting/customer_lifetime_value.sql)
  syntax error at or near ";"
  LINE 27: ORDER BY total_revenue DESC;
                                      ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_lifetime_value.sql
[0m16:10:38.328487 [info ] [MainThread]: 
[0m16:10:38.328727 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m16:10:38.330200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9565675, "process_user_time": 1.345552, "process_kernel_time": 0.243836, "process_mem_max_rss": "125698048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:38.330660 [debug] [MainThread]: Command `dbt run` failed at 16:10:38.330589 after 2.96 seconds
[0m16:10:38.330978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ae750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920ce30>]}
[0m16:10:38.331270 [debug] [MainThread]: Flushing usage events
[0m16:21:59.461911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eed6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681fed0>]}


============================== 16:21:59.465792 | 6b02b81e-7783-4bc1-959b-b2f47c09684b ==============================
[0m16:21:59.465792 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:21:59.466157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:21:59.548044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:21:59.548321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106954510>]}
[0m16:21:59.601297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106527ce0>]}
[0m16:21:59.628632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e3a50>]}
[0m16:21:59.629365 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:21:59.643929 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:21:59.715584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:59.716002 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/customer_lifetime_value.sql
[0m16:21:59.832420 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m16:21:59.838861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068832f0>]}
[0m16:21:59.895461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107879010>]}
[0m16:21:59.895777 [info ] [MainThread]: Found 7 models, 1 snapshot, 3 sources, 424 macros
[0m16:21:59.895948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783fba0>]}
[0m16:21:59.897054 [info ] [MainThread]: 
[0m16:21:59.897361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:59.899623 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m16:21:59.947292 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m16:21:59.947553 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m16:21:59.947717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:00.307864 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.360 seconds
[0m16:22:00.309408 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m16:22:00.311361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m16:22:00.311835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m16:22:00.316166 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m16:22:00.317221 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m16:22:00.317432 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m16:22:00.317605 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m16:22:00.317773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:00.317934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:00.639288 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m16:22:00.639948 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m16:22:00.640777 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:22:00.641804 [debug] [ThreadPool]: SQL status: BEGIN in 0.323 seconds
[0m16:22:00.642665 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m16:22:00.642959 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:22:00.671763 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.029 seconds
[0m16:22:00.672637 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.029 seconds
[0m16:22:00.676076 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m16:22:00.677223 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m16:22:00.698504 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m16:22:00.699363 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m16:22:00.711646 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:00.712143 [debug] [MainThread]: On master: BEGIN
[0m16:22:00.712490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:00.931976 [debug] [MainThread]: SQL status: BEGIN in 0.219 seconds
[0m16:22:00.933204 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:00.934163 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:00.963332 [debug] [MainThread]: SQL status: SELECT 3 in 0.028 seconds
[0m16:22:00.968488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107847a10>]}
[0m16:22:00.969093 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:00.991858 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:00.992805 [debug] [MainThread]: On master: BEGIN
[0m16:22:01.116753 [debug] [MainThread]: SQL status: BEGIN in 0.123 seconds
[0m16:22:01.118013 [debug] [MainThread]: On master: COMMIT
[0m16:22:01.118664 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:01.119719 [debug] [MainThread]: On master: COMMIT
[0m16:22:01.143338 [debug] [MainThread]: SQL status: COMMIT in 0.023 seconds
[0m16:22:01.145031 [debug] [MainThread]: On master: Close
[0m16:22:01.145794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:01.146060 [info ] [MainThread]: 
[0m16:22:01.148937 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m16:22:01.149274 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m16:22:01.149535 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m16:22:01.149892 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m16:22:01.150382 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_products ................................ [RUN]
[0m16:22:01.151033 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_sales ................................... [RUN]
[0m16:22:01.151525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m16:22:01.152006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m16:22:01.152354 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m16:22:01.152630 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m16:22:01.152866 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m16:22:01.153093 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m16:22:01.158008 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m16:22:01.161116 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m16:22:01.163458 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m16:22:01.164191 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m16:22:01.164469 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m16:22:01.172186 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m16:22:01.199974 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m16:22:01.201995 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m16:22:01.203424 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m16:22:01.204077 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.204322 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m16:22:01.204597 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.204878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:01.205095 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.205315 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m16:22:01.205632 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m16:22:01.205858 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:22:01.206085 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:01.415049 [debug] [Thread-3 (]: SQL status: BEGIN in 0.209 seconds
[0m16:22:01.415388 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.415641 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m16:22:01.417914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.213 seconds
[0m16:22:01.418158 [debug] [Thread-2 (]: SQL status: BEGIN in 0.212 seconds
[0m16:22:01.418405 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.418631 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.418857 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m16:22:01.419089 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m16:22:01.455392 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m16:22:01.459892 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.460140 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m16:22:01.460351 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m16:22:01.462402 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.462641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m16:22:01.462892 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m16:22:01.464653 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.464972 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m16:22:01.482662 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:22:01.484216 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.484432 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:22:01.484643 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m16:22:01.484859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:22:01.486552 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.488137 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.488372 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m16:22:01.488592 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m16:22:01.505469 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m16:22:01.513785 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m16:22:01.516918 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m16:22:01.517756 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m16:22:01.517971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m16:22:01.518184 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.518386 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.519157 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m16:22:01.519363 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m16:22:01.519555 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m16:22:01.519747 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.520016 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m16:22:01.542750 [debug] [Thread-3 (]: SQL status: COMMIT in 0.023 seconds
[0m16:22:01.543052 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m16:22:01.543289 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m16:22:01.547982 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m16:22:01.549846 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m16:22:01.551444 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m16:22:01.555510 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m16:22:01.555936 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m16:22:01.556312 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m16:22:01.556590 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m16:22:01.556854 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m16:22:01.557109 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m16:22:01.674745 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.117 seconds
[0m16:22:01.680501 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m16:22:01.680910 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.123 seconds
[0m16:22:01.681192 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.124 seconds
[0m16:22:01.682243 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m16:22:01.683107 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m16:22:01.684349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c407e0>]}
[0m16:22:01.684663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb8230>]}
[0m16:22:01.685440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f36ba0>]}
[0m16:22:01.685159 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.53s]
[0m16:22:01.685843 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.53s]
[0m16:22:01.686531 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.53s]
[0m16:22:01.687378 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m16:22:01.688003 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m16:22:01.688574 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m16:22:01.689404 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m16:22:01.689683 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m16:22:01.689920 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m16:22:01.690138 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m16:22:01.690422 [info ] [Thread-1 (]: 7 of 7 START sql table model public.product_performance ........................ [RUN]
[0m16:22:01.690784 [info ] [Thread-2 (]: 6 of 7 START sql table model public.orders_by_day .............................. [RUN]
[0m16:22:01.691118 [info ] [Thread-4 (]: 4 of 7 START sql table model public.customer_lifetime_value .................... [RUN]
[0m16:22:01.691427 [info ] [Thread-3 (]: 5 of 7 START sql table model public.orders_by_customer ......................... [RUN]
[0m16:22:01.691711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.product_performance)
[0m16:22:01.691946 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m16:22:01.692265 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m16:22:01.692516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m16:22:01.692735 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m16:22:01.692936 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m16:22:01.693145 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m16:22:01.693338 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m16:22:01.695490 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m16:22:01.696907 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m16:22:01.698406 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m16:22:01.700289 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m16:22:01.700981 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m16:22:01.701241 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m16:22:01.714872 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m16:22:01.720883 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m16:22:01.722930 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m16:22:01.720622 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m16:22:01.724854 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m16:22:01.726834 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m16:22:01.727470 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:01.727754 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m16:22:01.728054 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:01.728385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:01.728697 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m16:22:01.729091 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:01.729334 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:01.729524 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:01.729725 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m16:22:01.729928 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m16:22:01.730183 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:22:01.730368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:01.999201 [debug] [Thread-3 (]: SQL status: BEGIN in 0.269 seconds
[0m16:22:01.999558 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:01.999797 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m16:22:02.014999 [debug] [Thread-2 (]: SQL status: BEGIN in 0.285 seconds
[0m16:22:02.015286 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:02.015497 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m16:22:02.023448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.295 seconds
[0m16:22:02.023751 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:02.023981 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m16:22:02.024349 [debug] [Thread-4 (]: SQL status: BEGIN in 0.294 seconds
[0m16:22:02.024555 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:02.024816 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m16:22:02.047567 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.047 seconds
[0m16:22:02.053100 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:02.053341 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m16:22:02.081148 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.065 seconds
[0m16:22:02.087812 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:02.074034 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.048 seconds
[0m16:22:02.088402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m16:22:02.088718 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m16:22:02.092401 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:02.095262 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:02.095761 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m16:22:02.096070 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m16:22:02.168664 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.144 seconds
[0m16:22:02.173413 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:02.173781 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m16:22:02.186118 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m16:22:02.186875 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m16:22:02.192309 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m16:22:02.192648 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.097 seconds
[0m16:22:02.194759 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:02.195046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m16:22:02.195292 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:02.196920 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:02.197277 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m16:22:02.200388 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:02.200820 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m16:22:02.201230 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m16:22:02.201660 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m16:22:02.221305 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m16:22:02.222367 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m16:22:02.222607 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m16:22:02.222827 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:02.223686 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m16:22:02.223917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m16:22:02.224137 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m16:22:02.224338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m16:22:02.224539 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:02.226123 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m16:22:02.227007 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m16:22:02.227231 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m16:22:02.229101 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m16:22:02.229356 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:02.229601 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m16:22:02.229810 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m16:22:02.249155 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m16:22:02.250341 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m16:22:02.250657 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m16:22:02.250870 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m16:22:02.251495 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m16:22:02.255382 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m16:22:02.255677 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.026 seconds
[0m16:22:02.255987 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m16:22:02.256185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m16:22:02.257430 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m16:22:02.257799 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m16:22:02.259636 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m16:22:02.260183 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m16:22:02.260452 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m16:22:02.260785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911e510>]}
[0m16:22:02.261261 [info ] [Thread-3 (]: 5 of 7 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.57s]
[0m16:22:02.261755 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m16:22:02.274360 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.023 seconds
[0m16:22:02.275419 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m16:22:02.275892 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3ef90>]}
[0m16:22:02.276281 [info ] [Thread-4 (]: 4 of 7 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.58s]
[0m16:22:02.276643 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m16:22:02.361649 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.101 seconds
[0m16:22:02.363305 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.102 seconds
[0m16:22:02.366047 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m16:22:02.368057 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m16:22:02.368956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3ed50>]}
[0m16:22:02.369508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b02b81e-7783-4bc1-959b-b2f47c09684b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3ecf0>]}
[0m16:22:02.369976 [info ] [Thread-2 (]: 6 of 7 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.68s]
[0m16:22:02.370872 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m16:22:02.370315 [info ] [Thread-1 (]: 7 of 7 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.68s]
[0m16:22:02.371306 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m16:22:02.372511 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:02.373098 [debug] [MainThread]: On master: BEGIN
[0m16:22:02.373269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:02.578415 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m16:22:02.580392 [debug] [MainThread]: On master: COMMIT
[0m16:22:02.580982 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:02.581539 [debug] [MainThread]: On master: COMMIT
[0m16:22:02.601780 [debug] [MainThread]: SQL status: COMMIT in 0.020 seconds
[0m16:22:02.602182 [debug] [MainThread]: On master: Close
[0m16:22:02.602779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:02.602967 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m16:22:02.603125 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m16:22:02.603275 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m16:22:02.603481 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m16:22:02.603863 [info ] [MainThread]: 
[0m16:22:02.604130 [info ] [MainThread]: Finished running 3 view models, 4 table models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m16:22:02.605924 [debug] [MainThread]: Command end result
[0m16:22:02.687235 [info ] [MainThread]: 
[0m16:22:02.687482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:02.687644 [info ] [MainThread]: 
[0m16:22:02.687802 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:22:02.689270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2717357, "process_user_time": 1.50768, "process_kernel_time": 0.260026, "process_mem_max_rss": "128598016", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:22:02.689636 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:02.689581 after 3.27 seconds
[0m16:22:02.689850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a94d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb0710>]}
[0m16:22:02.690048 [debug] [MainThread]: Flushing usage events
[0m19:44:22.310104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eebed0>]}


============================== 19:44:22.313811 | 6475cbd2-c5ce-4d50-8f22-838aaa56cbbc ==============================
[0m19:44:22.313811 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:44:22.314240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt show', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:44:22.406410 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:44:22.406715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6475cbd2-c5ce-4d50-8f22-838aaa56cbbc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020510>]}
[0m19:44:22.461908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6475cbd2-c5ce-4d50-8f22-838aaa56cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf3ce0>]}
[0m19:44:22.490848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6475cbd2-c5ce-4d50-8f22-838aaa56cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cafa50>]}
[0m19:44:22.491482 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:44:22.507868 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:44:22.581986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:44:22.582340 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:44:22.701268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:44:22.708111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6475cbd2-c5ce-4d50-8f22-838aaa56cbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f4f2f0>]}
[0m19:44:22.764987 [error] [MainThread]: Encountered an error:
Runtime Error
  Either --select or --inline must be passed to show
[0m19:44:22.766493 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 0.50061935, "process_user_time": 1.024755, "process_kernel_time": 0.185229, "process_mem_max_rss": "112050176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:22.766829 [debug] [MainThread]: Command `dbt show` failed at 19:44:22.766775 after 0.50 seconds
[0m19:44:22.767038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c73e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c457e0>]}
[0m19:44:22.767210 [debug] [MainThread]: Flushing usage events
[0m19:44:23.060363 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:44:47.414153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1181b3ed0>]}


============================== 19:44:47.417564 | 2194e732-4bb8-43a0-8233-a424ff66a8b4 ==============================
[0m19:44:47.417564 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:44:47.418035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt show --select stg_sales', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:44:47.466205 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:44:47.466519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182ec510>]}
[0m19:44:47.514111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7ce0>]}
[0m19:44:47.542371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db7a50>]}
[0m19:44:47.543007 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:44:47.553808 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:44:47.624971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:47.625265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:47.628515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:44:47.649245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d2da90>]}
[0m19:44:47.705466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182a2dd0>]}
[0m19:44:47.705772 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:44:47.705953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e53110>]}
[0m19:44:47.706867 [info ] [MainThread]: 
[0m19:44:47.707182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:47.709495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m19:44:47.716175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:44:47.755146 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:44:47.755406 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:44:47.755627 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:44:47.755842 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:44:47.756037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:47.756205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:48.469480 [debug] [ThreadPool]: SQL status: BEGIN in 0.713 seconds
[0m19:44:48.470766 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:44:48.471868 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:44:48.491641 [debug] [ThreadPool]: SQL status: BEGIN in 0.735 seconds
[0m19:44:48.492518 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:44:48.493212 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:44:48.509034 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m19:44:48.515230 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:44:48.534982 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.041 seconds
[0m19:44:48.538718 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:44:48.548154 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:44:48.575232 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:44:48.585025 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:48.585289 [debug] [MainThread]: On master: BEGIN
[0m19:44:48.585477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:48.910154 [debug] [MainThread]: SQL status: BEGIN in 0.324 seconds
[0m19:44:48.911633 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:48.912231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:44:48.959533 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m19:44:48.964248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2194e732-4bb8-43a0-8233-a424ff66a8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ebec90>]}
[0m19:44:48.964674 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:49.001577 [debug] [MainThread]: On master: Close
[0m19:44:49.002965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:44:49.003723 [info ] [MainThread]: 
[0m19:44:49.006188 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_sales
[0m19:44:49.006639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_sales)
[0m19:44:49.006889 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:44:49.012482 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:44:49.013453 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:44:49.019082 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:44:49.019418 [debug] [Thread-1 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  
  WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  
  limit 5

[0m19:44:49.019676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:49.352333 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.332 seconds
[0m19:44:49.356874 [debug] [Thread-1 (]: On model.ecommerce_project.stg_sales: Close
[0m19:44:49.357704 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:44:49.359179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:49.359775 [debug] [MainThread]: Connection 'model.ecommerce_project.stg_sales' was properly closed.
[0m19:44:49.360194 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m19:44:49.361146 [debug] [MainThread]: Command end result
[0m19:44:49.385644 [info ] [MainThread]: Previewing node 'stg_sales':
| order_id | customer_id | product_id | order_date | quantity | total_price |
| -------- | ----------- | ---------- | ---------- | -------- | ----------- |
|      101 |         818 |        204 | 2024-07-06 |        4 |      403.26 |
|      102 |         813 |        201 | 2024-02-26 |        3 |      932.66 |
|      103 |         969 |        201 | 2024-05-03 |        3 |      108.33 |
|      104 |         824 |        204 | 2024-02-12 |        2 |      728.87 |
|      105 |         965 |        203 | 2024-08-04 |        1 |       99.45 |

[0m19:44:49.387120 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 2.014805, "process_user_time": 1.06873, "process_kernel_time": 0.200738, "process_mem_max_rss": "121290752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:44:49.387605 [debug] [MainThread]: Command `dbt show` succeeded at 19:44:49.387532 after 2.02 seconds
[0m19:44:49.387879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e91860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187f89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191c18b0>]}
[0m19:44:49.388124 [debug] [MainThread]: Flushing usage events
[0m19:44:49.423447 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:49:09.894506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe7ed0>]}


============================== 19:49:09.898230 | aaf4e484-35f6-4527-990b-879206b73cdd ==============================
[0m19:49:09.898230 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:09.898649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:49:09.947584 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:49:09.947890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aaf4e484-35f6-4527-990b-879206b73cdd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611c510>]}
[0m19:49:09.998057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaf4e484-35f6-4527-990b-879206b73cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cefce0>]}
[0m19:49:10.028391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aaf4e484-35f6-4527-990b-879206b73cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daba50>]}
[0m19:49:10.029046 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:49:10.041032 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:49:10.112218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:10.112641 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:49:10.198970 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecommerce_project.category_performance' (models/marts/sales_reporting/category_performance.sql) depends on a node named 'stg_product' which was not found
[0m19:49:10.200320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34766254, "process_user_time": 0.939347, "process_kernel_time": 0.139505, "process_mem_max_rss": "109920256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:10.200689 [debug] [MainThread]: Command `dbt run` failed at 19:49:10.200626 after 0.35 seconds
[0m19:49:10.200921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d386e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6fe70>]}
[0m19:49:10.201115 [debug] [MainThread]: Flushing usage events
[0m19:49:10.302307 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:49:29.723806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031a16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad3ed0>]}


============================== 19:49:29.726850 | c3f6349f-b8fa-471e-b99b-4ab826e70469 ==============================
[0m19:49:29.726850 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:49:29.727194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:29.763955 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:49:29.764245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c08510>]}
[0m19:49:29.812980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dbce0>]}
[0m19:49:29.841383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104897a50>]}
[0m19:49:29.841864 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:49:29.850729 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:49:29.916387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:29.916890 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:49:30.042846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:49:30.049658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b372f0>]}
[0m19:49:30.105591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fd010>]}
[0m19:49:30.105964 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:49:30.106184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105829b20>]}
[0m19:49:30.107449 [info ] [MainThread]: 
[0m19:49:30.107804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:30.110235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m19:49:30.142683 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m19:49:30.142958 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m19:49:30.143114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:30.700586 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.557 seconds
[0m19:49:30.705536 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m19:49:30.707104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m19:49:30.707500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:49:30.716974 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:49:30.717288 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:49:30.717497 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:49:30.717757 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:49:30.718113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:30.718536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:31.040599 [debug] [ThreadPool]: SQL status: BEGIN in 0.317 seconds
[0m19:49:31.041405 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:49:31.041858 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:49:31.045829 [debug] [ThreadPool]: SQL status: BEGIN in 0.328 seconds
[0m19:49:31.046864 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:49:31.047615 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:49:31.077261 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.034 seconds
[0m19:49:31.085880 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:49:31.086241 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m19:49:31.087094 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:49:31.115871 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:49:31.117291 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:49:31.125440 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:31.125722 [debug] [MainThread]: On master: BEGIN
[0m19:49:31.125910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:31.431610 [debug] [MainThread]: SQL status: BEGIN in 0.305 seconds
[0m19:49:31.432734 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:31.434045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:31.478051 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m19:49:31.481426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584bad0>]}
[0m19:49:31.481806 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:31.515834 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:31.518286 [debug] [MainThread]: On master: BEGIN
[0m19:49:31.587086 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m19:49:31.588143 [debug] [MainThread]: On master: COMMIT
[0m19:49:31.588751 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:31.589286 [debug] [MainThread]: On master: COMMIT
[0m19:49:31.623445 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m19:49:31.624278 [debug] [MainThread]: On master: Close
[0m19:49:31.626054 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:31.626584 [info ] [MainThread]: 
[0m19:49:31.629332 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m19:49:31.629671 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m19:49:31.629929 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m19:49:31.630289 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_products ................................ [RUN]
[0m19:49:31.630589 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m19:49:31.631458 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m19:49:31.630948 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_sales ................................... [RUN]
[0m19:49:31.632208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m19:49:31.632613 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:49:31.632977 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m19:49:31.633306 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:49:31.641467 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:49:31.641920 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:49:31.644728 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:49:31.646895 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:49:31.647648 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m19:49:31.653612 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:49:31.665441 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:49:31.688929 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:49:31.689598 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m19:49:31.690115 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:49:31.690785 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:31.691028 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:31.691238 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m19:49:31.691437 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:31.691619 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m19:49:31.691798 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:49:31.691972 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m19:49:31.692137 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:31.692407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:31.979192 [debug] [Thread-3 (]: SQL status: BEGIN in 0.287 seconds
[0m19:49:31.979559 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:31.979819 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m19:49:31.987343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.295 seconds
[0m19:49:31.987888 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:31.988410 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m19:49:32.025465 [debug] [Thread-2 (]: SQL status: BEGIN in 0.333 seconds
[0m19:49:32.025787 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:32.026555 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m19:49:32.027684 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m19:49:32.032072 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:32.032322 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:49:32.035136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m19:49:32.037215 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:32.037440 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:49:32.063288 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:49:32.063593 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m19:49:32.065223 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:32.067001 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:32.067240 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:49:32.067482 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m19:49:32.071063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:49:32.074010 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:32.074466 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:49:32.099531 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:49:32.107004 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m19:49:32.107478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:49:32.109460 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:32.120841 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:49:32.121843 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:49:32.122176 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:49:32.122435 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:32.122663 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:32.122954 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:49:32.123202 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:49:32.152577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m19:49:32.152899 [debug] [Thread-3 (]: SQL status: COMMIT in 0.029 seconds
[0m19:49:32.158748 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m19:49:32.159139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:49:32.160854 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m19:49:32.165316 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:49:32.166471 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:49:32.166894 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:49:32.167183 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m19:49:32.167463 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:32.167728 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m19:49:32.168145 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:49:32.202270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m19:49:32.202590 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m19:49:32.204579 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m19:49:32.204833 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m19:49:32.205728 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m19:49:32.207147 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m19:49:32.208228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bfe410>]}
[0m19:49:32.208516 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8ead0>]}
[0m19:49:32.208871 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:49:32.209818 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m19:49:32.209297 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.58s]
[0m19:49:32.209633 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.58s]
[0m19:49:32.210401 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:49:32.210728 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:49:32.211454 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m19:49:32.211837 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m19:49:32.212120 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m19:49:32.212417 [info ] [Thread-1 (]: 6 of 8 START sql table model public.orders_by_day .............................. [RUN]
[0m19:49:32.212788 [info ] [Thread-4 (]: 4 of 8 START sql table model public.customer_lifetime_value .................... [RUN]
[0m19:49:32.213069 [info ] [Thread-3 (]: 5 of 8 START sql table model public.orders_by_customer ......................... [RUN]
[0m19:49:32.213357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m19:49:32.213786 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m19:49:32.214070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m19:49:32.214321 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m19:49:32.214555 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m19:49:32.214774 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m19:49:32.216882 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m19:49:32.218424 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.219907 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m19:49:32.220586 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m19:49:32.225990 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m19:49:32.235783 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m19:49:32.237948 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m19:49:32.238225 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m19:49:32.240362 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.240802 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.241103 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.241391 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m19:49:32.241642 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m19:49:32.241947 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.242184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:32.242421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:32.242635 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m19:49:32.243022 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:49:32.245751 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m19:49:32.246598 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m19:49:32.247011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb27d0>]}
[0m19:49:32.247372 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.62s]
[0m19:49:32.247686 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m19:49:32.247915 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m19:49:32.248338 [info ] [Thread-2 (]: 7 of 8 START sql table model public.product_performance ........................ [RUN]
[0m19:49:32.248665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m19:49:32.248861 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m19:49:32.250406 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m19:49:32.250865 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m19:49:32.252771 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m19:49:32.253118 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.253296 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m19:49:32.253459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:32.559026 [debug] [Thread-3 (]: SQL status: BEGIN in 0.317 seconds
[0m19:49:32.559464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.317 seconds
[0m19:49:32.559730 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.559950 [debug] [Thread-2 (]: SQL status: BEGIN in 0.306 seconds
[0m19:49:32.560226 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.560480 [debug] [Thread-4 (]: SQL status: BEGIN in 0.317 seconds
[0m19:49:32.560738 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m19:49:32.560986 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.561219 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m19:49:32.561441 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.561731 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m19:49:32.562086 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m19:49:32.620199 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.058 seconds
[0m19:49:32.624442 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.624698 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m19:49:32.649606 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.087 seconds
[0m19:49:32.652633 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.653195 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.091 seconds
[0m19:49:32.653479 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.091 seconds
[0m19:49:32.653722 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m19:49:32.655889 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.657637 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.658078 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m19:49:32.658361 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m19:49:32.658799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:49:32.660569 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.660842 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m19:49:32.687172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:49:32.687445 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:49:32.689438 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.689704 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:49:32.691256 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.691495 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m19:49:32.693080 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.693351 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m19:49:32.693616 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m19:49:32.694718 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:49:32.698209 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:49:32.698469 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.698678 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:49:32.723189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:49:32.723427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:49:32.724319 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:49:32.724619 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:49:32.725486 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:49:32.725719 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.726880 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:49:32.727116 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.727639 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:49:32.728014 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.728361 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:49:32.728726 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:49:32.733674 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m19:49:32.734946 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m19:49:32.736884 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:49:32.737137 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m19:49:32.760194 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m19:49:32.760437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m19:49:32.761578 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m19:49:32.765819 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m19:49:32.766051 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m19:49:32.766387 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:49:32.766694 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:49:32.767838 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m19:49:32.768067 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m19:49:32.768284 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m19:49:32.768582 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:49:32.768872 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m19:49:32.770472 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.033 seconds
[0m19:49:32.771510 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m19:49:32.771945 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db5390>]}
[0m19:49:32.772331 [info ] [Thread-3 (]: 5 of 8 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.56s]
[0m19:49:32.772762 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m19:49:32.773092 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m19:49:32.773596 [info ] [Thread-3 (]: 8 of 8 START sql table model public.category_performance ....................... [RUN]
[0m19:49:32.773887 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m19:49:32.774127 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:49:32.775861 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:49:32.776417 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m19:49:32.817029 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m19:49:32.817389 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.049 seconds
[0m19:49:32.817647 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.049 seconds
[0m19:49:32.817897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m19:49:32.818867 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m19:49:32.819643 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m19:49:32.820450 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m19:49:32.820756 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:49:32.821065 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb6c90>]}
[0m19:49:32.821411 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb6d50>]}
[0m19:49:32.821662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb5cd0>]}
[0m19:49:32.821851 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m19:49:32.822185 [info ] [Thread-2 (]: 7 of 8 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.57s]
[0m19:49:32.822501 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.61s]
[0m19:49:32.822802 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.61s]
[0m19:49:32.823014 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:32.823302 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m19:49:32.823588 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m19:49:32.823861 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m19:49:33.105909 [debug] [Thread-3 (]: SQL status: BEGIN in 0.283 seconds
[0m19:49:33.106971 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:49:33.107650 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.product_id as product_id,
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m19:49:33.142068 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 13:     stg_products.product_id as product_id,
             ^

[0m19:49:33.143499 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: ROLLBACK
[0m19:49:33.179451 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m19:49:33.189931 [debug] [Thread-3 (]: Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:     stg_products.product_id as product_id,
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:49:33.190342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3f6349f-b8fa-471e-b99b-4ab826e70469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c2ffb0>]}
[0m19:49:33.190811 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model public.category_performance .............. [[31mERROR[0m in 0.42s]
[0m19:49:33.191403 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m19:49:33.192760 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:33.193028 [debug] [MainThread]: On master: BEGIN
[0m19:49:33.193220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:33.533432 [debug] [MainThread]: SQL status: BEGIN in 0.340 seconds
[0m19:49:33.535460 [debug] [MainThread]: On master: COMMIT
[0m19:49:33.536278 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:33.536775 [debug] [MainThread]: On master: COMMIT
[0m19:49:33.573092 [debug] [MainThread]: SQL status: COMMIT in 0.036 seconds
[0m19:49:33.573852 [debug] [MainThread]: On master: Close
[0m19:49:33.575234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:33.575777 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m19:49:33.576217 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m19:49:33.576751 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:49:33.578051 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m19:49:33.578880 [info ] [MainThread]: 
[0m19:49:33.579625 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m19:49:33.580927 [debug] [MainThread]: Command end result
[0m19:49:33.606233 [info ] [MainThread]: 
[0m19:49:33.606562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:49:33.606760 [info ] [MainThread]: 
[0m19:49:33.607088 [error] [MainThread]:   Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:     stg_products.product_id as product_id,
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:49:33.607329 [info ] [MainThread]: 
[0m19:49:33.607538 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:49:33.608617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9267952, "process_user_time": 1.514741, "process_kernel_time": 0.186306, "process_mem_max_rss": "127320064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:49:33.609156 [debug] [MainThread]: Command `dbt run` failed at 19:49:33.609064 after 3.93 seconds
[0m19:49:33.609463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c13d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10484e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b3cb0>]}
[0m19:49:33.609739 [debug] [MainThread]: Flushing usage events
[0m19:49:33.646698 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:51:35.335685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3ed0>]}


============================== 19:51:35.339573 | 9eb8e779-feb0-4cba-b7a7-00378ebcede6 ==============================
[0m19:51:35.339573 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:51:35.340084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:51:35.390098 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:51:35.390378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ec510>]}
[0m19:51:35.450161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f7ce0>]}
[0m19:51:35.480379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076efa50>]}
[0m19:51:35.481238 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:51:35.493196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:51:35.570160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:35.570563 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:51:35.696771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:51:35.703250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081172f0>]}
[0m19:51:35.762693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109829010>]}
[0m19:51:35.763005 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:51:35.763183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e61b20>]}
[0m19:51:35.764270 [info ] [MainThread]: 
[0m19:51:35.764556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:35.766706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m19:51:35.800546 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m19:51:35.800818 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m19:51:35.801030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:36.334680 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.533 seconds
[0m19:51:36.340066 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m19:51:36.341675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m19:51:36.342063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:51:36.348722 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:51:36.349851 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:51:36.350091 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:51:36.350276 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:51:36.350449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:36.350655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:36.692328 [debug] [ThreadPool]: SQL status: BEGIN in 0.341 seconds
[0m19:51:36.693042 [debug] [ThreadPool]: SQL status: BEGIN in 0.343 seconds
[0m19:51:36.694354 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:51:36.694900 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:51:36.695470 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:51:36.695976 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:51:36.724435 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.028 seconds
[0m19:51:36.731690 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:51:36.732647 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.036 seconds
[0m19:51:36.734001 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:51:36.765627 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:51:36.766467 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:51:36.779830 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:36.780301 [debug] [MainThread]: On master: BEGIN
[0m19:51:36.780633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:37.074902 [debug] [MainThread]: SQL status: BEGIN in 0.294 seconds
[0m19:51:37.076010 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:37.076991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:37.115515 [debug] [MainThread]: SQL status: SELECT 3 in 0.038 seconds
[0m19:51:37.118239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9ba10>]}
[0m19:51:37.118788 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:37.154176 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:37.154955 [debug] [MainThread]: On master: BEGIN
[0m19:51:37.222624 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m19:51:37.223735 [debug] [MainThread]: On master: COMMIT
[0m19:51:37.224193 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:37.224670 [debug] [MainThread]: On master: COMMIT
[0m19:51:37.258729 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m19:51:37.260768 [debug] [MainThread]: On master: Close
[0m19:51:37.263673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:37.264070 [info ] [MainThread]: 
[0m19:51:37.266435 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m19:51:37.266739 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m19:51:37.267149 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m19:51:37.267690 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m19:51:37.268243 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_products ................................ [RUN]
[0m19:51:37.268802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m19:51:37.269145 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_sales ................................... [RUN]
[0m19:51:37.269447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m19:51:37.269721 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:51:37.270017 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m19:51:37.270241 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:51:37.277399 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:51:37.277817 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:51:37.280722 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:51:37.282832 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:51:37.283401 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:51:37.289385 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:51:37.298114 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m19:51:37.321300 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m19:51:37.322127 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:51:37.324786 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:51:37.325336 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.325568 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.325938 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m19:51:37.326187 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.326406 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m19:51:37.326663 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:51:37.326873 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m19:51:37.327062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:37.327298 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:37.634568 [debug] [Thread-2 (]: SQL status: BEGIN in 0.307 seconds
[0m19:51:37.635004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.308 seconds
[0m19:51:37.635456 [debug] [Thread-3 (]: SQL status: BEGIN in 0.309 seconds
[0m19:51:37.635794 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.636153 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.636483 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.636827 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m19:51:37.637197 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m19:51:37.637568 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m19:51:37.684985 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m19:51:37.690937 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.691391 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m19:51:37.691669 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m19:51:37.694514 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.694944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m19:51:37.695283 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:51:37.697243 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.697530 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:51:37.731325 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:37.731583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:51:37.733297 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.733513 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:37.735373 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.735613 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:51:37.737201 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.737450 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:51:37.737728 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:51:37.767164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:51:37.767458 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:51:37.773803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:37.779692 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:51:37.780629 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:51:37.781437 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:51:37.781696 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.781919 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.782115 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.782310 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:51:37.782509 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:51:37.782700 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:51:37.820965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m19:51:37.825819 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m19:51:37.826117 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m19:51:37.826480 [debug] [Thread-2 (]: SQL status: COMMIT in 0.044 seconds
[0m19:51:37.830619 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:51:37.832214 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m19:51:37.833636 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m19:51:37.833923 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m19:51:37.834331 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:51:37.834698 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:51:37.835109 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m19:51:37.835427 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m19:51:37.872525 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m19:51:37.873031 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.037 seconds
[0m19:51:37.873309 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.038 seconds
[0m19:51:37.874957 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m19:51:37.875817 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m19:51:37.876609 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m19:51:37.878275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109be45d0>]}
[0m19:51:37.878820 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c83d90>]}
[0m19:51:37.879240 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac14f0>]}
[0m19:51:37.879587 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.61s]
[0m19:51:37.879895 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.61s]
[0m19:51:37.880361 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.61s]
[0m19:51:37.880738 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:51:37.880988 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:51:37.881224 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m19:51:37.881777 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m19:51:37.882030 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m19:51:37.882214 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m19:51:37.882464 [info ] [Thread-4 (]: 4 of 8 START sql table model public.customer_lifetime_value .................... [RUN]
[0m19:51:37.882747 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m19:51:37.882969 [info ] [Thread-1 (]: 5 of 8 START sql table model public.orders_by_customer ......................... [RUN]
[0m19:51:37.883274 [info ] [Thread-2 (]: 7 of 8 START sql table model public.product_performance ........................ [RUN]
[0m19:51:37.883591 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m19:51:37.883847 [info ] [Thread-3 (]: 6 of 8 START sql table model public.orders_by_day .............................. [RUN]
[0m19:51:37.884144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m19:51:37.884343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m19:51:37.884516 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m19:51:37.884685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m19:51:37.884848 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m19:51:37.885004 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m19:51:37.886678 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m19:51:37.886863 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m19:51:37.887885 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m19:51:37.888899 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m19:51:37.890399 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m19:51:37.890867 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m19:51:37.891219 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m19:51:37.902982 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m19:51:37.904916 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m19:51:37.905193 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m19:51:37.905516 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m19:51:37.907391 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m19:51:37.907739 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:37.909426 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m19:51:37.909756 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m19:51:37.910023 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:37.910441 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:37.910690 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:51:37.910980 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m19:51:37.911216 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:37.911396 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m19:51:37.911691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:37.911888 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m19:51:37.912066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:37.912295 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:51:38.227642 [debug] [Thread-3 (]: SQL status: BEGIN in 0.315 seconds
[0m19:51:38.228375 [debug] [Thread-4 (]: SQL status: BEGIN in 0.318 seconds
[0m19:51:38.228929 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:38.229601 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:38.230255 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m19:51:38.230807 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m19:51:38.236366 [debug] [Thread-2 (]: SQL status: BEGIN in 0.324 seconds
[0m19:51:38.237159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.325 seconds
[0m19:51:38.237627 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:38.238140 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:38.238646 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m19:51:38.239220 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m19:51:38.292872 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.061 seconds
[0m19:51:38.297636 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:38.297932 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m19:51:38.310164 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.070 seconds
[0m19:51:38.314920 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:38.315487 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m19:51:38.315733 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.076 seconds
[0m19:51:38.315969 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.085 seconds
[0m19:51:38.317597 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:38.318954 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:38.319177 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m19:51:38.319377 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m19:51:38.331686 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:51:38.335310 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:38.335541 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m19:51:38.348302 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:51:38.352798 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:38.353075 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m19:51:38.355590 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:38.357037 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:38.357309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m19:51:38.357550 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m19:51:38.359617 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:38.360197 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m19:51:38.371811 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:38.376474 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:51:38.376688 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:38.376851 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:51:38.388929 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:51:38.390744 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:51:38.390997 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:38.391170 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:51:38.396097 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:51:38.397374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m19:51:38.398632 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:51:38.399760 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:51:38.400294 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:38.400790 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:38.401257 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:51:38.401709 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:51:38.414892 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m19:51:38.418096 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m19:51:38.421081 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:51:38.421597 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m19:51:38.430345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.039 seconds
[0m19:51:38.431495 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m19:51:38.431766 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:51:38.431955 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m19:51:38.436815 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m19:51:38.442150 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m19:51:38.442412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m19:51:38.442722 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:51:38.443700 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m19:51:38.443891 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m19:51:38.444142 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:51:38.444395 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m19:51:38.454616 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.033 seconds
[0m19:51:38.455499 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m19:51:38.455926 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d39860>]}
[0m19:51:38.456261 [info ] [Thread-3 (]: 6 of 8 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.57s]
[0m19:51:38.456684 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m19:51:38.456907 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m19:51:38.457186 [info ] [Thread-3 (]: 8 of 8 START sql table model public.category_performance ....................... [RUN]
[0m19:51:38.457515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_day, now model.ecommerce_project.category_performance)
[0m19:51:38.457708 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:51:38.459253 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:51:38.459750 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m19:51:38.497000 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.053 seconds
[0m19:51:38.497318 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.065 seconds
[0m19:51:38.498906 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m19:51:38.499235 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m19:51:38.500023 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m19:51:38.500762 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m19:51:38.501602 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m19:51:38.502041 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:51:38.502231 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m19:51:38.502395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:51:38.502757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e99d0>]}
[0m19:51:38.503050 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c9b50>]}
[0m19:51:38.503400 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.62s]
[0m19:51:38.503742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c8470>]}
[0m19:51:38.504070 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m19:51:38.504354 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.62s]
[0m19:51:38.504855 [info ] [Thread-2 (]: 7 of 8 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.62s]
[0m19:51:38.505206 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m19:51:38.505493 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m19:51:38.822940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.320 seconds
[0m19:51:38.824311 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:51:38.825538 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.product_id as product_id,
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY product_id, category
  );
  
[0m19:51:38.861510 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column reference "product_id" is ambiguous
LINE 21: GROUP BY product_id, category
                  ^

[0m19:51:38.862960 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: ROLLBACK
[0m19:51:38.899214 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m19:51:38.908536 [debug] [Thread-3 (]: Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column reference "product_id" is ambiguous
  LINE 21: GROUP BY product_id, category
                    ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:51:38.908836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eb8e779-feb0-4cba-b7a7-00378ebcede6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b9910>]}
[0m19:51:38.909216 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model public.category_performance .............. [[31mERROR[0m in 0.45s]
[0m19:51:38.909608 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m19:51:38.910931 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:38.911143 [debug] [MainThread]: On master: BEGIN
[0m19:51:38.911291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:39.237218 [debug] [MainThread]: SQL status: BEGIN in 0.325 seconds
[0m19:51:39.238410 [debug] [MainThread]: On master: COMMIT
[0m19:51:39.238901 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:39.239534 [debug] [MainThread]: On master: COMMIT
[0m19:51:39.276662 [debug] [MainThread]: SQL status: COMMIT in 0.036 seconds
[0m19:51:39.277979 [debug] [MainThread]: On master: Close
[0m19:51:39.279688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:39.280188 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m19:51:39.280700 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m19:51:39.281126 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:51:39.281542 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m19:51:39.281815 [info ] [MainThread]: 
[0m19:51:39.282010 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m19:51:39.282866 [debug] [MainThread]: Command end result
[0m19:51:39.298139 [info ] [MainThread]: 
[0m19:51:39.298408 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:51:39.298560 [info ] [MainThread]: 
[0m19:51:39.298763 [error] [MainThread]:   Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column reference "product_id" is ambiguous
  LINE 21: GROUP BY product_id, category
                    ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:51:39.298914 [info ] [MainThread]: 
[0m19:51:39.299058 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:51:39.300265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0147743, "process_user_time": 1.561573, "process_kernel_time": 0.235716, "process_mem_max_rss": "127975424", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:51:39.300680 [debug] [MainThread]: Command `dbt run` failed at 19:51:39.300620 after 4.02 seconds
[0m19:51:39.300907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086be330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a552b0>]}
[0m19:51:39.301140 [debug] [MainThread]: Flushing usage events
[0m19:51:39.409061 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:53:01.519240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efed0>]}


============================== 19:53:01.522998 | 21b05890-6dde-4798-9a5b-66d94d174ebe ==============================
[0m19:53:01.522998 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:53:01.523426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:01.572924 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:53:01.573285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724510>]}
[0m19:53:01.623523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f7ce0>]}
[0m19:53:01.652144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064efa50>]}
[0m19:53:01.652877 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:53:01.664551 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:53:01.736744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:53:01.737167 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:53:01.857600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:53:01.864670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066532f0>]}
[0m19:53:01.921325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107525010>]}
[0m19:53:01.921612 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:53:01.921780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745db20>]}
[0m19:53:01.922881 [info ] [MainThread]: 
[0m19:53:01.923189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:53:01.925311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m19:53:01.957650 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m19:53:01.957888 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m19:53:01.958040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:02.429906 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.472 seconds
[0m19:53:02.431197 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m19:53:02.432898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m19:53:02.433379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:53:02.437773 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:53:02.438878 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:53:02.439111 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:53:02.439346 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:53:02.439541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:53:02.439718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:02.710211 [debug] [ThreadPool]: SQL status: BEGIN in 0.270 seconds
[0m19:53:02.711108 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:53:02.711619 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:53:02.736568 [debug] [ThreadPool]: SQL status: BEGIN in 0.296 seconds
[0m19:53:02.738004 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:53:02.738478 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:53:02.746162 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.034 seconds
[0m19:53:02.748299 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:53:02.775188 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:53:02.776176 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m19:53:02.778936 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:53:02.810661 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:53:02.816765 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:02.817267 [debug] [MainThread]: On master: BEGIN
[0m19:53:02.817590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:03.097569 [debug] [MainThread]: SQL status: BEGIN in 0.280 seconds
[0m19:53:03.099450 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:03.100444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:53:03.137964 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m19:53:03.145172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749ba10>]}
[0m19:53:03.145561 [debug] [MainThread]: On master: ROLLBACK
[0m19:53:03.172429 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:03.173156 [debug] [MainThread]: On master: BEGIN
[0m19:53:03.232021 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m19:53:03.232975 [debug] [MainThread]: On master: COMMIT
[0m19:53:03.233556 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:03.234013 [debug] [MainThread]: On master: COMMIT
[0m19:53:03.262086 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m19:53:03.262969 [debug] [MainThread]: On master: Close
[0m19:53:03.266477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:03.266919 [info ] [MainThread]: 
[0m19:53:03.269748 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m19:53:03.270265 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m19:53:03.270949 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m19:53:03.271523 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m19:53:03.271897 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_sales ................................... [RUN]
[0m19:53:03.272285 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_products ................................ [RUN]
[0m19:53:03.272761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m19:53:03.273407 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m19:53:03.273845 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m19:53:03.274254 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:53:03.274631 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:53:03.274998 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:53:03.284242 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:53:03.285416 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:53:03.287362 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:53:03.288205 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:53:03.293841 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m19:53:03.300239 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:53:03.325066 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:53:03.326277 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m19:53:03.328281 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:53:03.328936 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.329222 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.329438 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m19:53:03.329656 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m19:53:03.329859 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:53:03.330109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:03.330329 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.330733 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m19:53:03.330962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:03.597259 [debug] [Thread-2 (]: SQL status: BEGIN in 0.267 seconds
[0m19:53:03.597681 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.597926 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m19:53:03.615839 [debug] [Thread-3 (]: SQL status: BEGIN in 0.286 seconds
[0m19:53:03.616324 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.616753 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m19:53:03.623624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.293 seconds
[0m19:53:03.623917 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.624317 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m19:53:03.641457 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m19:53:03.647033 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.647388 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m19:53:03.655738 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m19:53:03.659362 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.659806 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:53:03.663530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m19:53:03.666326 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.666707 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:53:03.673524 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m19:53:03.675632 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.675995 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:53:03.691263 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:53:03.693428 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.693810 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:53:03.695843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:53:03.698487 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.698856 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:53:03.705343 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:53:03.718665 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:53:03.719007 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.719288 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:53:03.727149 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:53:03.728283 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:53:03.728636 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.728923 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:53:03.731963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:53:03.732930 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:53:03.733181 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.733405 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:53:03.752405 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m19:53:03.756940 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m19:53:03.760124 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:53:03.760432 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m19:53:03.760685 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m19:53:03.762324 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m19:53:03.762860 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:53:03.763160 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m19:53:03.763736 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m19:53:03.765068 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m19:53:03.765693 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:53:03.765926 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m19:53:03.792251 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.030 seconds
[0m19:53:03.793963 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m19:53:03.794866 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.031 seconds
[0m19:53:03.795517 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e4680>]}
[0m19:53:03.796426 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m19:53:03.796946 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.52s]
[0m19:53:03.797346 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m19:53:03.797753 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b80230>]}
[0m19:53:03.798208 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.52s]
[0m19:53:03.798554 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:53:03.798907 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m19:53:03.799147 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m19:53:03.799452 [info ] [Thread-2 (]: 5 of 8 START sql table model public.customer_lifetime_value .................... [RUN]
[0m19:53:03.799701 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m19:53:03.799984 [info ] [Thread-4 (]: 4 of 8 START sql table model public.category_performance ....................... [RUN]
[0m19:53:03.800292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m19:53:03.800585 [info ] [Thread-3 (]: 6 of 8 START sql table model public.orders_by_customer ......................... [RUN]
[0m19:53:03.800881 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m19:53:03.801096 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m19:53:03.801312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m19:53:03.801515 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:53:03.803380 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m19:53:03.803691 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m19:53:03.803941 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m19:53:03.805852 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:53:03.807012 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m19:53:03.808614 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m19:53:03.809124 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m19:53:03.815357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e37d0>]}
[0m19:53:03.821713 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m19:53:03.825411 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m19:53:03.825816 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:53:03.826219 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m19:53:03.826510 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m19:53:03.826837 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m19:53:03.828991 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m19:53:03.830903 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m19:53:03.831278 [info ] [Thread-1 (]: 7 of 8 START sql table model public.orders_by_day .............................. [RUN]
[0m19:53:03.831611 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:03.831997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m19:53:03.832287 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m19:53:03.832535 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m19:53:03.832773 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:03.832973 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:53:03.833171 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:53:03.834730 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m19:53:03.834994 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m19:53:03.835223 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m19:53:03.835569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:53:03.835795 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:03.836178 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m19:53:03.838118 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m19:53:03.838514 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:03.838688 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m19:53:03.838851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:53:04.105564 [debug] [Thread-2 (]: SQL status: BEGIN in 0.272 seconds
[0m19:53:04.105976 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:04.106254 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m19:53:04.138068 [debug] [Thread-3 (]: SQL status: BEGIN in 0.302 seconds
[0m19:53:04.138322 [debug] [Thread-4 (]: SQL status: BEGIN in 0.303 seconds
[0m19:53:04.138542 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:04.138802 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:53:04.139035 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m19:53:04.139281 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.product_id as product_id,
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY stg_products.category
  );
  
[0m19:53:04.145224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.306 seconds
[0m19:53:04.145431 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:04.145641 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m19:53:04.175252 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 13:     stg_products.product_id as product_id,
             ^

[0m19:53:04.176289 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: ROLLBACK
[0m19:53:04.185569 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.079 seconds
[0m19:53:04.190650 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:04.190963 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m19:53:04.202320 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m19:53:04.213462 [debug] [Thread-4 (]: Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:     stg_products.product_id as product_id,
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:53:04.214201 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6e0b0>]}
[0m19:53:04.215001 [error] [Thread-4 (]: 4 of 8 ERROR creating sql table model public.category_performance .............. [[31mERROR[0m in 0.41s]
[0m19:53:04.215722 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m19:53:04.216206 [debug] [Thread-4 (]: Began running node model.ecommerce_project.product_performance
[0m19:53:04.217250 [info ] [Thread-4 (]: 8 of 8 START sql table model public.product_performance ........................ [RUN]
[0m19:53:04.217661 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.product_performance)
[0m19:53:04.217957 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.product_performance
[0m19:53:04.220211 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m19:53:04.220518 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m19:53:04.222640 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:04.222933 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m19:53:04.223180 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.077 seconds
[0m19:53:04.225495 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:04.225890 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.086 seconds
[0m19:53:04.226194 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m19:53:04.226556 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.product_performance
[0m19:53:04.229337 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:04.231475 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m19:53:04.231758 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m19:53:04.232384 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.232691 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: BEGIN
[0m19:53:04.232937 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:53:04.253139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:53:04.256768 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:53:04.257031 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:04.257244 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:53:04.257850 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m19:53:04.259652 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:04.259871 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:53:04.260103 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m19:53:04.262372 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:04.262718 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m19:53:04.290562 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m19:53:04.290888 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m19:53:04.291966 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:53:04.293365 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m19:53:04.293619 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:04.293834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:53:04.295699 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:53:04.295941 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:53:04.296831 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:53:04.297067 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m19:53:04.297386 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:04.297734 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:53:04.327106 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m19:53:04.327529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m19:53:04.332887 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m19:53:04.333216 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.035 seconds
[0m19:53:04.334612 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m19:53:04.334995 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:53:04.335901 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m19:53:04.336283 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:53:04.336529 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m19:53:04.336849 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m19:53:04.337203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e9310>]}
[0m19:53:04.337671 [info ] [Thread-2 (]: 5 of 8 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.54s]
[0m19:53:04.338060 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m19:53:04.374820 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m19:53:04.376122 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m19:53:04.376423 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m19:53:04.377411 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m19:53:04.377801 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ebcb0>]}
[0m19:53:04.378326 [info ] [Thread-3 (]: 6 of 8 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.58s]
[0m19:53:04.378779 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m19:53:04.379112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb590>]}
[0m19:53:04.379607 [info ] [Thread-1 (]: 7 of 8 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.55s]
[0m19:53:04.379980 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m19:53:04.511038 [debug] [Thread-4 (]: SQL status: BEGIN in 0.278 seconds
[0m19:53:04.511438 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.511686 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m19:53:04.561142 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.049 seconds
[0m19:53:04.563538 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.563849 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m19:53:04.594884 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:53:04.597083 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.597454 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m19:53:04.630073 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:53:04.682035 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:53:04.682348 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.682549 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:53:04.712639 [debug] [Thread-4 (]: SQL status: COMMIT in 0.030 seconds
[0m19:53:04.714138 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m19:53:04.714507 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:53:04.714770 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m19:53:04.749229 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.034 seconds
[0m19:53:04.750511 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: Close
[0m19:53:04.751041 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21b05890-6dde-4798-9a5b-66d94d174ebe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8fc50>]}
[0m19:53:04.751458 [info ] [Thread-4 (]: 8 of 8 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.53s]
[0m19:53:04.751839 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.product_performance
[0m19:53:04.752943 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:04.753185 [debug] [MainThread]: On master: BEGIN
[0m19:53:04.753352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:53:05.037548 [debug] [MainThread]: SQL status: BEGIN in 0.284 seconds
[0m19:53:05.038372 [debug] [MainThread]: On master: COMMIT
[0m19:53:05.038844 [debug] [MainThread]: Using postgres connection "master"
[0m19:53:05.039253 [debug] [MainThread]: On master: COMMIT
[0m19:53:05.070350 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m19:53:05.070650 [debug] [MainThread]: On master: Close
[0m19:53:05.071056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:05.071552 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m19:53:05.072024 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m19:53:05.072645 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m19:53:05.072935 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m19:53:05.073198 [info ] [MainThread]: 
[0m19:53:05.073412 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m19:53:05.075303 [debug] [MainThread]: Command end result
[0m19:53:05.097459 [info ] [MainThread]: 
[0m19:53:05.097898 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:53:05.098158 [info ] [MainThread]: 
[0m19:53:05.098466 [error] [MainThread]:   Database Error in model category_performance (models/marts/sales_reporting/category_performance.sql)
  column "stg_products.product_id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:     stg_products.product_id as product_id,
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/category_performance.sql
[0m19:53:05.098709 [info ] [MainThread]: 
[0m19:53:05.098940 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:53:05.100539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.62678, "process_user_time": 1.501565, "process_kernel_time": 0.235537, "process_mem_max_rss": "128188416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:53:05.100956 [debug] [MainThread]: Command `dbt run` failed at 19:53:05.100878 after 3.63 seconds
[0m19:53:05.101250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fda990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba5eb0>]}
[0m19:53:05.101543 [debug] [MainThread]: Flushing usage events
[0m19:53:05.217772 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:55:55.476007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eefed0>]}


============================== 19:55:55.479804 | d9d0ec5d-c635-4556-8484-bab6b83f1ade ==============================
[0m19:55:55.479804 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:55.480281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:55:55.549049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:55:55.549341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112024510>]}
[0m19:55:55.603783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bf7ce0>]}
[0m19:55:55.632832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb3a50>]}
[0m19:55:55.633679 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:55:55.645364 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:55.721721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:55.722133 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:55:55.846576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:55:55.853025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f532f0>]}
[0m19:55:55.911555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e31010>]}
[0m19:55:55.911849 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:55:55.912021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d61b20>]}
[0m19:55:55.913094 [info ] [MainThread]: 
[0m19:55:55.913397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:55:55.915496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m19:55:55.960720 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m19:55:55.961049 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m19:55:55.961213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:56.473026 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.511 seconds
[0m19:55:56.477033 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m19:55:56.478898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m19:55:56.479330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m19:55:56.485567 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:55:56.486949 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:55:56.487195 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:55:56.487393 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:55:56.487582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:56.487750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:56.783859 [debug] [ThreadPool]: SQL status: BEGIN in 0.296 seconds
[0m19:55:56.785319 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:55:56.785964 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:55:56.809642 [debug] [ThreadPool]: SQL status: BEGIN in 0.322 seconds
[0m19:55:56.810277 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:55:56.810740 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:55:56.819422 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m19:55:56.823639 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:55:56.845366 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.034 seconds
[0m19:55:56.847679 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:55:56.855433 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:55:56.887147 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:55:56.898075 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:56.898569 [debug] [MainThread]: On master: BEGIN
[0m19:55:56.898913 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:55:57.199464 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m19:55:57.199879 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:57.200395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:55:57.244940 [debug] [MainThread]: SQL status: SELECT 3 in 0.044 seconds
[0m19:55:57.249829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d93a10>]}
[0m19:55:57.250569 [debug] [MainThread]: On master: ROLLBACK
[0m19:55:57.283529 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:57.284186 [debug] [MainThread]: On master: BEGIN
[0m19:55:57.347810 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m19:55:57.349206 [debug] [MainThread]: On master: COMMIT
[0m19:55:57.350095 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:57.350904 [debug] [MainThread]: On master: COMMIT
[0m19:55:57.383991 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m19:55:57.385272 [debug] [MainThread]: On master: Close
[0m19:55:57.387422 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:55:57.388130 [info ] [MainThread]: 
[0m19:55:57.390990 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m19:55:57.391304 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m19:55:57.391583 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m19:55:57.391966 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_sales ................................... [RUN]
[0m19:55:57.392299 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_products ................................ [RUN]
[0m19:55:57.392615 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m19:55:57.392994 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m19:55:57.393263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m19:55:57.393514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m19:55:57.394034 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:55:57.394283 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:55:57.394499 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:55:57.401704 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:55:57.404556 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:55:57.406901 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:55:57.407861 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:55:57.408239 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:55:57.408493 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m19:55:57.444585 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:55:57.446666 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:55:57.447014 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m19:55:57.447779 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.448074 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.448312 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m19:55:57.448538 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.448806 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m19:55:57.449027 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:55:57.449226 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m19:55:57.449421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:57.449785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:57.739244 [debug] [Thread-2 (]: SQL status: BEGIN in 0.289 seconds
[0m19:55:57.739799 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.740210 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m19:55:57.747884 [debug] [Thread-3 (]: SQL status: BEGIN in 0.299 seconds
[0m19:55:57.748249 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.748739 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m19:55:57.756362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.307 seconds
[0m19:55:57.756668 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.756911 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m19:55:57.788892 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m19:55:57.796109 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.796550 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m19:55:57.799505 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m19:55:57.802255 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.802682 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:55:57.809417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.052 seconds
[0m19:55:57.812396 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.812775 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:55:57.827502 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:55:57.829494 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.829736 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:55:57.836174 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:55:57.837906 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.838136 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:55:57.844728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:55:57.847713 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.848109 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:55:57.863582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:55:57.880061 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:55:57.880433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:55:57.880712 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.880924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m19:55:57.881942 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:55:57.882209 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:55:57.883077 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:55:57.883317 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.883599 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.883806 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:55:57.884003 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:55:57.924632 [debug] [Thread-2 (]: SQL status: COMMIT in 0.041 seconds
[0m19:55:57.924899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m19:55:57.929519 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m19:55:57.929826 [debug] [Thread-3 (]: SQL status: COMMIT in 0.046 seconds
[0m19:55:57.931018 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m19:55:57.934269 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:55:57.935576 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m19:55:57.935907 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:55:57.936132 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m19:55:57.936430 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:55:57.936671 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m19:55:57.936947 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m19:55:57.974410 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.037 seconds
[0m19:55:57.975017 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m19:55:57.975530 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m19:55:57.978269 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m19:55:57.979576 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m19:55:57.980810 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m19:55:57.982343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131e8890>]}
[0m19:55:57.982813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132028f0>]}
[0m19:55:57.983171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135c1090>]}
[0m19:55:57.983668 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.59s]
[0m19:55:57.984159 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.59s]
[0m19:55:57.984646 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.59s]
[0m19:55:57.985118 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:55:57.985511 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:55:57.985884 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m19:55:57.986520 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m19:55:57.986817 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m19:55:57.987067 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m19:55:57.987313 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m19:55:57.987801 [info ] [Thread-4 (]: 4 of 8 START sql table model public.customer_lifetime_value .................... [RUN]
[0m19:55:57.988156 [info ] [Thread-2 (]: 7 of 8 START sql table model public.product_performance ........................ [RUN]
[0m19:55:57.988558 [info ] [Thread-1 (]: 5 of 8 START sql table model public.orders_by_customer ......................... [RUN]
[0m19:55:57.989241 [info ] [Thread-3 (]: 6 of 8 START sql table model public.orders_by_day .............................. [RUN]
[0m19:55:57.989728 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m19:55:57.990064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m19:55:57.990422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m19:55:57.990673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m19:55:57.990919 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m19:55:57.991219 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m19:55:57.991460 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m19:55:57.991742 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m19:55:57.994323 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m19:55:57.996189 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m19:55:57.997726 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m19:55:57.999674 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m19:55:58.000617 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m19:55:58.006239 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m19:55:58.006572 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m19:55:58.015938 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m19:55:58.016252 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m19:55:58.018226 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m19:55:58.019778 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m19:55:58.021971 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.022583 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.023048 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.023295 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m19:55:58.023551 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.023813 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m19:55:58.024051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:55:58.024274 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.024468 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m19:55:58.024670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:55:58.024987 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m19:55:58.025231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:58.025575 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:55:58.335259 [debug] [Thread-3 (]: SQL status: BEGIN in 0.311 seconds
[0m19:55:58.335649 [debug] [Thread-4 (]: SQL status: BEGIN in 0.310 seconds
[0m19:55:58.335916 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.336161 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.336393 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m19:55:58.336638 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m19:55:58.342875 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m19:55:58.343403 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.343712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.318 seconds
[0m19:55:58.343986 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m19:55:58.344235 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.344542 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m19:55:58.423958 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.086 seconds
[0m19:55:58.425037 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.088 seconds
[0m19:55:58.426024 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.081 seconds
[0m19:55:58.430250 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.434020 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.434469 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.090 seconds
[0m19:55:58.437782 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.438262 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m19:55:58.438682 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m19:55:58.441323 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.441751 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m19:55:58.442202 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m19:55:58.476136 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:55:58.476664 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:55:58.476925 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:55:58.478973 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.479214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m19:55:58.481140 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.482709 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.482943 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m19:55:58.484488 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.484709 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m19:55:58.484925 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m19:55:58.485180 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m19:55:58.519796 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:55:58.520074 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:55:58.523637 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:55:58.523882 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m19:55:58.524117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m19:55:58.525717 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:55:58.526161 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.527510 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:55:58.528797 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:55:58.529146 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.529451 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:55:58.529732 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.530002 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.530278 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:55:58.530622 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:55:58.530886 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:55:58.562343 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m19:55:58.562698 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m19:55:58.563091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m19:55:58.563449 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m19:55:58.566036 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m19:55:58.567829 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m19:55:58.573188 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m19:55:58.574831 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m19:55:58.577394 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:55:58.577880 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:55:58.578388 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:55:58.578795 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:55:58.579074 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m19:55:58.579361 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m19:55:58.579593 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m19:55:58.579802 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m19:55:58.614549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.034 seconds
[0m19:55:58.615820 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m19:55:58.616181 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m19:55:58.616554 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.036 seconds
[0m19:55:58.616856 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m19:55:58.617307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135f92b0>]}
[0m19:55:58.618406 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m19:55:58.619402 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m19:55:58.620364 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m19:55:58.620892 [info ] [Thread-1 (]: 5 of 8 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.63s]
[0m19:55:58.621412 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ed250>]}
[0m19:55:58.621794 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m19:55:58.622057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131efd10>]}
[0m19:55:58.622300 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ed670>]}
[0m19:55:58.623029 [debug] [Thread-1 (]: Began running node model.ecommerce_project.category_performance
[0m19:55:58.622673 [info ] [Thread-2 (]: 7 of 8 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.63s]
[0m19:55:58.623589 [info ] [Thread-3 (]: 6 of 8 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.63s]
[0m19:55:58.623983 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.63s]
[0m19:55:58.624307 [info ] [Thread-1 (]: 8 of 8 START sql table model public.category_performance ....................... [RUN]
[0m19:55:58.624649 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m19:55:58.625086 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m19:55:58.625429 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m19:55:58.625719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m19:55:58.626186 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:55:58.628374 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:55:58.629002 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.category_performance
[0m19:55:58.670696 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m19:55:58.671219 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:58.671411 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: BEGIN
[0m19:55:58.671578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:58.951589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.280 seconds
[0m19:55:58.952294 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:58.952972 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.product_id as product_id,
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY stg_products.product_id, category
  );
  
[0m19:55:59.010214 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.057 seconds
[0m19:55:59.014534 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:59.014896 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m19:55:59.048440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:55:59.052964 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:59.053232 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m19:55:59.084869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:55:59.086882 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m19:55:59.087229 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:59.087450 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m19:55:59.121143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m19:55:59.124743 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m19:55:59.125639 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:55:59.126179 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m19:55:59.163221 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m19:55:59.164759 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: Close
[0m19:55:59.165659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9d0ec5d-c635-4556-8484-bab6b83f1ade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ed430>]}
[0m19:55:59.166396 [info ] [Thread-1 (]: 8 of 8 OK created sql table model public.category_performance .................. [[32mSELECT 4[0m in 0.54s]
[0m19:55:59.167063 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.category_performance
[0m19:55:59.168430 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:59.168712 [debug] [MainThread]: On master: BEGIN
[0m19:55:59.169035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:55:59.494047 [debug] [MainThread]: SQL status: BEGIN in 0.325 seconds
[0m19:55:59.495170 [debug] [MainThread]: On master: COMMIT
[0m19:55:59.495742 [debug] [MainThread]: Using postgres connection "master"
[0m19:55:59.496142 [debug] [MainThread]: On master: COMMIT
[0m19:55:59.535917 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m19:55:59.537036 [debug] [MainThread]: On master: Close
[0m19:55:59.538376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:59.538675 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:55:59.538850 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m19:55:59.539087 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m19:55:59.539288 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m19:55:59.539610 [info ] [MainThread]: 
[0m19:55:59.540024 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m19:55:59.542575 [debug] [MainThread]: Command end result
[0m19:55:59.569003 [info ] [MainThread]: 
[0m19:55:59.569397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:55:59.569642 [info ] [MainThread]: 
[0m19:55:59.569893 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:55:59.571572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.140628, "process_user_time": 1.567777, "process_kernel_time": 0.250823, "process_mem_max_rss": "126894080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:55:59.572001 [debug] [MainThread]: Command `dbt run` succeeded at 19:55:59.571932 after 4.14 seconds
[0m19:55:59.572303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112551f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359f1d0>]}
[0m19:55:59.572619 [debug] [MainThread]: Flushing usage events
[0m19:55:59.664729 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:56:17.373852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11826d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7b3ed0>]}


============================== 19:56:17.377279 | d81e11e0-70c7-4c16-a70a-4d65e704f31f ==============================
[0m19:56:17.377279 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:56:17.377698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt show --select category_performance', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:56:17.427357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:56:17.427669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8ec510>]}
[0m19:56:17.477045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a2f7ce0>]}
[0m19:56:17.505891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4efa50>]}
[0m19:56:17.506531 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:56:17.519340 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:56:17.591939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:17.592306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:17.595463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:56:17.616023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ada5a90>]}
[0m19:56:17.676080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8a2dd0>]}
[0m19:56:17.676449 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:56:17.676635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b356dd0>]}
[0m19:56:17.677584 [info ] [MainThread]: 
[0m19:56:17.677923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:17.680242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:56:17.681427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m19:56:17.715077 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:17.715395 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:17.715596 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:56:17.715797 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:56:17.715983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:17.716194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:18.160951 [debug] [ThreadPool]: SQL status: BEGIN in 0.445 seconds
[0m19:56:18.162007 [debug] [ThreadPool]: SQL status: BEGIN in 0.446 seconds
[0m19:56:18.162598 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:18.163243 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:18.163762 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:56:18.164045 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:18.203896 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.040 seconds
[0m19:56:18.204339 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.040 seconds
[0m19:56:18.205676 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:56:18.207166 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:56:18.235504 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:56:18.235840 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:56:18.245740 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:18.246183 [debug] [MainThread]: On master: BEGIN
[0m19:56:18.246462 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:18.547930 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m19:56:18.550460 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:18.551522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:18.593040 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m19:56:18.596848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81e11e0-70c7-4c16-a70a-4d65e704f31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3bec90>]}
[0m19:56:18.597327 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:18.631335 [debug] [MainThread]: On master: Close
[0m19:56:18.632048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:18.632756 [info ] [MainThread]: 
[0m19:56:18.636454 [debug] [Thread-1 (]: Began running node model.ecommerce_project.category_performance
[0m19:56:18.636879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.category_performance)
[0m19:56:18.637156 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:56:18.646625 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:56:18.647661 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.category_performance
[0m19:56:18.654040 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:18.654464 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
  SELECT 
    stg_products.product_id as product_id,
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY stg_products.product_id, category
  
  limit 5

[0m19:56:18.654806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:18.943819 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.288 seconds
[0m19:56:18.948581 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: Close
[0m19:56:18.950304 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.category_performance
[0m19:56:18.951553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:18.951858 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:56:18.952063 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m19:56:18.952533 [debug] [MainThread]: Command end result
[0m19:56:18.980767 [info ] [MainThread]: Previewing node 'category_performance':
| product_id | category    | total_sales | total_revenue | avg_price |
| ---------- | ----------- | ----------- | ------------- | --------- |
|        202 | Home        |         752 |    128,729.20 |  527.579… |
|        203 | Home        |         705 |    117,598.41 |  500.419… |
|        201 | Electronics |         804 |    138,958.68 |  514.662… |
|        204 | Home        |         750 |    133,765.23 |  532.929… |

[0m19:56:18.982736 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.6537156, "process_user_time": 1.089021, "process_kernel_time": 0.198168, "process_mem_max_rss": "121487360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:56:18.983264 [debug] [MainThread]: Command `dbt show` succeeded at 19:56:18.983187 after 1.65 seconds
[0m19:56:18.983564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b391860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3eb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b781b30>]}
[0m19:56:18.983833 [debug] [MainThread]: Flushing usage events
[0m19:56:19.021183 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:56:35.941843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eefed0>]}


============================== 19:56:35.945134 | a7b343cd-3ea0-42d4-82aa-1b18cd893af9 ==============================
[0m19:56:35.945134 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:56:35.945615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:56:35.997964 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:56:35.998261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105024510>]}
[0m19:56:36.049457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf7ce0>]}
[0m19:56:36.076162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb3a50>]}
[0m19:56:36.076840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:56:36.088195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:56:36.161493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:56:36.161931 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/category_performance.sql
[0m19:56:36.283697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:56:36.290810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f532f0>]}
[0m19:56:36.345886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106131010>]}
[0m19:56:36.346213 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:56:36.346391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605db20>]}
[0m19:56:36.347589 [info ] [MainThread]: 
[0m19:56:36.347897 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:36.350156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m19:56:36.382423 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m19:56:36.382681 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m19:56:36.382837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:36.813054 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.430 seconds
[0m19:56:36.816971 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m19:56:36.818827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m19:56:36.819281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m19:56:36.823607 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:36.824651 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:36.824883 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:56:36.825063 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:56:36.825231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:36.825455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:37.119493 [debug] [ThreadPool]: SQL status: BEGIN in 0.294 seconds
[0m19:56:37.120790 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:37.122551 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:56:37.136361 [debug] [ThreadPool]: SQL status: BEGIN in 0.311 seconds
[0m19:56:37.137475 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:37.138308 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:37.158989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m19:56:37.160691 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:56:37.175432 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.036 seconds
[0m19:56:37.179542 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:56:37.195187 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:56:37.212023 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:56:37.225185 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.225678 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.226013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:37.536371 [debug] [MainThread]: SQL status: BEGIN in 0.310 seconds
[0m19:56:37.537905 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.538677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:37.581306 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m19:56:37.586046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609ba10>]}
[0m19:56:37.586853 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:37.624836 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.625682 [debug] [MainThread]: On master: BEGIN
[0m19:56:37.691576 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m19:56:37.692169 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.692590 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:37.692894 [debug] [MainThread]: On master: COMMIT
[0m19:56:37.727528 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m19:56:37.728253 [debug] [MainThread]: On master: Close
[0m19:56:37.729396 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:37.730085 [info ] [MainThread]: 
[0m19:56:37.732911 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m19:56:37.733213 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m19:56:37.733468 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m19:56:37.733834 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_products ................................ [RUN]
[0m19:56:37.734200 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m19:56:37.734528 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_sales ................................... [RUN]
[0m19:56:37.734913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m19:56:37.735177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m19:56:37.735478 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m19:56:37.735709 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m19:56:37.735935 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m19:56:37.736149 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m19:56:37.742565 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m19:56:37.745340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m19:56:37.747792 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m19:56:37.748575 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m19:56:37.748874 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m19:56:37.755250 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m19:56:37.783633 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m19:56:37.784694 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m19:56:37.786705 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m19:56:37.787379 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:37.787683 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:37.787941 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m19:56:37.788252 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:37.788481 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m19:56:37.788701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:37.788934 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m19:56:37.789146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:37.789412 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:56:38.091385 [debug] [Thread-3 (]: SQL status: BEGIN in 0.302 seconds
[0m19:56:38.091740 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:38.091984 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m19:56:38.102981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.314 seconds
[0m19:56:38.103291 [debug] [Thread-2 (]: SQL status: BEGIN in 0.314 seconds
[0m19:56:38.103542 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:38.103795 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:38.104077 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m19:56:38.104340 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m19:56:38.140159 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m19:56:38.148401 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:38.149095 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:56:38.152914 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m19:56:38.157403 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:38.157962 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m19:56:38.158386 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m19:56:38.160721 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:38.161065 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m19:56:38.179675 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:56:38.182173 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:38.182453 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:56:38.195488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m19:56:38.199502 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:38.200027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m19:56:38.200341 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m19:56:38.202412 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:38.202759 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m19:56:38.215370 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:56:38.232287 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:56:38.232708 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:56:38.232969 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:38.233201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:56:38.234318 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:56:38.234637 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m19:56:38.235588 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:56:38.235854 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:38.236192 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:38.236445 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m19:56:38.236692 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m19:56:38.268987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m19:56:38.269292 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m19:56:38.274949 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m19:56:38.275262 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m19:56:38.276789 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m19:56:38.280601 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m19:56:38.282057 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m19:56:38.282456 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m19:56:38.282725 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m19:56:38.283058 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m19:56:38.283295 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m19:56:38.283643 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m19:56:38.319956 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m19:56:38.320259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m19:56:38.322311 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m19:56:38.323556 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m19:56:38.323860 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.040 seconds
[0m19:56:38.325037 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m19:56:38.326260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e45d0>]}
[0m19:56:38.326645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bc0f0>]}
[0m19:56:38.327002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bcaf0>]}
[0m19:56:38.327480 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.59s]
[0m19:56:38.327877 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.59s]
[0m19:56:38.328837 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m19:56:38.328263 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.59s]
[0m19:56:38.329207 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m19:56:38.329791 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m19:56:38.330208 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m19:56:38.330472 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m19:56:38.330742 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m19:56:38.331025 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m19:56:38.331424 [info ] [Thread-4 (]: 4 of 8 START sql table model public.customer_lifetime_value .................... [RUN]
[0m19:56:38.331852 [info ] [Thread-3 (]: 5 of 8 START sql table model public.orders_by_customer ......................... [RUN]
[0m19:56:38.332182 [info ] [Thread-1 (]: 6 of 8 START sql table model public.orders_by_day .............................. [RUN]
[0m19:56:38.332501 [info ] [Thread-2 (]: 7 of 8 START sql table model public.product_performance ........................ [RUN]
[0m19:56:38.332858 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m19:56:38.333109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m19:56:38.333461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m19:56:38.333732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.product_performance)
[0m19:56:38.334098 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m19:56:38.334408 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m19:56:38.334708 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m19:56:38.334978 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m19:56:38.337246 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.339031 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m19:56:38.340706 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m19:56:38.342495 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m19:56:38.343206 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m19:56:38.356161 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m19:56:38.361330 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m19:56:38.361668 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m19:56:38.361939 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m19:56:38.363693 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.365602 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m19:56:38.367618 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m19:56:38.368133 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.368454 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m19:56:38.368792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:56:38.369146 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.369367 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.369578 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m19:56:38.369825 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.370013 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m19:56:38.370214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:38.370429 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m19:56:38.370695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:56:38.370996 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:38.659064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.290 seconds
[0m19:56:38.659633 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.660055 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m19:56:38.666887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.297 seconds
[0m19:56:38.667286 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.667567 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m19:56:38.679770 [debug] [Thread-2 (]: SQL status: BEGIN in 0.309 seconds
[0m19:56:38.680221 [debug] [Thread-4 (]: SQL status: BEGIN in 0.310 seconds
[0m19:56:38.680621 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.681010 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.681418 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m19:56:38.681863 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m19:56:38.728892 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.068 seconds
[0m19:56:38.733905 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.734514 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m19:56:38.761023 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.093 seconds
[0m19:56:38.761815 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.080 seconds
[0m19:56:38.766556 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.767049 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.085 seconds
[0m19:56:38.769456 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.769732 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:56:38.769976 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m19:56:38.771771 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.772172 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m19:56:38.774038 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.774337 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m19:56:38.774611 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m19:56:38.808473 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m19:56:38.809696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m19:56:38.810363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:56:38.810900 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m19:56:38.817688 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:56:38.819655 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.821230 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.823681 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.824104 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.824471 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m19:56:38.824829 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m19:56:38.825189 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m19:56:38.825516 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m19:56:38.855506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:56:38.855817 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:56:38.856794 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:56:38.857047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m19:56:38.857924 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:56:38.858166 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.859342 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:56:38.859559 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.859757 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m19:56:38.859957 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.860167 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m19:56:38.860406 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m19:56:38.868638 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m19:56:38.869977 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m19:56:38.872854 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m19:56:38.873247 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m19:56:38.893036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m19:56:38.893302 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m19:56:38.894739 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m19:56:38.894946 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m19:56:38.900039 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m19:56:38.900684 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m19:56:38.902656 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m19:56:38.903203 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m19:56:38.903567 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m19:56:38.904044 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m19:56:38.904397 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m19:56:38.904825 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m19:56:38.911089 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.038 seconds
[0m19:56:38.912046 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m19:56:38.912471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107858de0>]}
[0m19:56:38.912910 [info ] [Thread-3 (]: 5 of 8 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.58s]
[0m19:56:38.913316 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m19:56:38.913677 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m19:56:38.914164 [info ] [Thread-3 (]: 8 of 8 START sql table model public.category_performance ....................... [RUN]
[0m19:56:38.914444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m19:56:38.914687 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:56:38.916776 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:56:38.917488 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m19:56:38.957791 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.053 seconds
[0m19:56:38.958170 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.053 seconds
[0m19:56:38.958382 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.053 seconds
[0m19:56:38.959442 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m19:56:38.960864 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m19:56:38.961819 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m19:56:38.962548 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m19:56:38.962978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e2390>]}
[0m19:56:38.963260 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e2270>]}
[0m19:56:38.963678 [info ] [Thread-1 (]: 6 of 8 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.63s]
[0m19:56:38.964081 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m19:56:38.964726 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e82030>]}
[0m19:56:38.964460 [info ] [Thread-2 (]: 7 of 8 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.63s]
[0m19:56:38.965012 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:38.965553 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m19:56:38.965305 [info ] [Thread-4 (]: 4 of 8 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.63s]
[0m19:56:38.965778 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m19:56:38.966135 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m19:56:38.966321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:56:39.251302 [debug] [Thread-3 (]: SQL status: BEGIN in 0.285 seconds
[0m19:56:39.251783 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:39.252110 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m19:56:39.314124 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.061 seconds
[0m19:56:39.319253 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:39.319581 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m19:56:39.351920 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m19:56:39.356253 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:39.356619 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m19:56:39.387727 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m19:56:39.391874 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m19:56:39.392664 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:39.393050 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m19:56:39.424355 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m19:56:39.426827 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m19:56:39.427264 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:39.427507 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m19:56:39.474469 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.047 seconds
[0m19:56:39.476393 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m19:56:39.477460 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7b343cd-3ea0-42d4-82aa-1b18cd893af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff63f0>]}
[0m19:56:39.478344 [info ] [Thread-3 (]: 8 of 8 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.56s]
[0m19:56:39.479160 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m19:56:39.480541 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:39.480840 [debug] [MainThread]: On master: BEGIN
[0m19:56:39.481028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:56:39.784193 [debug] [MainThread]: SQL status: BEGIN in 0.303 seconds
[0m19:56:39.785258 [debug] [MainThread]: On master: COMMIT
[0m19:56:39.785758 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:39.786179 [debug] [MainThread]: On master: COMMIT
[0m19:56:39.819882 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m19:56:39.821106 [debug] [MainThread]: On master: Close
[0m19:56:39.823114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:39.823758 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m19:56:39.824210 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m19:56:39.824652 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:56:39.825149 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m19:56:39.825861 [info ] [MainThread]: 
[0m19:56:39.826366 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m19:56:39.828561 [debug] [MainThread]: Command end result
[0m19:56:39.855704 [info ] [MainThread]: 
[0m19:56:39.856098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:39.856348 [info ] [MainThread]: 
[0m19:56:39.856594 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:56:39.858078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9590454, "process_user_time": 1.539155, "process_kernel_time": 0.208674, "process_mem_max_rss": "127254528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:56:39.858556 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:39.858483 after 3.96 seconds
[0m19:56:39.858808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042532f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067aeed0>]}
[0m19:56:39.859041 [debug] [MainThread]: Flushing usage events
[0m19:56:39.894756 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m19:56:43.185233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3ed0>]}


============================== 19:56:43.187592 | be5e0700-01e3-4a68-a534-396a20c18499 ==============================
[0m19:56:43.187592 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:56:43.187904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select category_performance', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:56:43.223733 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m19:56:43.224037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e8510>]}
[0m19:56:43.272596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f7ce0>]}
[0m19:56:43.300745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b3a50>]}
[0m19:56:43.301316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:56:43.311294 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:56:43.374599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:43.374848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:43.377617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:56:43.398362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128481a90>]}
[0m19:56:43.455656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a2dd0>]}
[0m19:56:43.455971 [info ] [MainThread]: Found 8 models, 1 snapshot, 3 sources, 424 macros
[0m19:56:43.456149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285aedd0>]}
[0m19:56:43.457120 [info ] [MainThread]: 
[0m19:56:43.457485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:56:43.459841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m19:56:43.460231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m19:56:43.491566 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:43.491844 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:43.492115 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m19:56:43.492312 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m19:56:43.492471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.492632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:43.799697 [debug] [ThreadPool]: SQL status: BEGIN in 0.307 seconds
[0m19:56:43.800097 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m19:56:43.800373 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:56:43.809691 [debug] [ThreadPool]: SQL status: BEGIN in 0.317 seconds
[0m19:56:43.810685 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m19:56:43.811374 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:56:43.839940 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.039 seconds
[0m19:56:43.843093 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m19:56:43.848733 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m19:56:43.851088 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m19:56:43.875675 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m19:56:43.884912 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m19:56:43.893335 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:43.893871 [debug] [MainThread]: On master: BEGIN
[0m19:56:43.894204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:56:44.212171 [debug] [MainThread]: SQL status: BEGIN in 0.318 seconds
[0m19:56:44.213742 [debug] [MainThread]: Using postgres connection "master"
[0m19:56:44.215026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:56:44.257198 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m19:56:44.262235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5e0700-01e3-4a68-a534-396a20c18499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128616c90>]}
[0m19:56:44.262823 [debug] [MainThread]: On master: ROLLBACK
[0m19:56:44.295611 [debug] [MainThread]: On master: Close
[0m19:56:44.297133 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:44.297788 [info ] [MainThread]: 
[0m19:56:44.301467 [debug] [Thread-1 (]: Began running node model.ecommerce_project.category_performance
[0m19:56:44.301940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.category_performance)
[0m19:56:44.302241 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.category_performance
[0m19:56:44.312978 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m19:56:44.313886 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.category_performance
[0m19:56:44.320350 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m19:56:44.320744 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
  SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  
  limit 5

[0m19:56:44.321068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:44.623626 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.302 seconds
[0m19:56:44.629474 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: Close
[0m19:56:44.630370 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.category_performance
[0m19:56:44.631388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:44.631581 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m19:56:44.631746 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m19:56:44.632162 [debug] [MainThread]: Command end result
[0m19:56:44.653818 [info ] [MainThread]: Previewing node 'category_performance':
| category    | total_sales | total_revenue | avg_price |
| ----------- | ----------- | ------------- | --------- |
| Home        |        2207 |    380,092.84 |  520.675… |
| Electronics |         804 |    138,958.68 |  514.662… |

[0m19:56:44.655343 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5105312, "process_user_time": 1.038947, "process_kernel_time": 0.147766, "process_mem_max_rss": "122978304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:56:44.655819 [debug] [MainThread]: Command `dbt show` succeeded at 19:56:44.655740 after 1.51 seconds
[0m19:56:44.656132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1285e9860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128927f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1289d9a90>]}
[0m19:56:44.656414 [debug] [MainThread]: Flushing usage events
[0m19:56:44.660946 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:28:31.001313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb3ed0>]}


============================== 20:28:31.005450 | 4bbf1716-0c85-419d-ba94-c3243929b143 ==============================
[0m20:28:31.005450 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:28:31.005939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:28:31.091351 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:28:31.091631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce8510>]}
[0m20:28:31.145559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f7ce0>]}
[0m20:28:31.174250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab3a50>]}
[0m20:28:31.174860 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:28:31.190664 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:28:31.266668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:28:31.267058 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:28:31.390652 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:28:31.397429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c16f30>]}
[0m20:28:31.457265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a31010>]}
[0m20:28:31.457643 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:28:31.457825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109965b20>]}
[0m20:28:31.459028 [info ] [MainThread]: 
[0m20:28:31.459403 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:31.461680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:28:31.507544 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:28:31.507781 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:28:31.507935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:32.142671 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.634 seconds
[0m20:28:32.145575 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:28:32.147978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m20:28:32.152460 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:28:32.152784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:28:32.153003 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:28:32.153980 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:28:32.154215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:32.154407 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:28:32.154665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:32.458591 [debug] [ThreadPool]: SQL status: BEGIN in 0.304 seconds
[0m20:28:32.459637 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:28:32.460177 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:28:32.485041 [debug] [ThreadPool]: SQL status: BEGIN in 0.330 seconds
[0m20:28:32.486304 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:28:32.487009 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:28:32.494454 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m20:28:32.498580 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:28:32.527856 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.040 seconds
[0m20:28:32.530412 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:28:32.530909 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:28:32.580322 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:28:32.590089 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:32.590616 [debug] [MainThread]: On master: BEGIN
[0m20:28:32.590947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:32.902214 [debug] [MainThread]: SQL status: BEGIN in 0.311 seconds
[0m20:28:32.903170 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:32.904068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:32.946981 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m20:28:32.951381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b37d0>]}
[0m20:28:32.952070 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:32.985544 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:32.986269 [debug] [MainThread]: On master: BEGIN
[0m20:28:33.054261 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m20:28:33.055019 [debug] [MainThread]: On master: COMMIT
[0m20:28:33.055414 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:33.055817 [debug] [MainThread]: On master: COMMIT
[0m20:28:33.101578 [debug] [MainThread]: SQL status: COMMIT in 0.045 seconds
[0m20:28:33.102356 [debug] [MainThread]: On master: Close
[0m20:28:33.103496 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:28:33.104343 [info ] [MainThread]: 
[0m20:28:33.107623 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:28:33.107959 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m20:28:33.108190 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_sales
[0m20:28:33.108392 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_products
[0m20:28:33.108875 [info ] [Thread-1 (]: 1 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:28:33.109585 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:28:33.109993 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:28:33.110292 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:28:33.110577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:28:33.110796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:28:33.111094 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:28:33.111410 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m20:28:33.111662 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:28:33.111853 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:28:33.112035 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:28:33.112204 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:28:33.116128 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.118200 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:28:33.119595 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:28:33.121462 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:28:33.122540 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:28:33.122794 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:28:33.122968 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_products
[0m20:28:33.128508 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:28:33.172473 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:28:33.174382 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:28:33.174632 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:28:33.171774 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.175361 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.175622 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.175827 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.176011 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:28:33.176196 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.176437 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:28:33.176648 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:28:33.176830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:28:33.177017 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:28:33.177176 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:33.177335 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:28:33.177590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:33.465443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.288 seconds
[0m20:28:33.465842 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.466098 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(order_date, 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM stg_sales
GROUP BY order_date
  );
  
[0m20:28:33.481772 [debug] [Thread-2 (]: SQL status: BEGIN in 0.305 seconds
[0m20:28:33.482064 [debug] [Thread-4 (]: SQL status: BEGIN in 0.305 seconds
[0m20:28:33.482319 [debug] [Thread-3 (]: SQL status: BEGIN in 0.305 seconds
[0m20:28:33.482538 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.482755 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.482957 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.483266 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:28:33.483552 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:28:33.483830 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:28:33.541461 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.057 seconds
[0m20:28:33.549699 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.083 seconds
[0m20:28:33.551906 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.552169 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.068 seconds
[0m20:28:33.552421 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.068 seconds
[0m20:28:33.554628 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.554920 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:28:33.558358 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.561035 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.561337 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:28:33.561654 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:28:33.561884 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:28:33.590250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:28:33.590530 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:28:33.590728 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:28:33.592762 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.594550 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.596179 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.596418 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:28:33.596649 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:28:33.596881 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:28:33.626203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:28:33.626483 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:28:33.632544 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:28:33.647559 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:28:33.648513 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:28:33.649342 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:28:33.649568 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.649777 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.649990 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.650194 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:28:33.650389 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:28:33.650585 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:28:33.683704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:28:33.688861 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:28:33.689257 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.127 seconds
[0m20:28:33.689494 [debug] [Thread-2 (]: SQL status: COMMIT in 0.039 seconds
[0m20:28:33.692978 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:28:33.693239 [debug] [Thread-3 (]: SQL status: COMMIT in 0.042 seconds
[0m20:28:33.695083 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.696601 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:28:33.696866 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:28:33.698144 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:28:33.698394 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:28:33.700311 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:28:33.700807 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:28:33.701141 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:28:33.701387 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:28:33.731622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:28:33.732696 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:28:33.732969 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.733186 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:28:33.734442 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:28:33.736391 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: Close
[0m20:28:33.736708 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:28:33.737001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:28:33.738010 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: Close
[0m20:28:33.739621 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:28:33.740256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de8890>]}
[0m20:28:33.740834 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.63s]
[0m20:28:33.741334 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:28:33.741738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a907e30>]}
[0m20:28:33.742033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a917ad0>]}
[0m20:28:33.742588 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.63s]
[0m20:28:33.742977 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_products
[0m20:28:33.743376 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.63s]
[0m20:28:33.743781 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:28:33.765290 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m20:28:33.767516 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:28:33.767945 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:28:33.768194 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:28:33.804336 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:28:33.805504 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: Close
[0m20:28:33.806099 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a76350>]}
[0m20:28:33.806603 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.70s]
[0m20:28:33.807047 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:28:33.807737 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:28:33.808084 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:28:33.808397 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:28:33.808758 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:28:33.809127 [info ] [Thread-4 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:28:33.809478 [info ] [Thread-3 (]: 6 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:28:33.809781 [debug] [Thread-2 (]: Began running node model.ecommerce_project.category_performance
[0m20:28:33.810081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_customer)
[0m20:28:33.810418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m20:28:33.810671 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:28:33.811021 [info ] [Thread-2 (]: 5 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:28:33.811373 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:28:33.811629 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:28:33.811877 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:28:33.812171 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.category_performance)
[0m20:28:33.813942 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:28:33.815509 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:28:33.817402 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:28:33.817738 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:28:33.819694 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:28:33.820294 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:28:33.822726 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:28:33.823053 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:28:33.823316 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:28:33.825752 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:28:33.827869 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:28:33.828157 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.category_performance
[0m20:28:33.828632 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:33.830787 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:28:33.831183 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:28:33.831466 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:33.831730 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:33.831981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:28:33.832209 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:28:33.832502 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:28:33.832868 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:33.833070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:28:33.833263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:33.833474 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:28:33.833774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:28:34.121582 [debug] [Thread-4 (]: SQL status: BEGIN in 0.289 seconds
[0m20:28:34.121965 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:34.122255 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:28:34.129416 [debug] [Thread-3 (]: SQL status: BEGIN in 0.296 seconds
[0m20:28:34.129655 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:34.129882 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:28:34.137413 [debug] [Thread-2 (]: SQL status: BEGIN in 0.304 seconds
[0m20:28:34.137662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.304 seconds
[0m20:28:34.137891 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:34.138108 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:34.138383 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:28:34.138689 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:28:34.245282 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.123 seconds
[0m20:28:34.247919 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:34.248214 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:28:34.251743 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.113 seconds
[0m20:28:34.252003 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.122 seconds
[0m20:28:34.254318 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:34.258697 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:34.259169 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:28:34.259444 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.120 seconds
[0m20:28:34.259673 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:28:34.261518 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:34.261928 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:28:34.277927 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:28:34.281083 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:34.281524 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:28:34.294515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:28:34.294876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:28:34.295085 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:28:34.302498 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:34.304963 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:34.307321 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:34.307689 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:28:34.308040 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:28:34.308391 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:28:34.309514 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:28:34.311098 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:28:34.312129 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:34.312493 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:28:34.342069 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:28:34.342489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:28:34.342744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:28:34.343799 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:28:34.387744 [debug] [Thread-4 (]: SQL status: COMMIT in 0.075 seconds
[0m20:28:34.388155 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:28:34.389026 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:28:34.389249 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:34.390385 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:28:34.390597 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:34.390790 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:34.390980 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:28:34.391279 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:28:34.391470 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:28:34.391651 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:28:34.391952 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:28:34.432000 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m20:28:34.432314 [debug] [Thread-2 (]: SQL status: COMMIT in 0.040 seconds
[0m20:28:34.433704 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:28:34.433944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m20:28:34.434139 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.042 seconds
[0m20:28:34.435684 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:28:34.436044 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:28:34.437184 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:28:34.438028 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:28:34.438355 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:28:34.438584 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:28:34.438886 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:28:34.439195 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:28:34.439600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7950>]}
[0m20:28:34.439936 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:28:34.440472 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.63s]
[0m20:28:34.440898 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:28:34.441185 [debug] [Thread-4 (]: Began running node model.ecommerce_project.product_performance
[0m20:28:34.441601 [info ] [Thread-4 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:28:34.441913 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_day, now model.ecommerce_project.product_performance)
[0m20:28:34.442148 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:28:34.443895 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:28:34.444433 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.product_performance
[0m20:28:34.446453 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:28:34.446879 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.447075 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:28:34.447258 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:28:34.480218 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m20:28:34.481354 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:28:34.481596 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.041 seconds
[0m20:28:34.481804 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.042 seconds
[0m20:28:34.482640 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: Close
[0m20:28:34.482926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922ddf0>]}
[0m20:28:34.483708 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:28:34.484084 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.67s]
[0m20:28:34.484344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7590>]}
[0m20:28:34.484885 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:28:34.485141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce7530>]}
[0m20:28:34.485539 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.67s]
[0m20:28:34.485985 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.67s]
[0m20:28:34.486310 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:28:34.486583 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.category_performance
[0m20:28:34.760960 [debug] [Thread-4 (]: SQL status: BEGIN in 0.313 seconds
[0m20:28:34.762146 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.762697 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:28:34.822552 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.059 seconds
[0m20:28:34.827658 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.828279 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:28:34.860925 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:28:34.865798 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.866374 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:28:34.900547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:28:34.904986 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:28:34.905337 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.905577 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:28:34.942688 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m20:28:34.946274 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:28:34.946752 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:28:34.947021 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:28:34.984801 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:28:34.985809 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: Close
[0m20:28:34.986317 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bbf1716-0c85-419d-ba94-c3243929b143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fce30>]}
[0m20:28:34.986727 [info ] [Thread-4 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.54s]
[0m20:28:34.987313 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.product_performance
[0m20:28:34.988365 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:34.988630 [debug] [MainThread]: On master: BEGIN
[0m20:28:34.988842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:35.306387 [debug] [MainThread]: SQL status: BEGIN in 0.317 seconds
[0m20:28:35.307973 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.308955 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:35.309550 [debug] [MainThread]: On master: COMMIT
[0m20:28:35.342444 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m20:28:35.343888 [debug] [MainThread]: On master: Close
[0m20:28:35.345412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:35.345973 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:28:35.346497 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:28:35.346720 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:28:35.346886 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:28:35.347278 [info ] [MainThread]: 
[0m20:28:35.347563 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m20:28:35.349753 [debug] [MainThread]: Command end result
[0m20:28:35.375333 [info ] [MainThread]: 
[0m20:28:35.375724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:35.375972 [info ] [MainThread]: 
[0m20:28:35.376221 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:28:35.377911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4300117, "process_user_time": 1.565287, "process_kernel_time": 0.2897, "process_mem_max_rss": "126844928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:28:35.378392 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:35.378304 after 4.43 seconds
[0m20:28:35.378667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092fe8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922d6d0>]}
[0m20:28:35.378910 [debug] [MainThread]: Flushing usage events
[0m20:28:35.628265 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:29:14.444826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fefed0>]}


============================== 20:29:14.448448 | 513398ea-7c58-497f-9b3a-74a5e714e5c5 ==============================
[0m20:29:14.448448 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:14.448817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:29:14.498296 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:29:14.498626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e8510>]}
[0m20:29:14.547310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf7ce0>]}
[0m20:29:14.575559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db3a50>]}
[0m20:29:14.576266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:29:14.587392 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:29:14.659734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:14.660167 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:29:14.781314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:29:14.787637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052172f0>]}
[0m20:29:14.844226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de5010>]}
[0m20:29:14.844545 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:29:14.844732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d11bf0>]}
[0m20:29:14.846192 [info ] [MainThread]: 
[0m20:29:14.846546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:14.848951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:29:14.880634 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:29:14.880871 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:29:14.881023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:15.307845 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.426 seconds
[0m20:29:15.311457 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:29:15.313932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:29:15.314383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:29:15.318486 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:29:15.319510 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:29:15.319740 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:29:15.319929 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:29:15.320150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:15.320322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:15.623577 [debug] [ThreadPool]: SQL status: BEGIN in 0.303 seconds
[0m20:29:15.625190 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:29:15.625681 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:15.629138 [debug] [ThreadPool]: SQL status: BEGIN in 0.309 seconds
[0m20:29:15.629587 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:29:15.629871 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:29:15.666042 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m20:29:15.669761 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:29:15.670039 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.044 seconds
[0m20:29:15.671579 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:29:15.702241 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:29:15.703363 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:29:15.716362 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:15.716869 [debug] [MainThread]: On master: BEGIN
[0m20:29:15.717211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:16.019329 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m20:29:16.019659 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:16.019921 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:16.067863 [debug] [MainThread]: SQL status: SELECT 3 in 0.047 seconds
[0m20:29:16.072396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d434d0>]}
[0m20:29:16.073228 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:16.106154 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:16.106984 [debug] [MainThread]: On master: BEGIN
[0m20:29:16.170290 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:29:16.171837 [debug] [MainThread]: On master: COMMIT
[0m20:29:16.172728 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:16.173328 [debug] [MainThread]: On master: COMMIT
[0m20:29:16.206099 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m20:29:16.207179 [debug] [MainThread]: On master: Close
[0m20:29:16.208808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:16.209379 [info ] [MainThread]: 
[0m20:29:16.211911 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:29:16.212319 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_products
[0m20:29:16.212614 [debug] [Thread-4 (]: Began running node model.ecommerce_project.stg_sales
[0m20:29:16.212835 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_customers
[0m20:29:16.213188 [info ] [Thread-1 (]: 1 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:29:16.213640 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:29:16.214111 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:29:16.214514 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:29:16.214843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:29:16.215164 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_products'
[0m20:29:16.215643 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:29:16.216038 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m20:29:16.216356 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:29:16.216597 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:29:16.216823 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:29:16.217032 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:29:16.223806 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.227034 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:29:16.229283 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:29:16.231352 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:29:16.232317 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_products
[0m20:29:16.239000 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:29:16.239357 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:29:16.272945 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.276315 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:29:16.276642 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:29:16.278510 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:29:16.280620 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:29:16.281149 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.281370 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:29:16.281548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:16.281847 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.282119 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:29:16.282339 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.282543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:16.282752 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:29:16.283041 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.283221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:29:16.283390 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:29:16.283619 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:29:16.569581 [debug] [Thread-4 (]: SQL status: BEGIN in 0.286 seconds
[0m20:29:16.570118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.289 seconds
[0m20:29:16.570381 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.570628 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.571048 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:29:16.571609 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(order_date, 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM stg_sales
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:29:16.602196 [debug] [Thread-3 (]: SQL status: BEGIN in 0.319 seconds
[0m20:29:16.602509 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.602783 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:29:16.605009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.322 seconds
[0m20:29:16.605328 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.605686 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:29:16.628522 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.056 seconds
[0m20:29:16.637596 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.065 seconds
[0m20:29:16.639575 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.642901 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.643382 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:29:16.643818 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:29:16.645599 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m20:29:16.649397 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.649772 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:29:16.653857 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m20:29:16.656285 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.656724 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:29:16.676455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:29:16.679085 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.679539 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:29:16.682108 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:29:16.682368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:29:16.685260 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.687206 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.687521 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:29:16.687780 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:29:16.713477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:29:16.728232 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:29:16.728509 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:29:16.730375 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:29:16.731570 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:29:16.732709 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:29:16.733020 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.733314 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.733585 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.733833 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:29:16.734076 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:29:16.734308 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:29:16.767419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:29:16.767740 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m20:29:16.772980 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:29:16.774709 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:29:16.775007 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m20:29:16.779288 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:16.779577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.135 seconds
[0m20:29:16.781507 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:29:16.783200 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:29:16.783498 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:29:16.785430 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.785717 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:29:16.786224 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:29:16.786569 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:29:16.786895 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:29:16.817467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:29:16.818466 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:29:16.818696 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.818905 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:29:16.822009 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:29:16.822244 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:29:16.823792 [debug] [Thread-3 (]: On model.ecommerce_project.stg_products: Close
[0m20:29:16.824024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:29:16.825332 [debug] [Thread-2 (]: On model.ecommerce_project.stg_customers: Close
[0m20:29:16.826339 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:29:16.827620 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e4310>]}
[0m20:29:16.827954 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c07f70>]}
[0m20:29:16.828252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d094f0>]}
[0m20:29:16.828638 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.61s]
[0m20:29:16.829025 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.61s]
[0m20:29:16.829555 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.61s]
[0m20:29:16.830080 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_products
[0m20:29:16.830483 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:29:16.830857 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:29:16.854455 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m20:29:16.856287 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:29:16.856679 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:29:16.856894 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:29:16.887729 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.031 seconds
[0m20:29:16.888837 [debug] [Thread-4 (]: On model.ecommerce_project.stg_sales: Close
[0m20:29:16.889291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2aac0>]}
[0m20:29:16.889662 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.67s]
[0m20:29:16.890052 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:29:16.890615 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:29:16.890942 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m20:29:16.891242 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:29:16.891642 [info ] [Thread-2 (]: 6 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:29:16.891982 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:29:16.892276 [info ] [Thread-3 (]: 5 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:29:16.892670 [info ] [Thread-4 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:29:16.893015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m20:29:16.893340 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:29:16.893633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.category_performance)
[0m20:29:16.893891 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_day)
[0m20:29:16.894145 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:29:16.894393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_customer)
[0m20:29:16.894643 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:29:16.894882 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:29:16.897408 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:29:16.897704 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:29:16.899723 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:29:16.901465 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:29:16.903307 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:29:16.904044 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:29:16.904380 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:29:16.904605 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m20:29:16.906997 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:29:16.907294 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:29:16.909304 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:29:16.911679 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:29:16.913595 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:29:16.914046 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:16.914436 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:29:16.914693 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:29:16.915031 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:16.915342 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:16.915712 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:29:16.915983 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:16.916196 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:29:16.916410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:29:16.916674 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:29:16.916947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:16.917259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:17.220977 [debug] [Thread-3 (]: SQL status: BEGIN in 0.304 seconds
[0m20:29:17.221345 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:17.221687 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:29:17.229120 [debug] [Thread-2 (]: SQL status: BEGIN in 0.312 seconds
[0m20:29:17.229384 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:17.230269 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:29:17.248478 [debug] [Thread-4 (]: SQL status: BEGIN in 0.333 seconds
[0m20:29:17.250992 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:17.251682 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:29:17.256293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.339 seconds
[0m20:29:17.256887 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:17.257381 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:29:17.299862 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.069 seconds
[0m20:29:17.305496 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:17.306085 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.084 seconds
[0m20:29:17.306355 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:29:17.308456 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:17.308850 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:29:17.320051 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.067 seconds
[0m20:29:17.324283 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:17.324634 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:29:17.332146 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.074 seconds
[0m20:29:17.336531 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:17.337114 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:29:17.337597 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:29:17.337906 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:29:17.341105 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:17.343111 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:17.343411 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:29:17.343666 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:29:17.359740 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:29:17.365098 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:17.365367 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:29:17.368350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:29:17.370009 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:17.370262 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:29:17.373071 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:29:17.374008 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:29:17.374238 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:29:17.374450 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:17.375292 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:29:17.375511 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:29:17.375735 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:17.375974 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:29:17.400036 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:29:17.402107 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:29:17.402517 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:17.402889 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:29:17.409211 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:29:17.409502 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m20:29:17.452014 [debug] [Thread-4 (]: SQL status: COMMIT in 0.049 seconds
[0m20:29:17.452308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.082 seconds
[0m20:29:17.452756 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:29:17.454200 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:29:17.455396 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:29:17.456311 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:29:17.456819 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:29:17.457242 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:29:17.457617 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:29:17.457837 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:17.458118 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:29:17.458383 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:29:17.458616 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:29:17.458860 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:29:17.494721 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:29:17.495817 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:29:17.496051 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:29:17.496382 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m20:29:17.497220 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m20:29:17.497502 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e3410>]}
[0m20:29:17.498802 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:29:17.499083 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.040 seconds
[0m20:29:17.499368 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105703ad0>]}
[0m20:29:17.499751 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.60s]
[0m20:29:17.500160 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:29:17.501187 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:29:17.501610 [info ] [Thread-3 (]: 5 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.61s]
[0m20:29:17.501987 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:29:17.502231 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:29:17.502634 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m20:29:17.502928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f9130>]}
[0m20:29:17.503199 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m20:29:17.503707 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.61s]
[0m20:29:17.504075 [info ] [Thread-2 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:29:17.504458 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:29:17.504735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:29:17.505018 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:29:17.506736 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:29:17.507284 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m20:29:17.509514 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:29:17.510019 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.510223 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:29:17.510405 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:17.552879 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.049 seconds
[0m20:29:17.553849 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:29:17.554289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e28d0>]}
[0m20:29:17.554640 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.66s]
[0m20:29:17.555120 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:29:17.798058 [debug] [Thread-2 (]: SQL status: BEGIN in 0.287 seconds
[0m20:29:17.799065 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.799589 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:29:17.861435 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.061 seconds
[0m20:29:17.866513 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.867118 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:29:17.897700 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:29:17.902150 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.902678 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:29:17.941574 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:29:17.944170 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:29:17.944724 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.945193 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:29:17.979552 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m20:29:17.984510 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:29:17.985130 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:29:17.985444 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:29:18.021935 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:29:18.030070 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m20:29:18.031588 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '513398ea-7c58-497f-9b3a-74a5e714e5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105614170>]}
[0m20:29:18.032436 [info ] [Thread-2 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.53s]
[0m20:29:18.032891 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m20:29:18.033790 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:18.034034 [debug] [MainThread]: On master: BEGIN
[0m20:29:18.034192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:18.338109 [debug] [MainThread]: SQL status: BEGIN in 0.304 seconds
[0m20:29:18.339318 [debug] [MainThread]: On master: COMMIT
[0m20:29:18.339816 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:18.340280 [debug] [MainThread]: On master: COMMIT
[0m20:29:18.373341 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m20:29:18.374557 [debug] [MainThread]: On master: Close
[0m20:29:18.376237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:18.376778 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:29:18.377198 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:29:18.377845 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:29:18.378255 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:29:18.378596 [info ] [MainThread]: 
[0m20:29:18.379032 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m20:29:18.380218 [debug] [MainThread]: Command end result
[0m20:29:18.407631 [info ] [MainThread]: 
[0m20:29:18.408011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:18.408253 [info ] [MainThread]: 
[0m20:29:18.408497 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:29:18.409940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.007783, "process_user_time": 1.558169, "process_kernel_time": 0.219557, "process_mem_max_rss": "125304832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:18.410388 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:18.410309 after 4.01 seconds
[0m20:29:18.410692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037814f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c5d310>]}
[0m20:29:18.410972 [debug] [MainThread]: Flushing usage events
[0m20:29:18.447801 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:29:37.113916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d296a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465bed0>]}


============================== 20:29:37.117553 | f21b5f99-1f14-421a-99c4-04c60f07eca5 ==============================
[0m20:29:37.117553 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:37.117943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:37.158657 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:29:37.158972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104790510>]}
[0m20:29:37.208006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104363ce0>]}
[0m20:29:37.236568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441fa50>]}
[0m20:29:37.237187 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:29:37.248205 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:29:37.320396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:37.320684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:37.323895 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:29:37.345281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d49a90>]}
[0m20:29:37.403245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104748210>]}
[0m20:29:37.403526 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:29:37.403695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f6b60>]}
[0m20:29:37.404573 [info ] [MainThread]: 
[0m20:29:37.404866 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:37.407014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:29:37.413231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:29:37.440126 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:29:37.440361 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:29:37.440577 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:29:37.440797 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:29:37.440964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:37.441117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:37.953371 [debug] [ThreadPool]: SQL status: BEGIN in 0.512 seconds
[0m20:29:37.953822 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:29:37.954108 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:29:37.967011 [debug] [ThreadPool]: SQL status: BEGIN in 0.526 seconds
[0m20:29:37.967452 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:29:37.967783 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:37.993323 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.039 seconds
[0m20:29:37.994889 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:29:38.002610 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.034 seconds
[0m20:29:38.003930 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:29:38.029742 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:29:38.039482 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:29:38.044378 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:38.044634 [debug] [MainThread]: On master: BEGIN
[0m20:29:38.044778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:38.349184 [debug] [MainThread]: SQL status: BEGIN in 0.297 seconds
[0m20:29:38.350742 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:38.351392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:38.395445 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m20:29:38.397231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21b5f99-1f14-421a-99c4-04c60f07eca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105362c90>]}
[0m20:29:38.397633 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:38.437493 [debug] [MainThread]: On master: Close
[0m20:29:38.438690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:38.439178 [info ] [MainThread]: 
[0m20:29:38.441752 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:29:38.442169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:29:38.442424 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:29:38.451653 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:38.452435 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:29:38.459132 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:29:38.459579 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(order_date, 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM stg_sales
GROUP BY order_date
ORDER BY order_date DESC
  
  limit 5

[0m20:29:38.459896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:38.760760 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.301 seconds
[0m20:29:38.763768 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:29:38.765085 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:29:38.766238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:38.766664 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:29:38.766984 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m20:29:38.767633 [debug] [MainThread]: Command end result
[0m20:29:38.792196 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-10    |          476 |
| 2024-10    |         1844 |
| 2024-10    |         1645 |
| 2024-10    |         2610 |
| 2024-10    |         2834 |

[0m20:29:38.793703 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.7216047, "process_user_time": 1.069801, "process_kernel_time": 0.179562, "process_mem_max_rss": "122191872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:29:38.794219 [debug] [MainThread]: Command `dbt show` succeeded at 20:29:38.794127 after 1.72 seconds
[0m20:29:38.794517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534d860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669a90>]}
[0m20:29:38.794980 [debug] [MainThread]: Flushing usage events
[0m20:29:38.917625 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:30:29.201826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064efed0>]}


============================== 20:30:29.204565 | a60cab4e-6acf-40fd-8d23-17d96dddfbe6 ==============================
[0m20:30:29.204565 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:30:29.204904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:30:29.240962 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:30:29.241256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106624510>]}
[0m20:30:29.290834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f7ce0>]}
[0m20:30:29.319101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3a50>]}
[0m20:30:29.319637 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:30:29.329055 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:30:29.391936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:30:29.392373 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:30:29.515219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:30:29.521893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553020>]}
[0m20:30:29.572876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107635010>]}
[0m20:30:29.573163 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:30:29.573337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a1bf0>]}
[0m20:30:29.574458 [info ] [MainThread]: 
[0m20:30:29.574762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:29.577214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:30:29.606262 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:30:29.606488 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:30:29.606638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:30.014517 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.407 seconds
[0m20:30:30.018729 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:30:30.020258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:30:30.020624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:30:30.024160 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:30:30.025111 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:30:30.025307 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:30:30.025465 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:30:30.025618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:30.025756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:30.289865 [debug] [ThreadPool]: SQL status: BEGIN in 0.264 seconds
[0m20:30:30.291442 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:30:30.291937 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:30:30.306452 [debug] [ThreadPool]: SQL status: BEGIN in 0.281 seconds
[0m20:30:30.307474 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:30:30.308013 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:30:30.324160 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.032 seconds
[0m20:30:30.327353 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:30:30.341229 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m20:30:30.343859 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:30:30.356666 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:30:30.373345 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:30:30.383129 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:30.383429 [debug] [MainThread]: On master: BEGIN
[0m20:30:30.383611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:30.672962 [debug] [MainThread]: SQL status: BEGIN in 0.281 seconds
[0m20:30:30.674030 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:30.674699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:30.710715 [debug] [MainThread]: SQL status: SELECT 3 in 0.035 seconds
[0m20:30:30.715259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dfad0>]}
[0m20:30:30.715754 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:30.745050 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:30.746202 [debug] [MainThread]: On master: BEGIN
[0m20:30:30.802698 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m20:30:30.803528 [debug] [MainThread]: On master: COMMIT
[0m20:30:30.804059 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:30.804702 [debug] [MainThread]: On master: COMMIT
[0m20:30:30.833828 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m20:30:30.834946 [debug] [MainThread]: On master: Close
[0m20:30:30.837378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:30.838505 [info ] [MainThread]: 
[0m20:30:30.842285 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:30:30.843009 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:30:30.843303 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:30:30.843676 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:30:30.844012 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:30:30.844379 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:30:30.844718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:30:30.845344 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:30:30.845969 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:30:30.846481 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:30:30.846787 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:30:30.847125 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:30:30.853217 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:30:30.855065 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:30:30.856676 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:30:30.857722 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:30:30.858098 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:30:30.858428 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:30:30.891800 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:30:30.893999 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:30:30.894562 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:30:30.895259 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:30.895518 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:30.895797 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:30:30.896040 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:30.896246 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:30:30.896441 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:30:30.896641 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:30:30.896818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:30.897082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:31.157516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.261 seconds
[0m20:30:31.157883 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:31.158129 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:30:31.164661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.268 seconds
[0m20:30:31.164894 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:31.165585 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:30:31.193176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.296 seconds
[0m20:30:31.194689 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:31.195323 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:30:31.203136 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:30:31.212214 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:31.212556 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:30:31.212825 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m20:30:31.216483 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:31.217021 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:30:31.237821 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:30:31.240062 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:31.240553 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:30:31.240822 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:30:31.243392 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:31.243901 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:30:31.244530 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:30:31.246266 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:31.246504 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:30:31.273291 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:30:31.281722 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:30:31.282211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:30:31.298666 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:30:31.301615 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:30:31.303689 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:31.303980 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:31.304234 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:31.304491 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:30:31.304745 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:30:31.304979 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:30:31.333492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:30:31.334479 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:30:31.334712 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:31.334978 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:30:31.335697 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m20:30:31.340744 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:30:31.341137 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m20:30:31.345252 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:30:31.346973 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:30:31.347305 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:30:31.347708 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:30:31.348025 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:30:31.361270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m20:30:31.362711 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:30:31.363105 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:30:31.363347 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:30:31.379793 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:30:31.380070 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:30:31.381984 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:30:31.383109 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:30:31.384401 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e4730>]}
[0m20:30:31.384780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c83a70>]}
[0m20:30:31.385197 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.54s]
[0m20:30:31.385620 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.54s]
[0m20:30:31.386129 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:30:31.386532 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:30:31.387095 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:30:31.387370 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:30:31.387650 [info ] [Thread-2 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:30:31.387912 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:30:31.388513 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:30:31.388221 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:30:31.388963 [info ] [Thread-3 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:30:31.389233 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:30:31.389538 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:30:31.389782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:30:31.391902 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.392183 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:30:31.392417 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:30:31.394410 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:30:31.395948 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.396445 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:30:31.408746 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.045 seconds
[0m20:30:31.409047 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:30:31.409291 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:30:31.413478 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.414504 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:30:31.416525 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.418529 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:30:31.419195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc32d0>]}
[0m20:30:31.419541 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.420089 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.420389 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:30:31.419894 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.57s]
[0m20:30:31.420679 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:30:31.420868 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.421060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:30:31.421367 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:30:31.421549 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:30:31.421731 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:30:31.422030 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:30:31.422515 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:30:31.422802 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:30:31.423154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m20:30:31.423363 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:30:31.424871 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:30:31.425336 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:30:31.427237 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:30:31.427805 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.428094 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:30:31.428283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:31.705706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m20:30:31.706146 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.706440 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:30:31.713379 [debug] [Thread-3 (]: SQL status: BEGIN in 0.292 seconds
[0m20:30:31.713664 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.713879 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(order_date, 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:30:31.723949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.303 seconds
[0m20:30:31.724226 [debug] [Thread-4 (]: SQL status: BEGIN in 0.302 seconds
[0m20:30:31.724435 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.724640 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.724865 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:30:31.725301 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:30:31.792594 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.078 seconds
[0m20:30:31.794072 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.087 seconds
[0m20:30:31.798714 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.799027 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.073 seconds
[0m20:30:31.799240 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.073 seconds
[0m20:30:31.801133 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.801394 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:30:31.803359 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.805124 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.805422 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:30:31.805754 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:30:31.806037 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:30:31.834136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:30:31.834819 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:30:31.836590 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.840489 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.840964 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:30:31.841273 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:30:31.843454 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:30:31.843702 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:30:31.845672 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.847924 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.848323 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:30:31.848679 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:30:31.869059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:30:31.869359 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:30:31.874005 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:30:31.875490 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:30:31.875874 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.876223 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:30:31.876504 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:30:31.876757 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.877063 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:30:31.878431 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:30:31.880221 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:30:31.880530 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:30:31.880855 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.881096 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.881341 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:30:31.881568 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:30:31.915584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m20:30:31.917074 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:30:31.919021 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:30:31.919255 [debug] [Thread-2 (]: SQL status: COMMIT in 0.037 seconds
[0m20:30:31.919468 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:30:31.921408 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:30:31.921741 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m20:30:31.922146 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:30:31.926948 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:30:31.927292 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:30:31.927580 [debug] [Thread-4 (]: SQL status: COMMIT in 0.046 seconds
[0m20:30:31.928004 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:31.929468 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:30:31.929799 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:30:31.930148 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:30:31.930516 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:30:31.952487 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m20:30:31.953528 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:30:31.954026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d39550>]}
[0m20:30:31.954544 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.53s]
[0m20:30:31.955066 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:30:31.955409 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:30:31.955817 [info ] [Thread-1 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:30:31.956180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.orders_by_day)
[0m20:30:31.956421 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:30:31.958351 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:30:31.958972 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:30:32.003767 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.073 seconds
[0m20:30:32.005356 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:30:32.005592 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.075 seconds
[0m20:30:32.006374 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:30:32.006563 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.078 seconds
[0m20:30:32.007503 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:30:32.008393 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:30:32.008678 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e3830>]}
[0m20:30:32.008937 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.009177 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e1fd0>]}
[0m20:30:32.009406 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070da810>]}
[0m20:30:32.009744 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.62s]
[0m20:30:32.009963 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:30:32.010247 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.62s]
[0m20:30:32.011123 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:30:32.010700 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.62s]
[0m20:30:32.011436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:32.011792 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:30:32.012047 [debug] [Thread-4 (]: Began running node model.ecommerce_project.product_performance
[0m20:30:32.012437 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:30:32.012893 [info ] [Thread-4 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:30:32.013236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.product_performance)
[0m20:30:32.013427 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:30:32.014839 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:30:32.015294 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.product_performance
[0m20:30:32.017509 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:30:32.018001 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.018177 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:30:32.018335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:30:32.290561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.279 seconds
[0m20:30:32.291204 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.291647 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:30:32.317840 [debug] [Thread-4 (]: SQL status: BEGIN in 0.299 seconds
[0m20:30:32.319384 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.320083 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:30:32.343806 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.052 seconds
[0m20:30:32.347452 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.348123 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:30:32.377930 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.057 seconds
[0m20:30:32.379948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:30:32.383674 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.385907 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.386183 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:30:32.386588 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:30:32.418857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:30:32.419821 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:30:32.422635 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:30:32.424914 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.425203 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.425430 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:30:32.425650 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:30:32.452703 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:30:32.453980 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:30:32.454252 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.454724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m20:30:32.454999 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:30:32.456424 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:30:32.456829 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:30:32.457068 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:30:32.486285 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m20:30:32.491456 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:30:32.491999 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:30:32.492505 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:30:32.493788 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:30:32.494099 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:30:32.494708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107188650>]}
[0m20:30:32.495167 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.54s]
[0m20:30:32.495543 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:30:32.529220 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:30:32.530584 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: Close
[0m20:30:32.531175 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cab4e-6acf-40fd-8d23-17d96dddfbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065045f0>]}
[0m20:30:32.531613 [info ] [Thread-4 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.52s]
[0m20:30:32.531997 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.product_performance
[0m20:30:32.533184 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:32.533596 [debug] [MainThread]: On master: BEGIN
[0m20:30:32.533912 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:32.837982 [debug] [MainThread]: SQL status: BEGIN in 0.304 seconds
[0m20:30:32.839563 [debug] [MainThread]: On master: COMMIT
[0m20:30:32.840293 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:32.840795 [debug] [MainThread]: On master: COMMIT
[0m20:30:32.869863 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m20:30:32.870860 [debug] [MainThread]: On master: Close
[0m20:30:32.872077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:32.872539 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:30:32.872957 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:30:32.873336 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:30:32.873732 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:30:32.874491 [info ] [MainThread]: 
[0m20:30:32.875022 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m20:30:32.876237 [debug] [MainThread]: Command end result
[0m20:30:32.900471 [info ] [MainThread]: 
[0m20:30:32.900871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:32.901112 [info ] [MainThread]: 
[0m20:30:32.901359 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:30:32.902623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7420106, "process_user_time": 1.538569, "process_kernel_time": 0.188119, "process_mem_max_rss": "127909888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:32.903144 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:32.903048 after 3.74 seconds
[0m20:30:32.903419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9fd70>]}
[0m20:30:32.903658 [debug] [MainThread]: Flushing usage events
[0m20:30:32.939069 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:30:37.296377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10316d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058efed0>]}


============================== 20:30:37.299019 | 25ea6cce-218c-4334-bfdc-e925dac08313 ==============================
[0m20:30:37.299019 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:30:37.299376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'send_anonymous_usage_stats': 'True'}
[0m20:30:37.335585 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:30:37.335879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be8510>]}
[0m20:30:37.386523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f7ce0>]}
[0m20:30:37.415164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b3a50>]}
[0m20:30:37.415670 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:30:37.425487 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:30:37.490445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:37.490713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:37.494003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:30:37.515307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe1a90>]}
[0m20:30:37.569958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba0210>]}
[0m20:30:37.570263 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:30:37.570444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106106f70>]}
[0m20:30:37.571407 [info ] [MainThread]: 
[0m20:30:37.571738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:37.574460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:30:37.581124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:30:37.607994 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:30:37.608293 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:30:37.608472 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:30:37.608632 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:30:37.608782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:37.608914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:37.877541 [debug] [ThreadPool]: SQL status: BEGIN in 0.268 seconds
[0m20:30:37.877951 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:30:37.878178 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:30:37.884639 [debug] [ThreadPool]: SQL status: BEGIN in 0.276 seconds
[0m20:30:37.884891 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:30:37.885224 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:30:37.912654 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.034 seconds
[0m20:30:37.915835 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:30:37.923810 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m20:30:37.930980 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:30:37.944635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:30:37.959521 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:30:37.968108 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:37.968426 [debug] [MainThread]: On master: BEGIN
[0m20:30:37.968614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:38.237819 [debug] [MainThread]: SQL status: BEGIN in 0.269 seconds
[0m20:30:38.238580 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:38.239253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:38.279459 [debug] [MainThread]: SQL status: SELECT 3 in 0.039 seconds
[0m20:30:38.284170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ea6cce-218c-4334-bfdc-e925dac08313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680ec90>]}
[0m20:30:38.284578 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:38.313084 [debug] [MainThread]: On master: Close
[0m20:30:38.315391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:30:38.317302 [info ] [MainThread]: 
[0m20:30:38.320673 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:30:38.321071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:30:38.321322 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:30:38.327681 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:38.328448 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:30:38.333938 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:30:38.334456 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(order_date, 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  
  limit 5

[0m20:30:38.334831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:38.605631 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.270 seconds
[0m20:30:38.609756 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:30:38.610752 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:30:38.611906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:38.612136 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:30:38.612321 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m20:30:38.612743 [debug] [MainThread]: Command end result
[0m20:30:38.638879 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-10    |          476 |
| 2024-10    |         1844 |
| 2024-10    |         1645 |
| 2024-10    |         2610 |
| 2024-10    |         2834 |

[0m20:30:38.640328 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.3844093, "process_user_time": 1.037338, "process_kernel_time": 0.145798, "process_mem_max_rss": "122011648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:30:38.640796 [debug] [MainThread]: Command `dbt show` succeeded at 20:30:38.640719 after 1.38 seconds
[0m20:30:38.641118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106145860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5e50>]}
[0m20:30:38.641393 [debug] [MainThread]: Flushing usage events
[0m20:30:38.646051 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:32:02.372837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102db96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ebc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ebed0>]}


============================== 20:32:02.376405 | 9fa61579-2bb5-485f-85ac-f0487ca37dd0 ==============================
[0m20:32:02.376405 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:32:02.376809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:32:02.427173 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:32:02.427503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104824510>]}
[0m20:32:02.482518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f3ce0>]}
[0m20:32:02.511532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044afa50>]}
[0m20:32:02.512199 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:32:02.525347 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:32:02.599105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:32:02.599607 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:32:02.722624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:32:02.728882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474f020>]}
[0m20:32:02.784895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055190f0>]}
[0m20:32:02.785220 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:32:02.785416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105445710>]}
[0m20:32:02.786749 [info ] [MainThread]: 
[0m20:32:02.787118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:32:02.789483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:32:02.822009 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:32:02.822283 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:32:02.822525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:03.287501 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.465 seconds
[0m20:32:03.291520 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:32:03.293359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:32:03.293783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:32:03.300651 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:32:03.301646 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:32:03.301880 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:32:03.302057 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:32:03.302225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:03.302653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:03.601633 [debug] [ThreadPool]: SQL status: BEGIN in 0.298 seconds
[0m20:32:03.603082 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:32:03.603560 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:32:03.607938 [debug] [ThreadPool]: SQL status: BEGIN in 0.305 seconds
[0m20:32:03.608537 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:32:03.608990 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:32:03.636884 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.033 seconds
[0m20:32:03.640488 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:32:03.642993 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m20:32:03.645538 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:32:03.668775 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:32:03.675209 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:32:03.683963 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:03.684265 [debug] [MainThread]: On master: BEGIN
[0m20:32:03.684444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:03.983533 [debug] [MainThread]: SQL status: BEGIN in 0.299 seconds
[0m20:32:03.984245 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:03.984851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:32:04.029544 [debug] [MainThread]: SQL status: SELECT 3 in 0.044 seconds
[0m20:32:04.033155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105483ad0>]}
[0m20:32:04.033439 [debug] [MainThread]: On master: ROLLBACK
[0m20:32:04.062811 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:04.063552 [debug] [MainThread]: On master: BEGIN
[0m20:32:04.119562 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m20:32:04.120230 [debug] [MainThread]: On master: COMMIT
[0m20:32:04.120624 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:04.121055 [debug] [MainThread]: On master: COMMIT
[0m20:32:04.159473 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m20:32:04.160095 [debug] [MainThread]: On master: Close
[0m20:32:04.161839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:32:04.162575 [info ] [MainThread]: 
[0m20:32:04.166760 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:32:04.167312 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:32:04.167995 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:32:04.168772 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:32:04.169525 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:32:04.170130 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:32:04.170664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:32:04.171199 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:32:04.171601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:32:04.172057 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:32:04.172381 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:32:04.172921 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:32:04.180546 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:32:04.183285 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:32:04.185245 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:32:04.186325 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:32:04.186640 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:32:04.186885 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:32:04.221238 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:32:04.221768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:32:04.225682 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:32:04.226371 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.226639 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.226896 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.227112 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:32:04.227312 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:32:04.227517 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:32:04.227729 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:32:04.227929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:04.228109 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:32:04.536851 [debug] [Thread-3 (]: SQL status: BEGIN in 0.309 seconds
[0m20:32:04.537335 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.537609 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:32:04.546554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m20:32:04.546837 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.547073 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:32:04.555087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.327 seconds
[0m20:32:04.556496 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.557171 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:32:04.586192 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m20:32:04.594871 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.595186 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m20:32:04.595437 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:32:04.597847 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.598135 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:32:04.603122 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:32:04.605078 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.605322 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:32:04.629561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:32:04.633922 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.634468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:32:04.634792 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:32:04.637008 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.637426 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:32:04.640332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:32:04.643137 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.643731 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:32:04.669769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:32:04.677820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:32:04.684884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m20:32:04.691777 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:32:04.691464 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:32:04.693080 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:32:04.693362 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.693575 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.693771 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.693968 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:32:04.694156 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:32:04.694366 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:32:04.727356 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:32:04.732408 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:32:04.732833 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m20:32:04.733085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m20:32:04.736441 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:32:04.737815 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:32:04.738988 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:32:04.739227 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:32:04.739545 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:32:04.739840 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:32:04.740104 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:32:04.740382 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:32:04.772890 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:32:04.774800 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:32:04.776341 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c8890>]}
[0m20:32:04.776652 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:32:04.776864 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:32:04.777240 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.60s]
[0m20:32:04.778492 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:32:04.779825 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:32:04.780369 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:32:04.781017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e76b0>]}
[0m20:32:04.781328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105913020>]}
[0m20:32:04.781710 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.61s]
[0m20:32:04.781994 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:32:04.782225 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:32:04.783062 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:32:04.782721 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.61s]
[0m20:32:04.783618 [info ] [Thread-3 (]: 5 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:32:04.784323 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:32:04.784002 [info ] [Thread-4 (]: 4 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:32:04.784754 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:32:04.785043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:32:04.785368 [info ] [Thread-2 (]: 6 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:32:04.785679 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m20:32:04.785962 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:32:04.786204 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:32:04.786441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m20:32:04.786647 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:32:04.789386 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:32:04.786937 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:32:04.789842 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:32:04.791710 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:32:04.792135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_day)
[0m20:32:04.793908 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:32:04.794326 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:32:04.794687 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:32:04.796720 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:32:04.797074 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:32:04.809321 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:32:04.812925 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:32:04.815160 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:32:04.817205 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:32:04.817582 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:32:04.819815 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:32:04.820142 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:32:04.820749 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:04.821003 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:32:04.821229 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:04.821452 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:32:04.821645 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:32:04.821840 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:04.822027 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:32:04.822226 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:32:04.822514 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:32:04.822703 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:32:04.822952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:05.096189 [debug] [Thread-4 (]: SQL status: BEGIN in 0.273 seconds
[0m20:32:05.096589 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:05.097046 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:32:05.116118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.293 seconds
[0m20:32:05.116364 [debug] [Thread-3 (]: SQL status: BEGIN in 0.295 seconds
[0m20:32:05.116606 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:05.116802 [debug] [Thread-2 (]: SQL status: BEGIN in 0.295 seconds
[0m20:32:05.117006 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:32:05.117217 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:32:05.117428 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:05.117638 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(TRUNC(order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:32:05.117904 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:32:05.180466 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.083 seconds
[0m20:32:05.187987 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:05.188336 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function trunc(date) does not exist
LINE 13:     TO_CHAR(TRUNC(order_date), 'YYYY-MM') as order_date,
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:32:05.188637 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:32:05.188875 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.071 seconds
[0m20:32:05.189112 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:32:05.190940 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:05.191332 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:32:05.196560 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.078 seconds
[0m20:32:05.199319 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:05.200001 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:32:05.226229 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:32:05.232510 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:05.232804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m20:32:05.233127 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:32:05.233380 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:32:05.233591 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:32:05.237308 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:05.239822 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:05.240882 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:32:05.241118 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:32:05.248559 [debug] [Thread-3 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  function trunc(date) does not exist
  LINE 13:     TO_CHAR(TRUNC(order_date), 'YYYY-MM') as order_date,
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:32:05.249088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5d010>]}
[0m20:32:05.249702 [error] [Thread-3 (]: 5 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.46s]
[0m20:32:05.250254 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:32:05.250613 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m20:32:05.251518 [info ] [Thread-3 (]: 8 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:32:05.251922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m20:32:05.252153 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:32:05.253761 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:32:05.254309 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m20:32:05.256767 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:32:05.257457 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.257713 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:32:05.257951 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:32:05.268939 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:32:05.273331 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:32:05.273713 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:05.273960 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:32:05.276307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:32:05.277370 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:32:05.277619 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:32:05.277831 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:05.278763 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:32:05.279106 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:32:05.279353 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:05.279667 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:32:05.310500 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m20:32:05.312030 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:32:05.312312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:32:05.314604 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:32:05.314862 [debug] [Thread-4 (]: SQL status: COMMIT in 0.041 seconds
[0m20:32:05.316119 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:32:05.316359 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:32:05.320523 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:32:05.320890 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:32:05.321333 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:32:05.321650 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:32:05.321997 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:32:05.358640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:32:05.359726 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:32:05.359995 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:32:05.360852 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:32:05.361170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cc3b0>]}
[0m20:32:05.361581 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.57s]
[0m20:32:05.362096 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:32:05.362390 [debug] [Thread-1 (]: Began running node model.ecommerce_project.category_performance
[0m20:32:05.362673 [info ] [Thread-1 (]: 9 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:32:05.362966 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cf7d0>]}
[0m20:32:05.363236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_day, now model.ecommerce_project.category_performance)
[0m20:32:05.363450 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m20:32:05.363725 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:32:05.364134 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.58s]
[0m20:32:05.365153 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:32:05.366881 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:32:05.367228 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:32:05.367774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cf830>]}
[0m20:32:05.368205 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.58s]
[0m20:32:05.368564 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:32:05.368970 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.category_performance
[0m20:32:05.370982 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:32:05.371527 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.371748 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:32:05.371945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:05.544522 [debug] [Thread-3 (]: SQL status: BEGIN in 0.286 seconds
[0m20:32:05.545022 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.545313 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:32:05.603432 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.058 seconds
[0m20:32:05.646787 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.647165 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:32:05.665094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.293 seconds
[0m20:32:05.665407 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.665699 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:32:05.676890 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:32:05.678900 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.679253 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:32:05.708804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:32:05.709829 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:32:05.710070 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.710298 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:32:05.725865 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.060 seconds
[0m20:32:05.728129 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.728407 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:32:05.746540 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m20:32:05.747817 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:32:05.748166 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:32:05.748391 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:32:05.757375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:32:05.759081 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.759559 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:32:05.780651 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.032 seconds
[0m20:32:05.782055 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m20:32:05.782714 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df65d0>]}
[0m20:32:05.783322 [info ] [Thread-3 (]: 8 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.53s]
[0m20:32:05.783881 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m20:32:05.797716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:32:05.798841 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:32:05.799090 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.799354 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:32:05.830351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m20:32:05.832483 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:32:05.832893 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:32:05.833141 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:32:05.872500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m20:32:05.873593 [debug] [Thread-1 (]: On model.ecommerce_project.category_performance: Close
[0m20:32:05.874146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa61579-2bb5-485f-85ac-f0487ca37dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105360350>]}
[0m20:32:05.874581 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.51s]
[0m20:32:05.874961 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.category_performance
[0m20:32:05.876251 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:05.876514 [debug] [MainThread]: On master: BEGIN
[0m20:32:05.876689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:32:06.160179 [debug] [MainThread]: SQL status: BEGIN in 0.283 seconds
[0m20:32:06.161045 [debug] [MainThread]: On master: COMMIT
[0m20:32:06.161453 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:06.161917 [debug] [MainThread]: On master: COMMIT
[0m20:32:06.191827 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m20:32:06.192654 [debug] [MainThread]: On master: Close
[0m20:32:06.193800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:06.194279 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:32:06.194625 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:32:06.195040 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:32:06.195415 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:32:06.195941 [info ] [MainThread]: 
[0m20:32:06.196384 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m20:32:06.198013 [debug] [MainThread]: Command end result
[0m20:32:06.224278 [info ] [MainThread]: 
[0m20:32:06.224665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:32:06.224901 [info ] [MainThread]: 
[0m20:32:06.225206 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  function trunc(date) does not exist
  LINE 13:     TO_CHAR(TRUNC(order_date), 'YYYY-MM') as order_date,
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:32:06.225450 [info ] [MainThread]: 
[0m20:32:06.225684 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:32:06.227631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8973808, "process_user_time": 1.556573, "process_kernel_time": 0.227349, "process_mem_max_rss": "128106496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:06.228035 [debug] [MainThread]: Command `dbt run` failed at 20:32:06.227966 after 3.90 seconds
[0m20:32:06.228325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104822090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bebef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105beba10>]}
[0m20:32:06.228612 [debug] [MainThread]: Flushing usage events
[0m20:32:06.321675 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:34:13.908103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bed0>]}


============================== 20:34:13.911548 | b1140957-8168-4cc0-b8a0-e3d1cf49d04d ==============================
[0m20:34:13.911548 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:34:13.911958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:13.963114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:34:13.963423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e60510>]}
[0m20:34:14.024190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a33ce0>]}
[0m20:34:14.052362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af3a50>]}
[0m20:34:14.053189 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:34:14.065931 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:34:14.143786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:14.144213 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:34:14.266823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:34:14.273456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8f020>]}
[0m20:34:14.334188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4d0f0>]}
[0m20:34:14.334549 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:34:14.334739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a81710>]}
[0m20:34:14.335994 [info ] [MainThread]: 
[0m20:34:14.336370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:14.338463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:34:14.371665 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:34:14.371946 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:34:14.372111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:14.862801 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.490 seconds
[0m20:34:14.866596 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:34:14.868683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:34:14.869112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:34:14.873307 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:34:14.874361 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:34:14.874583 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:34:14.874810 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:34:14.875053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:14.875240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:15.164822 [debug] [ThreadPool]: SQL status: BEGIN in 0.289 seconds
[0m20:34:15.165279 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:34:15.165515 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:34:15.178949 [debug] [ThreadPool]: SQL status: BEGIN in 0.304 seconds
[0m20:34:15.179865 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:34:15.180532 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:34:15.200956 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:34:15.204729 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:34:15.217795 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m20:34:15.220701 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:34:15.234471 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:34:15.254169 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:34:15.259811 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:15.260228 [debug] [MainThread]: On master: BEGIN
[0m20:34:15.260506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:15.541348 [debug] [MainThread]: SQL status: BEGIN in 0.281 seconds
[0m20:34:15.542911 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:15.543762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:15.581862 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m20:34:15.586696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad7ad0>]}
[0m20:34:15.587138 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:15.616415 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:15.617161 [debug] [MainThread]: On master: BEGIN
[0m20:34:15.673038 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m20:34:15.673597 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.673992 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:15.674369 [debug] [MainThread]: On master: COMMIT
[0m20:34:15.705305 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m20:34:15.710563 [debug] [MainThread]: On master: Close
[0m20:34:15.712378 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:34:15.713073 [info ] [MainThread]: 
[0m20:34:15.716630 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:34:15.717172 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:34:15.717467 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:34:15.717919 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:34:15.718728 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:34:15.719360 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:34:15.719733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:34:15.720023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:34:15.720310 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:34:15.720544 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:34:15.720770 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:34:15.720969 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:34:15.728365 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:34:15.731281 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:34:15.733703 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:34:15.734511 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:34:15.745740 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:34:15.769660 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:34:15.770302 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:34:15.770702 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:34:15.772977 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:34:15.773356 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:15.773652 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:15.773904 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:34:15.774152 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:34:15.774409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:15.774654 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:15.774889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:15.775241 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:34:15.775506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:34:16.043235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.269 seconds
[0m20:34:16.043587 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:16.043811 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:34:16.055995 [debug] [Thread-3 (]: SQL status: BEGIN in 0.280 seconds
[0m20:34:16.056295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.281 seconds
[0m20:34:16.056531 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:16.056758 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:16.056990 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:34:16.057231 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:34:16.084201 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m20:34:16.090865 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:16.091552 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:34:16.103025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:34:16.105556 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:16.105848 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:34:16.110045 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m20:34:16.112037 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:16.112271 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:34:16.119965 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:16.122678 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:16.122931 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:34:16.138182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:34:16.142062 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:16.142526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:16.142772 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:34:16.144422 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:16.144693 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:34:16.152178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:34:16.171692 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:34:16.172083 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:16.172526 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:34:16.176075 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:34:16.176400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:34:16.177600 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:34:16.178708 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:34:16.179030 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:16.179313 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:16.179581 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:34:16.179849 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:34:16.205952 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m20:34:16.211580 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:34:16.216192 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:16.216522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m20:34:16.216766 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m20:34:16.216976 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:34:16.218306 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:34:16.219584 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:34:16.219993 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:16.220377 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:16.220644 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:34:16.220876 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:34:16.246562 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.027 seconds
[0m20:34:16.248375 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:34:16.249469 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f08730>]}
[0m20:34:16.250043 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.53s]
[0m20:34:16.250585 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:34:16.254450 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:34:16.254748 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m20:34:16.255677 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:34:16.256538 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:34:16.257006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2a8f0>]}
[0m20:34:16.257304 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3ed50>]}
[0m20:34:16.257686 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.54s]
[0m20:34:16.258074 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m20:34:16.258418 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:34:16.258715 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:34:16.259132 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:34:16.259361 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:34:16.259609 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:34:16.259818 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:34:16.260084 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:34:16.260414 [info ] [Thread-2 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:34:16.260714 [info ] [Thread-3 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:34:16.261000 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:34:16.261309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m20:34:16.261565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:34:16.261814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:34:16.262097 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:34:16.262310 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:34:16.262509 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:34:16.262701 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:34:16.262890 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:34:16.265071 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:34:16.266824 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.268451 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:16.270630 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:34:16.271544 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:34:16.286600 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:34:16.287013 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:34:16.287315 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:34:16.287610 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:34:16.289898 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:16.291964 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.294049 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:34:16.294362 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.294776 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:34:16.295020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:16.295348 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:16.295540 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:34:16.295771 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:34:16.296092 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.296293 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:34:16.296468 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:16.296704 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.296976 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:34:16.297152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:34:16.567121 [debug] [Thread-4 (]: SQL status: BEGIN in 0.270 seconds
[0m20:34:16.567561 [debug] [Thread-2 (]: SQL status: BEGIN in 0.271 seconds
[0m20:34:16.567830 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.568072 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.568315 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:34:16.568608 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:34:16.575901 [debug] [Thread-3 (]: SQL status: BEGIN in 0.280 seconds
[0m20:34:16.576164 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:16.576396 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC(order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:34:16.590585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.296 seconds
[0m20:34:16.590819 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.591122 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:34:16.612774 [debug] [Thread-3 (]: Postgres adapter: Postgres error: function date_trunc(date) does not exist
LINE 13:     TO_CHAR(DATE_TRUNC(order_date), 'YYYY-MM') as order_date...
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:34:16.613643 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:34:16.637567 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.068 seconds
[0m20:34:16.643293 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.643600 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.075 seconds
[0m20:34:16.643825 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:34:16.645726 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.646312 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:34:16.647341 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:34:16.654257 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.063 seconds
[0m20:34:16.656697 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.657302 [debug] [Thread-3 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  function date_trunc(date) does not exist
  LINE 13:     TO_CHAR(DATE_TRUNC(order_date), 'YYYY-MM') as order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:34:16.657583 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:34:16.658005 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0214e0>]}
[0m20:34:16.658467 [error] [Thread-3 (]: 6 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.40s]
[0m20:34:16.658867 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:34:16.659238 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:34:16.660205 [info ] [Thread-3 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:34:16.660719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:34:16.661119 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:34:16.663324 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:34:16.663964 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:34:16.666496 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:34:16.667046 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:16.667337 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:34:16.667605 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:34:16.675520 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:34:16.675878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:16.678119 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.679802 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.680061 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:34:16.680310 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:34:16.691126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:34:16.693296 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.693541 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:34:16.708311 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:16.708634 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:16.712419 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:34:16.713613 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:34:16.713851 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.714069 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.714272 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:34:16.714483 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:34:16.726034 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:34:16.727183 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:34:16.727456 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.727683 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:34:16.742516 [debug] [Thread-4 (]: SQL status: COMMIT in 0.028 seconds
[0m20:34:16.742831 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m20:34:16.744292 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:34:16.745544 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:34:16.747528 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:16.747902 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:16.748153 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:34:16.748402 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:34:16.755692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m20:34:16.760310 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:34:16.760688 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:16.760933 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:34:16.779546 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.031 seconds
[0m20:34:16.779867 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.031 seconds
[0m20:34:16.780946 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:34:16.781761 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:34:16.782392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd58b0>]}
[0m20:34:16.782822 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.52s]
[0m20:34:16.783258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd5c70>]}
[0m20:34:16.783728 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:34:16.784101 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m20:34:16.784532 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.52s]
[0m20:34:16.784930 [info ] [Thread-2 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:34:16.785301 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:34:16.785562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:34:16.785922 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:34:16.787716 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:34:16.788287 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m20:34:16.832670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.071 seconds
[0m20:34:16.833071 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:34:16.833977 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:34:16.834453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934c2f0>]}
[0m20:34:16.834707 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:16.834909 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:34:16.835070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:16.835506 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.57s]
[0m20:34:16.835867 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:34:16.931792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.264 seconds
[0m20:34:16.932123 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:16.932410 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:34:16.986101 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.053 seconds
[0m20:34:16.988216 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:16.988656 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:34:17.019526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:17.021424 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:17.021659 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:34:17.052123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:17.053157 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:34:17.053394 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:17.053600 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:34:17.081041 [debug] [Thread-3 (]: SQL status: COMMIT in 0.027 seconds
[0m20:34:17.082912 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:34:17.083261 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:17.083551 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:34:17.100402 [debug] [Thread-2 (]: SQL status: BEGIN in 0.265 seconds
[0m20:34:17.100652 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:17.100882 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:34:17.111501 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.028 seconds
[0m20:34:17.112867 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:34:17.113320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a19970>]}
[0m20:34:17.113739 [info ] [Thread-3 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.45s]
[0m20:34:17.114119 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:34:17.157173 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.056 seconds
[0m20:34:17.160615 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:17.161287 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:34:17.189530 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:34:17.195162 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:17.195857 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:34:17.224585 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:17.228600 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:34:17.229280 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:17.230084 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:34:17.260131 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m20:34:17.265676 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:34:17.266173 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:34:17.266425 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:34:17.296156 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.029 seconds
[0m20:34:17.297551 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m20:34:17.298153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1140957-8168-4cc0-b8a0-e3d1cf49d04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aeffb0>]}
[0m20:34:17.298622 [info ] [Thread-2 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.51s]
[0m20:34:17.299031 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m20:34:17.300272 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:17.300546 [debug] [MainThread]: On master: BEGIN
[0m20:34:17.300729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:17.578095 [debug] [MainThread]: SQL status: BEGIN in 0.277 seconds
[0m20:34:17.579242 [debug] [MainThread]: On master: COMMIT
[0m20:34:17.579713 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:17.580196 [debug] [MainThread]: On master: COMMIT
[0m20:34:17.609394 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m20:34:17.610574 [debug] [MainThread]: On master: Close
[0m20:34:17.612759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:17.613277 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:34:17.613701 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:34:17.614119 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:34:17.614587 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:34:17.614965 [info ] [MainThread]: 
[0m20:34:17.615210 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m20:34:17.616336 [debug] [MainThread]: Command end result
[0m20:34:17.641454 [info ] [MainThread]: 
[0m20:34:17.641938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:17.642247 [info ] [MainThread]: 
[0m20:34:17.642582 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  function date_trunc(date) does not exist
  LINE 13:     TO_CHAR(DATE_TRUNC(order_date), 'YYYY-MM') as order_date...
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:34:17.642837 [info ] [MainThread]: 
[0m20:34:17.643079 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:34:17.644563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7821105, "process_user_time": 1.565017, "process_kernel_time": 0.233852, "process_mem_max_rss": "125517824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:34:17.644986 [debug] [MainThread]: Command `dbt run` failed at 20:34:17.644918 after 3.78 seconds
[0m20:34:17.645399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d38f0>]}
[0m20:34:17.645719 [debug] [MainThread]: Flushing usage events
[0m20:34:17.824007 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:34:57.349198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102af16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104423c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104423ed0>]}


============================== 20:34:57.351553 | fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc ==============================
[0m20:34:57.351553 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:34:57.351891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:34:57.388199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:34:57.388482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455c510>]}
[0m20:34:57.438428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10412bce0>]}
[0m20:34:57.466976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041eba50>]}
[0m20:34:57.467661 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:34:57.477195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:34:57.542165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:57.542585 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:34:57.664051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:34:57.670456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104487020>]}
[0m20:34:57.723047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052510f0>]}
[0m20:34:57.723436 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:34:57.723616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517d710>]}
[0m20:34:57.724791 [info ] [MainThread]: 
[0m20:34:57.725115 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:57.727340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:34:57.756228 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:34:57.756503 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:34:57.756671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:58.145656 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.389 seconds
[0m20:34:58.148385 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:34:58.150885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:34:58.151370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:34:58.155372 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:34:58.156413 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:34:58.156657 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:34:58.156837 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:34:58.157005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:34:58.157173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:58.458015 [debug] [ThreadPool]: SQL status: BEGIN in 0.300 seconds
[0m20:34:58.460475 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:34:58.461053 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:34:58.462075 [debug] [ThreadPool]: SQL status: BEGIN in 0.305 seconds
[0m20:34:58.462643 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:34:58.462975 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:34:58.496900 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:34:58.501325 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:34:58.501853 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m20:34:58.502871 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:34:58.525146 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:34:58.533261 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:34:58.537994 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:58.538265 [debug] [MainThread]: On master: BEGIN
[0m20:34:58.538446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:58.810053 [debug] [MainThread]: SQL status: BEGIN in 0.271 seconds
[0m20:34:58.811328 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:58.812682 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:58.854552 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:34:58.858276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bbad0>]}
[0m20:34:58.859009 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:58.889957 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:58.891768 [debug] [MainThread]: On master: BEGIN
[0m20:34:58.954063 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:34:58.959780 [debug] [MainThread]: On master: COMMIT
[0m20:34:58.960737 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:58.961158 [debug] [MainThread]: On master: COMMIT
[0m20:34:58.989362 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m20:34:58.990208 [debug] [MainThread]: On master: Close
[0m20:34:58.992374 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:34:58.992986 [info ] [MainThread]: 
[0m20:34:58.995161 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:34:58.995578 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:34:58.995865 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:34:58.996301 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:34:58.996763 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:34:58.997224 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:34:58.997689 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:34:58.998009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:34:58.998297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:34:58.998579 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:34:58.998824 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:34:58.999057 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:34:59.004367 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:34:59.006409 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:34:59.007898 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:34:59.008597 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:34:59.008866 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:34:59.015520 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:34:59.047092 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:34:59.047651 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:34:59.048774 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:34:59.049374 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.049561 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:34:59.049727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:59.050067 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.050294 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:34:59.050463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:59.050747 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.050977 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:34:59.051131 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:34:59.316939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.267 seconds
[0m20:34:59.317362 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.317613 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:34:59.337392 [debug] [Thread-2 (]: SQL status: BEGIN in 0.287 seconds
[0m20:34:59.337670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.287 seconds
[0m20:34:59.337886 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.338345 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.338849 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:34:59.339373 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:34:59.358297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m20:34:59.367415 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.367700 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:34:59.379968 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m20:34:59.380586 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m20:34:59.383143 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.384996 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.385238 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:34:59.385502 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:34:59.397994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:59.401027 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.401522 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:34:59.413770 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.414094 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.417292 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.419981 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.420360 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:34:59.420721 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:34:59.432704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:34:59.447454 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:34:59.447783 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.448095 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:34:59.449196 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.449496 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.450370 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:34:59.451215 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:34:59.451486 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.451706 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.451913 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:34:59.452136 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:34:59.478754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m20:34:59.484056 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:34:59.484450 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m20:34:59.484720 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m20:34:59.488404 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:34:59.489779 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:34:59.491038 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:34:59.491337 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:34:59.492022 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:34:59.492408 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:34:59.492767 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:34:59.493084 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:34:59.525753 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:34:59.526103 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:34:59.527800 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:34:59.528029 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:34:59.528901 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:34:59.529818 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:34:59.530842 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105600730>]}
[0m20:34:59.531132 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a3570>]}
[0m20:34:59.531556 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.53s]
[0m20:34:59.532561 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:34:59.531911 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.53s]
[0m20:34:59.533191 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:34:59.533487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2d2d0>]}
[0m20:34:59.534126 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m20:34:59.534499 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:34:59.534803 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:34:59.535094 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:34:59.535386 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:34:59.535640 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:34:59.536025 [info ] [Thread-3 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:34:59.536373 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:34:59.536770 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:34:59.537144 [info ] [Thread-2 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:34:59.537496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:34:59.537833 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:34:59.538109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m20:34:59.538367 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:34:59.538636 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:34:59.538888 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:34:59.539133 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:34:59.539357 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:34:59.541111 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:59.542898 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:34:59.544913 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:34:59.546478 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:34:59.547225 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:34:59.561375 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:34:59.561684 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:34:59.562977 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:59.565016 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:34:59.565350 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:34:59.567224 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:34:59.569380 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:34:59.569871 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:59.570126 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:34:59.570334 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:59.570554 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:34:59.570833 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:34:59.571117 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:59.571448 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:59.571651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:34:59.571844 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:34:59.572043 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:34:59.572292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:34:59.572466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:34:59.831885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.259 seconds
[0m20:34:59.832448 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:59.832749 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:34:59.838985 [debug] [Thread-3 (]: SQL status: BEGIN in 0.267 seconds
[0m20:34:59.839436 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:34:59.839803 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC(month, order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:34:59.853372 [debug] [Thread-4 (]: SQL status: BEGIN in 0.283 seconds
[0m20:34:59.853699 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:59.853953 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:34:59.858603 [debug] [Thread-2 (]: SQL status: BEGIN in 0.286 seconds
[0m20:34:59.858830 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:59.859059 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:34:59.873232 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "month" does not exist
LINE 13:     TO_CHAR(DATE_TRUNC(month, order_date), 'YYYY-MM') as ord...
                                ^

[0m20:34:59.873563 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:34:59.909707 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:34:59.914111 [debug] [Thread-3 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  column "month" does not exist
  LINE 13:     TO_CHAR(DATE_TRUNC(month, order_date), 'YYYY-MM') as ord...
                                  ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:34:59.914456 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105584830>]}
[0m20:34:59.914870 [error] [Thread-3 (]: 6 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.38s]
[0m20:34:59.915318 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:34:59.915618 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:34:59.916432 [info ] [Thread-3 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:34:59.916719 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.084 seconds
[0m20:34:59.916971 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:34:59.918921 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:59.919172 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:34:59.919399 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:34:59.921248 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:34:59.922122 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:34:59.924887 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:34:59.925448 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:34:59.925735 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:34:59.926004 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:34:59.932336 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.078 seconds
[0m20:34:59.934947 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:59.935317 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:34:59.951355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:34:59.953581 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:59.953857 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:34:59.963990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.966280 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:59.966571 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:34:59.968940 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.109 seconds
[0m20:34:59.971288 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:34:59.971653 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:34:59.983440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:34:59.987857 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:34:59.988186 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:34:59.988422 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:34:59.995963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:34:59.997113 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:34:59.997362 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:34:59.997576 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:35:00.002693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:35:00.004770 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:00.005045 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:35:00.018048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m20:35:00.019713 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:35:00.021704 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:00.021958 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:35:00.026439 [debug] [Thread-4 (]: SQL status: COMMIT in 0.029 seconds
[0m20:35:00.030337 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:35:00.030735 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:00.030937 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:35:00.037970 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:35:00.038957 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:35:00.039161 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:00.039331 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:35:00.057116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:35:00.058086 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:35:00.058548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105652210>]}
[0m20:35:00.059005 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.52s]
[0m20:35:00.059398 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:35:00.059645 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:35:00.059905 [info ] [Thread-1 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:35:00.060245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.product_performance)
[0m20:35:00.060426 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:35:00.061819 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:35:00.062337 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:35:00.103974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.064 seconds
[0m20:35:00.104328 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.073 seconds
[0m20:35:00.105642 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:35:00.105933 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:35:00.106742 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:35:00.107053 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:00.107401 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:35:00.107739 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105651cd0>]}
[0m20:35:00.108119 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.57s]
[0m20:35:00.108397 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.108685 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:35:00.108860 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:35:00.109134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:00.147391 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.040 seconds
[0m20:35:00.148472 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:35:00.148917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056522d0>]}
[0m20:35:00.149273 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.61s]
[0m20:35:00.149606 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:35:00.195194 [debug] [Thread-3 (]: SQL status: BEGIN in 0.269 seconds
[0m20:35:00.195525 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:00.195744 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:35:00.250902 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.055 seconds
[0m20:35:00.253036 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:00.253291 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:35:00.283504 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:35:00.285846 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:00.286146 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:35:00.315667 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:35:00.316754 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:35:00.316992 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:00.317197 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:35:00.349729 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m20:35:00.351083 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:35:00.351519 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:00.351879 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:35:00.383856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.275 seconds
[0m20:35:00.384179 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.384419 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:35:00.386790 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:35:00.388429 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:35:00.389120 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578ba10>]}
[0m20:35:00.389714 [info ] [Thread-3 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.47s]
[0m20:35:00.390306 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:35:00.441023 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.056 seconds
[0m20:35:00.443299 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.443566 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:35:00.468865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:35:00.471078 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.471331 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:35:00.497568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:35:00.501683 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:35:00.502158 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.502410 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:35:00.534883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m20:35:00.537879 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:35:00.538317 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:00.538560 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:35:00.571868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:35:00.575864 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:35:00.576675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd1c0fe-48fd-4625-b74e-3aa0b42ae9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576bef0>]}
[0m20:35:00.577177 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.52s]
[0m20:35:00.577611 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:35:00.578914 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:00.579169 [debug] [MainThread]: On master: BEGIN
[0m20:35:00.579359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:00.853023 [debug] [MainThread]: SQL status: BEGIN in 0.273 seconds
[0m20:35:00.854947 [debug] [MainThread]: On master: COMMIT
[0m20:35:00.855456 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:00.855937 [debug] [MainThread]: On master: COMMIT
[0m20:35:00.883957 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m20:35:00.884732 [debug] [MainThread]: On master: Close
[0m20:35:00.885284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:00.885476 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:35:00.885638 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:35:00.885793 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:35:00.885976 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:35:00.886279 [info ] [MainThread]: 
[0m20:35:00.886512 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m20:35:00.888720 [debug] [MainThread]: Command end result
[0m20:35:00.916745 [info ] [MainThread]: 
[0m20:35:00.917138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:35:00.917384 [info ] [MainThread]: 
[0m20:35:00.917658 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  column "month" does not exist
  LINE 13:     TO_CHAR(DATE_TRUNC(month, order_date), 'YYYY-MM') as ord...
                                  ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:35:00.917878 [info ] [MainThread]: 
[0m20:35:00.918101 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:35:00.919261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6106284, "process_user_time": 1.518556, "process_kernel_time": 0.184492, "process_mem_max_rss": "127483904", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:00.919622 [debug] [MainThread]: Command `dbt run` failed at 20:35:00.919560 after 3.61 seconds
[0m20:35:00.919912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ebef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057eba10>]}
[0m20:35:00.920153 [debug] [MainThread]: Flushing usage events
[0m20:35:00.942854 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:35:17.737929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb3ed0>]}


============================== 20:35:17.740766 | 9b113fec-21d2-4bad-b871-fdbfba9ba4bb ==============================
[0m20:35:17.740766 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:35:17.741112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:35:17.777241 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:35:17.777518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce8510>]}
[0m20:35:17.826765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f7ce0>]}
[0m20:35:17.855421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b3a50>]}
[0m20:35:17.855961 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:35:17.865797 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:35:17.929705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:17.930129 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:35:18.054245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:35:18.060751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1f020>]}
[0m20:35:18.113367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111039010>]}
[0m20:35:18.113717 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:35:18.113898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b61710>]}
[0m20:35:18.115125 [info ] [MainThread]: 
[0m20:35:18.115482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:18.117694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:35:18.146771 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:35:18.147016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:35:18.147168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:18.643539 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.496 seconds
[0m20:35:18.647253 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:35:18.648974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:35:18.649413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:35:18.655174 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:35:18.656478 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:35:18.656781 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:35:18.656983 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:35:18.657162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:18.657369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:18.920764 [debug] [ThreadPool]: SQL status: BEGIN in 0.263 seconds
[0m20:35:18.922061 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:35:18.922777 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:35:18.952001 [debug] [ThreadPool]: SQL status: BEGIN in 0.295 seconds
[0m20:35:18.952534 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:35:18.953011 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:18.954617 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.031 seconds
[0m20:35:18.956010 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:35:18.984352 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:35:18.988521 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:35:18.991182 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:35:19.023533 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:35:19.032595 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:19.032835 [debug] [MainThread]: On master: BEGIN
[0m20:35:19.032978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:19.300203 [debug] [MainThread]: SQL status: BEGIN in 0.267 seconds
[0m20:35:19.301717 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:19.302409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:19.341832 [debug] [MainThread]: SQL status: SELECT 3 in 0.038 seconds
[0m20:35:19.348078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b9fad0>]}
[0m20:35:19.348487 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:19.376079 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:19.377810 [debug] [MainThread]: On master: BEGIN
[0m20:35:19.432179 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m20:35:19.433116 [debug] [MainThread]: On master: COMMIT
[0m20:35:19.433692 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:19.434093 [debug] [MainThread]: On master: COMMIT
[0m20:35:19.463756 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m20:35:19.464595 [debug] [MainThread]: On master: Close
[0m20:35:19.467154 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:19.467908 [info ] [MainThread]: 
[0m20:35:19.471118 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:35:19.471418 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:35:19.471650 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:35:19.472021 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:35:19.472393 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:35:19.472779 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:35:19.473551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:35:19.474186 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:35:19.474629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:35:19.475072 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:35:19.475460 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:35:19.475825 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:35:19.483821 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:35:19.486693 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:35:19.488716 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:35:19.489565 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:35:19.502544 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:35:19.510767 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:35:19.522180 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:35:19.522804 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:35:19.524904 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:35:19.525609 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.525901 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:35:19.526187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:19.526482 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.526854 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.527073 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:35:19.527261 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:35:19.527441 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:19.527613 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:19.791809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.266 seconds
[0m20:35:19.792256 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.792587 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:35:19.799085 [debug] [Thread-2 (]: SQL status: BEGIN in 0.271 seconds
[0m20:35:19.799327 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.799550 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:35:19.809779 [debug] [Thread-3 (]: SQL status: BEGIN in 0.282 seconds
[0m20:35:19.810013 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.810229 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:35:19.837257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m20:35:19.845699 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.846061 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:35:19.850804 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.051 seconds
[0m20:35:19.854624 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.855297 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:35:19.858517 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m20:35:19.860887 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.861143 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:35:19.881270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:35:19.884338 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.884624 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:35:19.884845 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:35:19.886530 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.886873 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:35:19.893514 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:35:19.895480 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.895732 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:35:19.916090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:35:19.917290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:35:19.930861 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:35:19.932509 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:35:19.933894 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:35:19.935170 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:35:19.935537 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.935873 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.936215 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.936516 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:35:19.936778 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:35:19.937001 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:35:19.972173 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m20:35:19.972690 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m20:35:19.978743 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:35:19.979321 [debug] [Thread-3 (]: SQL status: COMMIT in 0.042 seconds
[0m20:35:19.981184 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:35:19.985478 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:35:19.987020 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:35:19.987440 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:35:19.987724 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:35:19.988096 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:35:19.988367 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:35:19.988816 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:35:20.019393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.031 seconds
[0m20:35:20.021173 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:35:20.021419 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:35:20.021655 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:35:20.022439 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:35:20.023343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f47e0>]}
[0m20:35:20.024150 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:35:20.024591 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.55s]
[0m20:35:20.024859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117c04b0>]}
[0m20:35:20.025324 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:35:20.025714 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.55s]
[0m20:35:20.026009 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130dc50>]}
[0m20:35:20.026376 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:35:20.026659 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.55s]
[0m20:35:20.027131 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:35:20.027671 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:35:20.027947 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:35:20.028215 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:35:20.028508 [info ] [Thread-1 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:35:20.028782 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:35:20.029066 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:35:20.029413 [info ] [Thread-3 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:35:20.029733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m20:35:20.030003 [info ] [Thread-2 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:35:20.030277 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:35:20.030463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:35:20.030649 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:35:20.030831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m20:35:20.031005 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:35:20.031169 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:35:20.033014 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.033265 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:35:20.034574 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:35:20.036106 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:35:20.037869 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.038447 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:35:20.044736 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:35:20.051432 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:35:20.051726 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.053984 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:35:20.054269 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:35:20.056083 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:35:20.058141 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.058669 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.058989 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.059357 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:35:20.059625 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.059847 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:35:20.060103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:20.060354 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.060533 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:35:20.060731 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:35:20.060981 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:35:20.061162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:35:20.061409 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:35:20.335623 [debug] [Thread-4 (]: SQL status: BEGIN in 0.274 seconds
[0m20:35:20.336010 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.336466 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:35:20.343098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.282 seconds
[0m20:35:20.343335 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.343547 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:35:20.348160 [debug] [Thread-2 (]: SQL status: BEGIN in 0.287 seconds
[0m20:35:20.348574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.288 seconds
[0m20:35:20.348818 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.349031 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.349252 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:35:20.349572 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:35:20.391801 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.055 seconds
[0m20:35:20.394256 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.394539 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:35:20.415249 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.065 seconds
[0m20:35:20.419423 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.419755 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.070 seconds
[0m20:35:20.420031 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:35:20.422165 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.422463 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:35:20.424838 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:35:20.426534 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.426770 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:35:20.427581 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.084 seconds
[0m20:35:20.429297 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.429521 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:35:20.452278 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:35:20.455864 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:35:20.456177 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.456435 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:35:20.456662 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:35:20.456856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:35:20.458803 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.460473 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.460702 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:35:20.460935 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:35:20.461160 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:35:20.462941 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.463508 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:35:20.489261 [debug] [Thread-4 (]: SQL status: COMMIT in 0.030 seconds
[0m20:35:20.490965 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:35:20.494020 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:35:20.494439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:35:20.494726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:35:20.494946 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:35:20.495149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:35:20.496116 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:35:20.496929 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:35:20.497894 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:35:20.498134 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.498342 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.498543 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.498782 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:35:20.499027 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:35:20.499251 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:35:20.530414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m20:35:20.531707 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:35:20.531979 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m20:35:20.532188 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:35:20.532376 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:35:20.532686 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:35:20.536892 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:35:20.538107 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:35:20.538963 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:35:20.539186 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:35:20.539499 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:20.539791 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:35:20.540180 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:35:20.540550 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:35:20.540992 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112809470>]}
[0m20:35:20.541583 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.51s]
[0m20:35:20.541977 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:35:20.542237 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:35:20.542502 [info ] [Thread-4 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:35:20.542868 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.orders_by_day)
[0m20:35:20.543185 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:35:20.544856 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:35:20.545503 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:35:20.585031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m20:35:20.585367 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.044 seconds
[0m20:35:20.585624 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.044 seconds
[0m20:35:20.586741 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:35:20.587604 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:35:20.588299 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:35:20.589146 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:35:20.589669 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:20.589965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f3b90>]}
[0m20:35:20.590185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f3b30>]}
[0m20:35:20.590365 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076add30>]}
[0m20:35:20.590575 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:35:20.590992 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.56s]
[0m20:35:20.591360 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.56s]
[0m20:35:20.591662 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.56s]
[0m20:35:20.591883 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:35:20.592165 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:35:20.592430 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:35:20.592676 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:35:20.592951 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:35:20.593280 [info ] [Thread-1 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:35:20.593499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:35:20.593668 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:35:20.595107 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:35:20.595496 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:35:20.597111 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:35:20.597458 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:20.597620 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:35:20.597781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:20.855149 [debug] [Thread-4 (]: SQL status: BEGIN in 0.263 seconds
[0m20:35:20.855565 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:20.855866 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:35:20.878460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.280 seconds
[0m20:35:20.879300 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:20.879912 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:35:20.907772 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.051 seconds
[0m20:35:20.913908 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:20.914190 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:35:20.936455 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.056 seconds
[0m20:35:20.940910 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:20.941192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:35:20.941468 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:35:20.943134 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:20.943410 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:35:20.971240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m20:35:20.973389 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:35:20.973843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:35:20.974304 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:20.976952 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:20.977307 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:35:20.977615 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:35:21.011532 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m20:35:21.012263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:35:21.015598 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:35:21.016607 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:35:21.016946 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:35:21.017165 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:21.017372 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:35:21.017565 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:35:21.048528 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.030 seconds
[0m20:35:21.051857 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:35:21.052355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m20:35:21.054065 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:35:21.054439 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdc5f0>]}
[0m20:35:21.055216 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:35:21.056220 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.51s]
[0m20:35:21.056705 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:35:21.057222 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:35:21.092977 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:35:21.094379 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:35:21.094892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b113fec-21d2-4bad-b871-fdbfba9ba4bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebba70>]}
[0m20:35:21.095325 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.50s]
[0m20:35:21.095701 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:35:21.096715 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:21.096958 [debug] [MainThread]: On master: BEGIN
[0m20:35:21.097143 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:21.360263 [debug] [MainThread]: SQL status: BEGIN in 0.263 seconds
[0m20:35:21.361356 [debug] [MainThread]: On master: COMMIT
[0m20:35:21.361805 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:21.362252 [debug] [MainThread]: On master: COMMIT
[0m20:35:21.391232 [debug] [MainThread]: SQL status: COMMIT in 0.028 seconds
[0m20:35:21.392420 [debug] [MainThread]: On master: Close
[0m20:35:21.394490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:21.395190 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:35:21.395639 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:35:21.396129 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:35:21.396423 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:35:21.396757 [info ] [MainThread]: 
[0m20:35:21.396986 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m20:35:21.398186 [debug] [MainThread]: Command end result
[0m20:35:21.422556 [info ] [MainThread]: 
[0m20:35:21.422956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:21.423203 [info ] [MainThread]: 
[0m20:35:21.423444 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:35:21.424950 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.727307, "process_user_time": 1.544117, "process_kernel_time": 0.187365, "process_mem_max_rss": "128909312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:21.425506 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:21.425391 after 3.73 seconds
[0m20:35:21.425845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076aef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128abc50>]}
[0m20:35:21.426134 [debug] [MainThread]: Flushing usage events
[0m20:35:21.615396 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:35:24.388223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844fed0>]}


============================== 20:35:24.390933 | e25a7fde-c814-44e6-8fa3-f0856354a43b ==============================
[0m20:35:24.390933 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:35:24.391280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:35:24.428642 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:35:24.428936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108584510>]}
[0m20:35:24.479265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108157ce0>]}
[0m20:35:24.508028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821ba50>]}
[0m20:35:24.508622 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:35:24.519331 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:35:24.586492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:24.586773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:24.590010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:35:24.611308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b39c70>]}
[0m20:35:24.666401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853c210>]}
[0m20:35:24.666731 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:35:24.666909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eaea0>]}
[0m20:35:24.667867 [info ] [MainThread]: 
[0m20:35:24.668207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:24.670507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:35:24.671929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:35:24.702831 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:35:24.703135 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:35:24.703370 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:35:24.703557 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:35:24.703715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:24.703855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:24.975528 [debug] [ThreadPool]: SQL status: BEGIN in 0.272 seconds
[0m20:35:24.975862 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:35:24.976082 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:24.999836 [debug] [ThreadPool]: SQL status: BEGIN in 0.296 seconds
[0m20:35:25.000566 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:35:25.001012 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:35:25.007540 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.031 seconds
[0m20:35:25.010372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:35:25.036563 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m20:35:25.037395 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:35:25.039805 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:35:25.070067 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:35:25.079118 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:25.079440 [debug] [MainThread]: On master: BEGIN
[0m20:35:25.079605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:25.351921 [debug] [MainThread]: SQL status: BEGIN in 0.272 seconds
[0m20:35:25.353416 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:25.354472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:25.392781 [debug] [MainThread]: SQL status: SELECT 3 in 0.037 seconds
[0m20:35:25.397754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e25a7fde-c814-44e6-8fa3-f0856354a43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109156c90>]}
[0m20:35:25.398156 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:25.424460 [debug] [MainThread]: On master: Close
[0m20:35:25.426893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:25.427662 [info ] [MainThread]: 
[0m20:35:25.431132 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:35:25.431977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:35:25.432540 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:35:25.442451 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:25.443312 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:35:25.449762 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:35:25.450133 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  
  limit 5

[0m20:35:25.450454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:25.736385 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.285 seconds
[0m20:35:25.741074 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:35:25.742119 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:35:25.743483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:25.743741 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:35:25.743929 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m20:35:25.744385 [debug] [MainThread]: Command end result
[0m20:35:25.765134 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-10    |          476 |
| 2024-10    |         1844 |
| 2024-10    |         1645 |
| 2024-10    |         2610 |
| 2024-10    |         2834 |

[0m20:35:25.766546 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.4189858, "process_user_time": 1.044935, "process_kernel_time": 0.151948, "process_mem_max_rss": "121896960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:35:25.767006 [debug] [MainThread]: Command `dbt show` succeeded at 20:35:25.766929 after 1.42 seconds
[0m20:35:25.767334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109141860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109459bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109459b30>]}
[0m20:35:25.767620 [debug] [MainThread]: Flushing usage events
[0m20:35:25.771898 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:39:48.415110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b3ed0>]}


============================== 20:39:48.418532 | 86801763-64db-4f3e-a124-a19162b249a4 ==============================
[0m20:39:48.418532 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:39:48.418930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:39:48.482919 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:39:48.483348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110424510>]}
[0m20:39:48.538011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff7ce0>]}
[0m20:39:48.565703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b3a50>]}
[0m20:39:48.566304 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:39:48.582575 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:39:48.657244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:48.657716 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:39:48.779383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:39:48.786075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110353020>]}
[0m20:39:48.843385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111435010>]}
[0m20:39:48.843715 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:39:48.843898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111361bf0>]}
[0m20:39:48.845118 [info ] [MainThread]: 
[0m20:39:48.845479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:48.847718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:39:48.895154 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:39:48.895461 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:39:48.895632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:49.457200 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.562 seconds
[0m20:39:49.458411 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:39:49.460914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m20:39:49.461354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:39:49.467407 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:39:49.469093 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:39:49.469477 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:39:49.469788 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:39:49.470075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:49.470341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:49.772645 [debug] [ThreadPool]: SQL status: BEGIN in 0.302 seconds
[0m20:39:49.773866 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:39:49.774452 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:39:49.797941 [debug] [ThreadPool]: SQL status: BEGIN in 0.327 seconds
[0m20:39:49.799026 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:39:49.800016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:39:49.808429 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m20:39:49.813159 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:39:49.845757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.045 seconds
[0m20:39:49.846576 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:39:49.849025 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:39:49.883355 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:39:49.891389 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:49.891857 [debug] [MainThread]: On master: BEGIN
[0m20:39:49.892245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:50.184012 [debug] [MainThread]: SQL status: BEGIN in 0.291 seconds
[0m20:39:50.185265 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:50.186800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:50.228874 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:39:50.233624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139bad0>]}
[0m20:39:50.233991 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:50.259838 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:50.261099 [debug] [MainThread]: On master: BEGIN
[0m20:39:50.324002 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:39:50.325440 [debug] [MainThread]: On master: COMMIT
[0m20:39:50.325956 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:50.326433 [debug] [MainThread]: On master: COMMIT
[0m20:39:50.361544 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m20:39:50.362265 [debug] [MainThread]: On master: Close
[0m20:39:50.363303 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:50.363786 [info ] [MainThread]: 
[0m20:39:50.366765 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:39:50.367235 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:39:50.367544 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:39:50.367986 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:39:50.368394 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:39:50.368775 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:39:50.369108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m20:39:50.369583 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:39:50.370141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m20:39:50.370560 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:39:50.370853 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:39:50.371077 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:39:50.379020 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:39:50.381787 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:39:50.383823 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:39:50.384753 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:39:50.390635 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:39:50.397320 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:39:50.420526 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:39:50.422609 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:39:50.423849 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:39:50.424555 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.424851 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:39:50.425086 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.425270 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:50.425570 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:39:50.425790 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.426061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:50.426322 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:39:50.426608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:50.736011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.309 seconds
[0m20:39:50.737257 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.738073 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:39:50.744691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m20:39:50.745604 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.746370 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:39:50.757153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.332 seconds
[0m20:39:50.757821 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.758366 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:39:50.784424 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m20:39:50.791462 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.791787 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:39:50.793522 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m20:39:50.795892 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.796210 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:39:50.802140 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m20:39:50.805267 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.805524 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:39:50.820230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:39:50.824453 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.824873 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:39:50.828942 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:39:50.832608 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.832909 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:39:50.839411 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:39:50.843945 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.844530 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:39:50.855911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:39:50.870760 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:39:50.872077 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:39:50.873027 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:39:50.873300 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.873750 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.874104 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:39:50.874411 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:39:50.881166 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:39:50.882057 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:39:50.882285 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.882483 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:39:50.906277 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m20:39:50.910993 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:39:50.911284 [debug] [Thread-2 (]: SQL status: COMMIT in 0.037 seconds
[0m20:39:50.914564 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:39:50.914842 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m20:39:50.916129 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:39:50.916384 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:39:50.917610 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:39:50.918120 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:39:50.918640 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:39:50.918963 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:39:50.919248 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:39:50.956785 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m20:39:50.959747 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:39:50.960520 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.041 seconds
[0m20:39:50.960881 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.041 seconds
[0m20:39:50.962964 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:39:50.963857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e4520>]}
[0m20:39:50.966141 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:39:50.967013 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c14f0>]}
[0m20:39:50.967391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b1270>]}
[0m20:39:50.967858 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.59s]
[0m20:39:50.968385 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.60s]
[0m20:39:50.969041 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:39:50.969738 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.60s]
[0m20:39:50.970284 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:39:50.970806 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:39:50.971456 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:39:50.971857 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:39:50.972240 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:39:50.972647 [info ] [Thread-1 (]: 5 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:39:50.973067 [info ] [Thread-3 (]: 6 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:39:50.973411 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:39:50.973841 [info ] [Thread-4 (]: 4 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:39:50.974204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m20:39:50.974464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:39:50.974849 [info ] [Thread-2 (]: 7 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:39:50.975304 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m20:39:50.975629 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:39:50.975869 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:39:50.976114 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m20:39:50.976330 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:39:50.979538 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:50.981500 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:39:50.981894 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:39:50.983888 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:39:50.986798 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:39:50.987443 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:39:50.987798 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:39:51.005058 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:39:51.008157 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:39:51.011560 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.013581 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.014293 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:39:51.016199 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:39:51.016540 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.016768 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:39:51.017014 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.017296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:51.017511 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.017715 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:39:51.017958 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.018250 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:39:51.018493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:51.018719 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:39:51.018939 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:39:51.019227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:39:51.316166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.299 seconds
[0m20:39:51.316598 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.316854 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:39:51.323536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.305 seconds
[0m20:39:51.323811 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.324071 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    DATE_TRUNC('month', order_date) as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:39:51.341662 [debug] [Thread-2 (]: SQL status: BEGIN in 0.322 seconds
[0m20:39:51.342144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.323 seconds
[0m20:39:51.342448 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.342954 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.343563 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:39:51.344147 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:39:51.367544 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.043 seconds
[0m20:39:51.372625 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.372975 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:39:51.395956 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.078 seconds
[0m20:39:51.401541 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.401848 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:39:51.405908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:39:51.409870 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.410177 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:39:51.419334 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.074 seconds
[0m20:39:51.420118 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.075 seconds
[0m20:39:51.423401 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.425522 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.425775 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:39:51.426013 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:39:51.432906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.022 seconds
[0m20:39:51.433374 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:39:51.439679 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:39:51.442585 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.443041 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.443423 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:39:51.443769 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:39:51.457951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:39:51.458288 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:39:51.460504 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.462974 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.463305 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:39:51.463609 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:39:51.472456 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:39:51.473741 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:39:51.474048 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.474327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m20:39:51.474590 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:39:51.476261 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:39:51.478591 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:51.478874 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:39:51.497974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:39:51.498334 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:39:51.499407 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:39:51.500405 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:39:51.500679 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.500904 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.501113 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:39:51.501320 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:39:51.515148 [debug] [Thread-3 (]: SQL status: COMMIT in 0.039 seconds
[0m20:39:51.516694 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:39:51.516988 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:39:51.517459 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:39:51.518503 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:39:51.518773 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:39:51.519313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11250de80>]}
[0m20:39:51.519726 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.55s]
[0m20:39:51.520093 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:39:51.520347 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:39:51.520795 [info ] [Thread-1 (]: 8 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:39:51.521136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m20:39:51.521440 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:39:51.526692 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:39:51.527279 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:39:51.529305 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:39:51.529741 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:51.529973 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:39:51.530189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:51.535368 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m20:39:51.536892 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:39:51.537291 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:39:51.537549 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:39:51.537781 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:39:51.576181 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.057 seconds
[0m20:39:51.577003 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:39:51.577922 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:39:51.578222 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:39:51.578512 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:39:51.578901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122ed010>]}
[0m20:39:51.579277 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.60s]
[0m20:39:51.579647 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:39:51.579885 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m20:39:51.580192 [info ] [Thread-3 (]: 9 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:39:51.580510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m20:39:51.580737 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:39:51.582339 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:39:51.582911 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m20:39:51.584844 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:39:51.585226 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:51.585396 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:39:51.585554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:39:51.617276 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:39:51.618283 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:39:51.618695 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127e030>]}
[0m20:39:51.619030 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.64s]
[0m20:39:51.619392 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:39:51.619954 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.043 seconds
[0m20:39:51.620777 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:39:51.621111 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111212cf0>]}
[0m20:39:51.621402 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.65s]
[0m20:39:51.621690 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:39:51.860408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.330 seconds
[0m20:39:51.860816 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:51.861149 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:39:51.883700 [debug] [Thread-3 (]: SQL status: BEGIN in 0.298 seconds
[0m20:39:51.883989 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:51.884259 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:39:51.938888 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.077 seconds
[0m20:39:51.941332 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:51.941611 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:39:51.970837 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.086 seconds
[0m20:39:51.973509 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:51.973876 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:39:51.980026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:39:51.982703 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:51.982985 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:39:52.007920 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:39:52.009918 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:52.010175 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:39:52.019201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:39:52.020174 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:39:52.020394 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:52.020576 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:39:52.044329 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:39:52.045373 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:39:52.045584 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:52.045825 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:39:52.058582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m20:39:52.059945 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:39:52.060338 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:39:52.060549 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:39:52.081282 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m20:39:52.085198 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:39:52.085573 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:39:52.085793 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:39:52.103060 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.042 seconds
[0m20:39:52.105839 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:39:52.107186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122edaf0>]}
[0m20:39:52.108137 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.59s]
[0m20:39:52.108553 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:39:52.125979 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.040 seconds
[0m20:39:52.128319 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m20:39:52.129304 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86801763-64db-4f3e-a124-a19162b249a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122eecf0>]}
[0m20:39:52.130142 [info ] [Thread-3 (]: 9 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.55s]
[0m20:39:52.130934 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m20:39:52.132333 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:52.132605 [debug] [MainThread]: On master: BEGIN
[0m20:39:52.132810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:52.473773 [debug] [MainThread]: SQL status: BEGIN in 0.341 seconds
[0m20:39:52.474241 [debug] [MainThread]: On master: COMMIT
[0m20:39:52.474487 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:52.474683 [debug] [MainThread]: On master: COMMIT
[0m20:39:52.513416 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m20:39:52.513722 [debug] [MainThread]: On master: Close
[0m20:39:52.514197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:52.514378 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:39:52.514531 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:39:52.514678 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:39:52.514817 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:39:52.515053 [info ] [MainThread]: 
[0m20:39:52.515393 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m20:39:52.518020 [debug] [MainThread]: Command end result
[0m20:39:52.543766 [info ] [MainThread]: 
[0m20:39:52.544207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:52.544462 [info ] [MainThread]: 
[0m20:39:52.544708 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:39:52.546498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1810913, "process_user_time": 1.577222, "process_kernel_time": 0.294281, "process_mem_max_rss": "126517248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:39:52.546947 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:52.546880 after 4.18 seconds
[0m20:39:52.547288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a39b0>]}
[0m20:39:52.547577 [debug] [MainThread]: Flushing usage events
[0m20:39:52.640820 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:39:55.964480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070efed0>]}


============================== 20:39:55.967254 | f82931ff-ee8f-47df-9361-cbf2b322b088 ==============================
[0m20:39:55.967254 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:39:55.967693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:56.037700 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:39:56.037976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224510>]}
[0m20:39:56.088809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df7ce0>]}
[0m20:39:56.115969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb3a50>]}
[0m20:39:56.116595 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:39:56.126553 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:39:56.191102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:39:56.191344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:39:56.194794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:39:56.217173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dda90>]}
[0m20:39:56.274725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dc210>]}
[0m20:39:56.275216 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:39:56.275476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea6f70>]}
[0m20:39:56.276431 [info ] [MainThread]: 
[0m20:39:56.276776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:56.279072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:39:56.285804 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:39:56.311654 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:39:56.311914 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:39:56.312081 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:39:56.312291 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:39:56.312479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:56.312630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:56.620482 [debug] [ThreadPool]: SQL status: BEGIN in 0.308 seconds
[0m20:39:56.620877 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:39:56.621072 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:39:56.629356 [debug] [ThreadPool]: SQL status: BEGIN in 0.317 seconds
[0m20:39:56.629637 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:39:56.629862 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:39:56.656253 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m20:39:56.658172 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:39:56.665572 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:39:56.668571 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:39:56.688213 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:39:56.705738 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:39:56.718493 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:56.718940 [debug] [MainThread]: On master: BEGIN
[0m20:39:56.719266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:57.054006 [debug] [MainThread]: SQL status: BEGIN in 0.335 seconds
[0m20:39:57.054829 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:57.055533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:57.106931 [debug] [MainThread]: SQL status: SELECT 3 in 0.051 seconds
[0m20:39:57.110715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f82931ff-ee8f-47df-9361-cbf2b322b088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800ec90>]}
[0m20:39:57.111148 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:57.142122 [debug] [MainThread]: On master: Close
[0m20:39:57.144185 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:57.144829 [info ] [MainThread]: 
[0m20:39:57.147341 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:39:57.148022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:39:57.148712 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:39:57.158756 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:57.159601 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:39:57.166288 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:39:57.166660 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    DATE_TRUNC('month', order_date) as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  
  limit 5

[0m20:39:57.166981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:57.458206 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.291 seconds
[0m20:39:57.460114 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:39:57.460836 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:39:57.461927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:57.462141 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:39:57.462567 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m20:39:57.463634 [debug] [MainThread]: Command end result
[0m20:39:57.491263 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
|           order_date | total_orders |
| -------------------- | ------------ |
| 2024-10-01 00:00:... |          476 |
| 2024-10-01 00:00:... |         1844 |
| 2024-10-01 00:00:... |         1645 |
| 2024-10-01 00:00:... |         2610 |
| 2024-10-01 00:00:... |         2834 |

[0m20:39:57.492758 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5715151, "process_user_time": 1.047618, "process_kernel_time": 0.163915, "process_mem_max_rss": "122667008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:39:57.493180 [debug] [MainThread]: Command `dbt show` succeeded at 20:39:57.493113 after 1.57 seconds
[0m20:39:57.493455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee1860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108315950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083159f0>]}
[0m20:39:57.493701 [debug] [MainThread]: Flushing usage events
[0m20:39:57.498257 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:40:48.782501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fd56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104defc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104defed0>]}


============================== 20:40:48.785943 | 4c6be866-eb3f-47bd-8b60-ec840f20f7c3 ==============================
[0m20:40:48.785943 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:48.786316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:48.835698 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:40:48.836011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f24510>]}
[0m20:40:48.892924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af7ce0>]}
[0m20:40:48.920595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf3a50>]}
[0m20:40:48.921288 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:48.932146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:40:49.011600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:49.011998 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:40:49.132820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:40:49.139186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e53020>]}
[0m20:40:49.196609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f29010>]}
[0m20:40:49.197004 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:40:49.197303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61bf0>]}
[0m20:40:49.198513 [info ] [MainThread]: 
[0m20:40:49.198827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:49.201010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:40:49.233364 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:40:49.233635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:40:49.233856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:49.664912 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.431 seconds
[0m20:40:49.668892 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:40:49.670796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m20:40:49.671272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:40:49.675531 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:40:49.676574 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:40:49.676817 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:40:49.677033 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:40:49.677277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:49.677496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:49.982846 [debug] [ThreadPool]: SQL status: BEGIN in 0.305 seconds
[0m20:40:49.983694 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:40:49.984848 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:40:50.004975 [debug] [ThreadPool]: SQL status: BEGIN in 0.327 seconds
[0m20:40:50.006349 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:40:50.011654 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:50.021995 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m20:40:50.024554 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:40:50.048948 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m20:40:50.052056 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:40:50.058457 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:40:50.084226 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:40:50.092822 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:50.093073 [debug] [MainThread]: On master: BEGIN
[0m20:40:50.093269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:50.402165 [debug] [MainThread]: SQL status: BEGIN in 0.309 seconds
[0m20:40:50.402941 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:50.403727 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:50.443367 [debug] [MainThread]: SQL status: SELECT 3 in 0.039 seconds
[0m20:40:50.447001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9fad0>]}
[0m20:40:50.448049 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:50.482294 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:50.483142 [debug] [MainThread]: On master: BEGIN
[0m20:40:50.547244 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m20:40:50.548216 [debug] [MainThread]: On master: COMMIT
[0m20:40:50.548694 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:50.549157 [debug] [MainThread]: On master: COMMIT
[0m20:40:50.582240 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m20:40:50.583000 [debug] [MainThread]: On master: Close
[0m20:40:50.584770 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:50.585896 [info ] [MainThread]: 
[0m20:40:50.589009 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:40:50.589345 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:40:50.589614 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:40:50.590003 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:40:50.590350 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:40:50.590678 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:40:50.590985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m20:40:50.591508 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:40:50.592117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m20:40:50.592418 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:40:50.592675 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:40:50.592885 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:40:50.600345 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:40:50.603309 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:40:50.605553 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:40:50.606568 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:40:50.612482 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:40:50.618875 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:40:50.645376 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:40:50.647638 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:40:50.649574 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:40:50.650559 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:50.650884 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:40:50.651125 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:50.651306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:50.651485 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:50.651661 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:40:50.651908 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:40:50.652088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:50.652278 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:50.967118 [debug] [Thread-2 (]: SQL status: BEGIN in 0.315 seconds
[0m20:40:50.968140 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:50.969071 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:40:50.969941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.319 seconds
[0m20:40:50.970303 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:50.970507 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:40:50.970747 [debug] [Thread-3 (]: SQL status: BEGIN in 0.318 seconds
[0m20:40:50.971074 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:50.971301 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:40:51.020254 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m20:40:51.036995 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:51.037332 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.068 seconds
[0m20:40:51.037556 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.067 seconds
[0m20:40:51.041290 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:40:51.043392 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:51.044992 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:51.045334 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:40:51.045585 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:40:51.075200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:40:51.075894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:40:51.079911 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:51.080174 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:40:51.081829 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:51.082050 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:40:51.083308 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:51.083511 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:40:51.083789 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:40:51.119456 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:40:51.123123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m20:40:51.130077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.046 seconds
[0m20:40:51.135449 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:40:51.136261 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:40:51.136946 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:40:51.137144 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:51.137314 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:51.137474 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:51.137632 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:40:51.137874 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:40:51.138039 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:40:51.168030 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m20:40:51.172013 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:40:51.174614 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:40:51.174834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m20:40:51.175063 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:40:51.175275 [debug] [Thread-3 (]: SQL status: COMMIT in 0.037 seconds
[0m20:40:51.176260 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:40:51.177249 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:40:51.177556 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:40:51.177825 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:40:51.178002 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:40:51.178194 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:40:51.209207 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:40:51.209475 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.031 seconds
[0m20:40:51.211148 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:40:51.211800 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:40:51.211970 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m20:40:51.212796 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:40:51.213768 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e4890>]}
[0m20:40:51.214124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106443250>]}
[0m20:40:51.214591 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.62s]
[0m20:40:51.214888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f11760>]}
[0m20:40:51.215297 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.62s]
[0m20:40:51.215651 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:40:51.215931 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.62s]
[0m20:40:51.216193 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:40:51.216469 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:40:51.216887 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:40:51.217092 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:40:51.217262 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:40:51.217453 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:40:51.217685 [info ] [Thread-3 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:40:51.217973 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:40:51.218210 [info ] [Thread-2 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:40:51.218426 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:40:51.218645 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.customer_lifetime_value)
[0m20:40:51.218855 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:40:51.219017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m20:40:51.219174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m20:40:51.219340 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:40:51.219498 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:40:51.219653 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:40:51.220028 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:40:51.221523 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.222743 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:40:51.224356 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.225796 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:40:51.227223 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:40:51.233367 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:40:51.245454 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.245834 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:40:51.247437 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:40:51.247708 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:40:51.249710 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.251970 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:40:51.252380 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.252733 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.253026 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:40:51.253343 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:40:51.253622 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.253899 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:51.254172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:51.254420 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.254638 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:40:51.255066 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:40:51.255318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:51.255560 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:40:51.552203 [debug] [Thread-3 (]: SQL status: BEGIN in 0.298 seconds
[0m20:40:51.552601 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.552852 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:40:51.562007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.308 seconds
[0m20:40:51.562267 [debug] [Thread-4 (]: SQL status: BEGIN in 0.307 seconds
[0m20:40:51.562541 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.562791 [debug] [Thread-2 (]: SQL status: BEGIN in 0.307 seconds
[0m20:40:51.562998 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.563215 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:40:51.563492 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.563774 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:40:51.564058 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
  );
  
[0m20:40:51.614551 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.061 seconds
[0m20:40:51.616725 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.616969 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:40:51.623363 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.059 seconds
[0m20:40:51.625349 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.625579 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:40:51.637116 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.073 seconds
[0m20:40:51.639382 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.640077 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:40:51.643737 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.079 seconds
[0m20:40:51.645612 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.645868 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:40:51.653692 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:40:51.655493 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.655728 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:40:51.658948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:40:51.661357 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.661601 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:40:51.675019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:40:51.675753 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:40:51.678132 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.679694 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.679945 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:40:51.680200 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:40:51.691558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:40:51.692484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:40:51.697839 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:40:51.699426 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:40:51.700127 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.700572 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.700974 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:40:51.701339 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:40:51.714237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:40:51.714476 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:40:51.715446 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:40:51.716729 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:40:51.716972 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.717215 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.717485 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:40:51.717699 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:40:51.733078 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m20:40:51.734544 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:40:51.734810 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:40:51.736784 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:51.740941 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:40:51.741205 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:40:51.741544 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:40:51.741823 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:40:51.751210 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m20:40:51.751445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m20:40:51.752671 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:40:51.753796 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:40:51.754111 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:40:51.754403 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:40:51.754635 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:40:51.754868 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:40:51.773883 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.032 seconds
[0m20:40:51.774803 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:40:51.775256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651d470>]}
[0m20:40:51.775639 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.56s]
[0m20:40:51.776024 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:40:51.776284 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:40:51.776539 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.034 seconds
[0m20:40:51.776818 [info ] [Thread-2 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:40:51.777679 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:40:51.777918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:40:51.778169 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:40:51.778425 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064810d0>]}
[0m20:40:51.781297 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:40:51.781966 [info ] [Thread-3 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.56s]
[0m20:40:51.782495 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:40:51.782802 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m20:40:51.783138 [info ] [Thread-3 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:40:51.783424 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:40:51.783652 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:40:51.827631 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.072 seconds
[0m20:40:51.829409 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:40:51.829705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.075 seconds
[0m20:40:51.830589 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:40:51.831544 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:40:51.831811 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:40:51.832164 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105474b30>]}
[0m20:40:51.834128 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:40:51.834433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cee6f0>]}
[0m20:40:51.834671 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m20:40:51.835001 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.61s]
[0m20:40:51.835374 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.62s]
[0m20:40:51.837325 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:40:51.837652 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:40:51.837877 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:51.838143 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:40:51.838472 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:40:51.838702 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:51.838902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:51.839104 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:40:51.839355 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:52.134428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.295 seconds
[0m20:40:52.135274 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:52.136082 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:40:52.183830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.344 seconds
[0m20:40:52.185109 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:52.185708 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:40:52.195524 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.059 seconds
[0m20:40:52.200960 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:52.201307 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:40:52.231724 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:40:52.236695 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:52.237021 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:40:52.243852 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.058 seconds
[0m20:40:52.247509 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:52.247775 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:40:52.266878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:40:52.271907 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:40:52.272674 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:52.273106 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:40:52.287587 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m20:40:52.293014 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:52.293393 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:40:52.305051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m20:40:52.310237 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:40:52.310626 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:40:52.310856 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:40:52.331892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:40:52.335272 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:40:52.335518 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:52.335722 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:40:52.347684 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:40:52.351017 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:40:52.351506 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5e50>]}
[0m20:40:52.351971 [info ] [Thread-2 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.57s]
[0m20:40:52.352386 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:40:52.377586 [debug] [Thread-3 (]: SQL status: COMMIT in 0.042 seconds
[0m20:40:52.379554 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:40:52.380384 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:40:52.380855 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:40:52.422964 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.041 seconds
[0m20:40:52.425514 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m20:40:52.426087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c6be866-eb3f-47bd-8b60-ec840f20f7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5c10>]}
[0m20:40:52.426499 [info ] [Thread-3 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.64s]
[0m20:40:52.426871 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m20:40:52.427785 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:52.427978 [debug] [MainThread]: On master: BEGIN
[0m20:40:52.428142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:52.752378 [debug] [MainThread]: SQL status: BEGIN in 0.324 seconds
[0m20:40:52.752738 [debug] [MainThread]: On master: COMMIT
[0m20:40:52.752930 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:52.753109 [debug] [MainThread]: On master: COMMIT
[0m20:40:52.784788 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m20:40:52.785936 [debug] [MainThread]: On master: Close
[0m20:40:52.788503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:52.789063 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:40:52.789510 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:40:52.789699 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:40:52.789856 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:40:52.790144 [info ] [MainThread]: 
[0m20:40:52.790364 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m20:40:52.791570 [debug] [MainThread]: Command end result
[0m20:40:52.818753 [info ] [MainThread]: 
[0m20:40:52.819124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:52.819486 [info ] [MainThread]: 
[0m20:40:52.819802 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:40:52.821324 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.082355, "process_user_time": 1.578127, "process_kernel_time": 0.225126, "process_mem_max_rss": "126517248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:52.821800 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:52.821716 after 4.08 seconds
[0m20:40:52.822098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10367d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659fef0>]}
[0m20:40:52.822380 [debug] [MainThread]: Flushing usage events
[0m20:40:52.858208 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:40:55.659442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065efed0>]}


============================== 20:40:55.662107 | 730ec8df-8862-4295-9f40-91d9462be189 ==============================
[0m20:40:55.662107 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:55.662461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:55.699328 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:40:55.699669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106724510>]}
[0m20:40:55.747173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f7ce0>]}
[0m20:40:55.775885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064efa50>]}
[0m20:40:55.776381 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:40:55.786283 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:40:55.857678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:40:55.857986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:40:55.861325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:40:55.882747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bda90>]}
[0m20:40:55.942055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dc210>]}
[0m20:40:55.942334 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:40:55.942509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e2f70>]}
[0m20:40:55.943359 [info ] [MainThread]: 
[0m20:40:55.943658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:55.945863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:40:55.953528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:40:55.981316 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:40:55.981579 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:40:55.981757 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:40:55.981933 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:40:55.982124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:55.982311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:56.294606 [debug] [ThreadPool]: SQL status: BEGIN in 0.312 seconds
[0m20:40:56.295079 [debug] [ThreadPool]: SQL status: BEGIN in 0.313 seconds
[0m20:40:56.295312 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:40:56.295528 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:40:56.295745 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:40:56.296025 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:40:56.334811 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m20:40:56.335422 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.039 seconds
[0m20:40:56.339153 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:40:56.340414 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:40:56.370758 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:40:56.372728 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:40:56.383539 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:56.383974 [debug] [MainThread]: On master: BEGIN
[0m20:40:56.384285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:56.683449 [debug] [MainThread]: SQL status: BEGIN in 0.298 seconds
[0m20:40:56.684568 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:56.685370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:56.727518 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:40:56.731773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '730ec8df-8862-4295-9f40-91d9462be189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734ec90>]}
[0m20:40:56.732124 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:56.766039 [debug] [MainThread]: On master: Close
[0m20:40:56.766695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:56.766935 [info ] [MainThread]: 
[0m20:40:56.769818 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:40:56.770182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:40:56.770419 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:40:56.776078 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:56.776987 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:40:56.783919 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:40:56.784313 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
  
  limit 5

[0m20:40:56.784622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:57.080514 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.295 seconds
[0m20:40:57.085139 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:40:57.085875 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:40:57.086606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:57.086796 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:40:57.086960 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m20:40:57.087340 [debug] [MainThread]: Command end result
[0m20:40:57.106889 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-02    |         2623 |
| 2024-05    |         1391 |
| 2024-05    |         3040 |
| 2024-06    |         3166 |
| 2024-07    |         1315 |

[0m20:40:57.108065 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.4889332, "process_user_time": 1.03897, "process_kernel_time": 0.147473, "process_mem_max_rss": "121978880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:57.108448 [debug] [MainThread]: Command `dbt show` succeeded at 20:40:57.108385 after 1.49 seconds
[0m20:40:57.108708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107339860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107651bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107651b30>]}
[0m20:40:57.108930 [debug] [MainThread]: Flushing usage events
[0m20:40:57.113555 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:42:14.754530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11016d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b3ed0>]}


============================== 20:42:14.758426 | 280c4160-3d21-4f67-b54f-18335bb2540d ==============================
[0m20:42:14.758426 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:42:14.758864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:14.807402 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:42:14.807802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e8510>]}
[0m20:42:14.856496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df7ce0>]}
[0m20:42:14.884059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb3a50>]}
[0m20:42:14.884665 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:42:14.895643 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:42:14.970957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:14.971372 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:42:15.093534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:42:15.100288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112417020>]}
[0m20:42:15.154829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133350f0>]}
[0m20:42:15.155149 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:42:15.155322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113261710>]}
[0m20:42:15.156525 [info ] [MainThread]: 
[0m20:42:15.156877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:15.158929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:42:15.191230 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:42:15.191510 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:42:15.191683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:15.703611 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.511 seconds
[0m20:42:15.707419 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:42:15.709342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:42:15.709733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:42:15.713932 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:42:15.714954 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:42:15.715174 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:42:15.715358 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:42:15.715525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:15.715712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:16.130263 [debug] [ThreadPool]: SQL status: BEGIN in 0.414 seconds
[0m20:42:16.131540 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:42:16.132482 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:42:16.173978 [debug] [ThreadPool]: SQL status: BEGIN in 0.458 seconds
[0m20:42:16.175021 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:42:16.175602 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:42:16.187086 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.054 seconds
[0m20:42:16.190915 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:42:16.257957 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.081 seconds
[0m20:42:16.261963 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:42:16.265035 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:42:16.299938 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:42:16.305582 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.305821 [debug] [MainThread]: On master: BEGIN
[0m20:42:16.305976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:16.614106 [debug] [MainThread]: SQL status: BEGIN in 0.308 seconds
[0m20:42:16.615836 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.616835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:16.658487 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:42:16.662297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329bad0>]}
[0m20:42:16.662889 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:16.697731 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.699065 [debug] [MainThread]: On master: BEGIN
[0m20:42:16.761787 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m20:42:16.762803 [debug] [MainThread]: On master: COMMIT
[0m20:42:16.763318 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:16.763794 [debug] [MainThread]: On master: COMMIT
[0m20:42:16.798282 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m20:42:16.799088 [debug] [MainThread]: On master: Close
[0m20:42:16.800724 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:16.801090 [info ] [MainThread]: 
[0m20:42:16.803828 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:42:16.804392 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:42:16.804824 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:42:16.805251 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:42:16.805715 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:42:16.806042 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:42:16.806532 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:42:16.807073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:42:16.807520 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:42:16.807947 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:42:16.808326 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:42:16.808688 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:42:16.816405 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:42:16.819077 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:42:16.821222 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:42:16.822092 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:42:16.822379 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:42:16.822599 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:42:16.856903 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:42:16.857287 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:42:16.859471 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:42:16.860095 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:16.860349 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:16.860571 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:42:16.860811 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:16.861019 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:42:16.861210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:42:16.861412 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:42:16.861623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:16.861891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:42:17.153448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.291 seconds
[0m20:42:17.153882 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:17.154189 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:42:17.161316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.300 seconds
[0m20:42:17.161608 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:17.161924 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:42:17.179827 [debug] [Thread-2 (]: SQL status: BEGIN in 0.319 seconds
[0m20:42:17.180082 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:17.180302 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:42:17.198379 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m20:42:17.206557 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:17.206815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:42:17.207059 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:42:17.209313 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:17.209610 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:42:17.223207 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m20:42:17.225042 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:17.225277 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:42:17.246284 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:42:17.247006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:42:17.250849 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:17.252481 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:17.252918 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:42:17.253143 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:42:17.255584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:42:17.257165 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:17.257388 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:42:17.282465 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:42:17.283351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:42:17.295336 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:42:17.297550 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:42:17.298450 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:42:17.299246 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:42:17.299477 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:17.299726 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:17.299968 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:17.300185 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:42:17.300387 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:42:17.300596 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:42:17.331404 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m20:42:17.331868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m20:42:17.336416 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:42:17.336679 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:42:17.338253 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:42:17.343487 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:42:17.345276 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:42:17.345763 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:42:17.346090 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:42:17.346521 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:42:17.346828 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:42:17.347192 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:42:17.380872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.033 seconds
[0m20:42:17.382667 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:42:17.382926 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:42:17.383200 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:42:17.384100 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:42:17.385114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e47e0>]}
[0m20:42:17.386031 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:42:17.386855 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139b0230>]}
[0m20:42:17.386472 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:42:17.387752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359f5d0>]}
[0m20:42:17.387447 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.58s]
[0m20:42:17.388254 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:42:17.388960 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:42:17.388656 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:42:17.389555 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:42:17.389910 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:42:17.390149 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:42:17.390393 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:42:17.390653 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:42:17.390922 [info ] [Thread-2 (]: 7 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:42:17.391275 [info ] [Thread-1 (]: 5 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:42:17.391557 [info ] [Thread-3 (]: 6 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:42:17.391834 [info ] [Thread-4 (]: 4 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:42:17.392102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m20:42:17.392524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m20:42:17.392972 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:42:17.393367 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m20:42:17.393649 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:42:17.393914 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:42:17.394162 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:42:17.394408 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:42:17.396732 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:42:17.398435 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.400099 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:42:17.402008 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.402788 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:42:17.414470 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:42:17.418928 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:42:17.421119 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:42:17.421419 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:42:17.421764 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:42:17.423815 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.425891 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.426219 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.426525 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.426858 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:42:17.427106 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.427328 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:42:17.427568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:42:17.427796 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.428007 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:42:17.428207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:42:17.428559 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:42:17.428814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:17.429081 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:42:17.709990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.282 seconds
[0m20:42:17.710464 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.710761 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:42:17.725690 [debug] [Thread-4 (]: SQL status: BEGIN in 0.297 seconds
[0m20:42:17.725937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.297 seconds
[0m20:42:17.726154 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.726394 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.726650 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:42:17.726893 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:42:17.756294 [debug] [Thread-2 (]: SQL status: BEGIN in 0.328 seconds
[0m20:42:17.756540 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.756876 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:42:17.782437 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.071 seconds
[0m20:42:17.788505 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.788765 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:42:17.800687 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.074 seconds
[0m20:42:17.804634 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.805191 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:42:17.815642 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.088 seconds
[0m20:42:17.818085 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.818356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:42:17.818589 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:42:17.818799 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.062 seconds
[0m20:42:17.820387 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.822127 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.822383 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:42:17.822607 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:42:17.837874 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:42:17.839741 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.839993 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:42:17.854119 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:42:17.854507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:42:17.857969 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:42:17.858248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:42:17.859801 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.860028 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.861506 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.861732 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:42:17.861935 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:42:17.862136 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:42:17.873815 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:42:17.874778 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:42:17.875013 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.875217 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:42:17.898304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:42:17.901214 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:42:17.901948 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.902520 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:42:17.903428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m20:42:17.903649 [debug] [Thread-3 (]: SQL status: COMMIT in 0.041 seconds
[0m20:42:17.904498 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:42:17.906086 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:42:17.906321 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.908123 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:42:17.908370 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m20:42:17.908613 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:42:17.908834 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:42:17.910000 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:42:17.910399 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:42:17.910628 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:42:17.935855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:42:17.942763 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:42:17.943097 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:17.943324 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:42:17.946301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:42:17.946544 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:42:17.947717 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:42:17.948098 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:42:17.949601 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:42:17.949978 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:42:17.950826 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:42:17.951179 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:42:17.951665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139bdd30>]}
[0m20:42:17.952194 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.56s]
[0m20:42:17.952607 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:42:17.952906 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e3350>]}
[0m20:42:17.953189 [debug] [Thread-4 (]: Began running node model.ecommerce_project.product_performance
[0m20:42:17.953585 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.56s]
[0m20:42:17.953894 [info ] [Thread-4 (]: 8 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:42:17.954276 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:42:17.954528 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:42:17.954805 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m20:42:17.955022 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:42:17.955319 [info ] [Thread-3 (]: 9 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:42:17.958006 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:42:17.958496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m20:42:17.959011 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:42:17.962062 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:42:17.962685 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.product_performance
[0m20:42:18.007917 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.064 seconds
[0m20:42:18.009829 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:42:18.010113 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.058 seconds
[0m20:42:18.011109 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:42:18.012054 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:42:18.012298 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m20:42:18.012696 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.013007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e2510>]}
[0m20:42:18.013275 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e2570>]}
[0m20:42:18.015173 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:42:18.015449 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:42:18.015811 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.62s]
[0m20:42:18.016136 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.62s]
[0m20:42:18.016420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:42:18.016727 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:42:18.017014 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:42:18.017213 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.017563 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:42:18.017737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:42:18.302064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.284 seconds
[0m20:42:18.303938 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.304631 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:42:18.314515 [debug] [Thread-4 (]: SQL status: BEGIN in 0.295 seconds
[0m20:42:18.314818 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.315069 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:42:18.364491 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.059 seconds
[0m20:42:18.370192 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.370510 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:42:18.374220 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.058 seconds
[0m20:42:18.376050 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.376298 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:42:18.402939 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:42:18.407539 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.407862 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:42:18.410192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:42:18.411864 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.412126 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:42:18.438239 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:42:18.441929 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:42:18.442210 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.442424 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:42:18.446408 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:42:18.449344 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:42:18.449748 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.450039 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:42:18.476190 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:42:18.479913 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:42:18.480293 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:42:18.480524 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:42:18.482892 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m20:42:18.485633 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:42:18.485963 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:42:18.486183 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:42:18.517487 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:42:18.521019 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m20:42:18.522618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0bad0>]}
[0m20:42:18.523811 [info ] [Thread-3 (]: 9 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.56s]
[0m20:42:18.524318 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m20:42:18.529391 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.043 seconds
[0m20:42:18.531066 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: Close
[0m20:42:18.531910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '280c4160-3d21-4f67-b54f-18335bb2540d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f8d10>]}
[0m20:42:18.532630 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.58s]
[0m20:42:18.533254 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.product_performance
[0m20:42:18.534374 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:18.534659 [debug] [MainThread]: On master: BEGIN
[0m20:42:18.534832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:42:18.841688 [debug] [MainThread]: SQL status: BEGIN in 0.307 seconds
[0m20:42:18.842093 [debug] [MainThread]: On master: COMMIT
[0m20:42:18.842288 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:18.842468 [debug] [MainThread]: On master: COMMIT
[0m20:42:18.877958 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m20:42:18.878885 [debug] [MainThread]: On master: Close
[0m20:42:18.881450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:18.882089 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:42:18.882491 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:42:18.882856 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:42:18.883207 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:42:18.883835 [info ] [MainThread]: 
[0m20:42:18.884342 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m20:42:18.885878 [debug] [MainThread]: Command end result
[0m20:42:18.908912 [info ] [MainThread]: 
[0m20:42:18.909248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:18.909452 [info ] [MainThread]: 
[0m20:42:18.909671 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:42:18.911091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1990547, "process_user_time": 1.555303, "process_kernel_time": 0.222237, "process_mem_max_rss": "127287296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:18.911681 [debug] [MainThread]: Command `dbt run` succeeded at 20:42:18.911562 after 4.20 seconds
[0m20:42:18.912003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa79b0>]}
[0m20:42:18.912299 [debug] [MainThread]: Flushing usage events
[0m20:42:19.012820 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:42:23.553273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cfed0>]}


============================== 20:42:23.555972 | 5c3454d1-ce75-47a5-99a5-97f3a4ae25db ==============================
[0m20:42:23.555972 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:42:23.556306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt show --select monthly_revenue_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:42:23.594450 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:42:23.594776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106404510>]}
[0m20:42:23.643724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd7ce0>]}
[0m20:42:23.672244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106093a50>]}
[0m20:42:23.672824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:42:23.683003 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:42:23.746538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:42:23.746828 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:42:23.749901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:42:23.771208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bda90>]}
[0m20:42:23.827086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bc210>]}
[0m20:42:23.827350 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:42:23.827520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6aea0>]}
[0m20:42:23.828400 [info ] [MainThread]: 
[0m20:42:23.828700 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:42:23.830966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:42:23.832405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:42:23.862339 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:42:23.862628 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:42:23.862827 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:42:23.862984 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:42:23.863178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:23.863372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:24.169379 [debug] [ThreadPool]: SQL status: BEGIN in 0.306 seconds
[0m20:42:24.169765 [debug] [ThreadPool]: SQL status: BEGIN in 0.307 seconds
[0m20:42:24.170057 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:42:24.170291 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:42:24.170516 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:42:24.170748 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:42:24.210123 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.039 seconds
[0m20:42:24.210924 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.040 seconds
[0m20:42:24.214595 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:42:24.216067 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:42:24.245518 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:42:24.246116 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:42:24.255419 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:24.255648 [debug] [MainThread]: On master: BEGIN
[0m20:42:24.255819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:42:24.561438 [debug] [MainThread]: SQL status: BEGIN in 0.305 seconds
[0m20:42:24.561801 [debug] [MainThread]: Using postgres connection "master"
[0m20:42:24.562278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:42:24.606522 [debug] [MainThread]: SQL status: SELECT 3 in 0.044 seconds
[0m20:42:24.608196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3454d1-ce75-47a5-99a5-97f3a4ae25db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6c90>]}
[0m20:42:24.608513 [debug] [MainThread]: On master: ROLLBACK
[0m20:42:24.637699 [debug] [MainThread]: On master: Close
[0m20:42:24.644238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:24.645642 [info ] [MainThread]: 
[0m20:42:24.648270 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:42:24.648627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:42:24.648869 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:42:24.654768 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:24.655488 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:42:24.660164 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:42:24.660552 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  
  limit 5

[0m20:42:24.661003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:24.952831 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.290 seconds
[0m20:42:24.955389 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:42:24.956345 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:42:24.957310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:24.957617 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:42:24.957809 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m20:42:24.958334 [debug] [MainThread]: Command end result
[0m20:42:24.977632 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-01    |          317 |
| 2024-01    |         1529 |
| 2024-01    |         2121 |
| 2024-01    |         2330 |
| 2024-01    |          671 |

[0m20:42:24.979034 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.4665613, "process_user_time": 1.03304, "process_kernel_time": 0.146096, "process_mem_max_rss": "121896960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:24.979443 [debug] [MainThread]: Command `dbt show` succeeded at 20:42:24.979376 after 1.47 seconds
[0m20:42:24.979714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc1860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ddbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ddb30>]}
[0m20:42:24.979977 [debug] [MainThread]: Flushing usage events
[0m20:42:24.984596 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:45:33.605154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027c16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047efed0>]}


============================== 20:45:33.608538 | 8112fbe9-8c5a-404f-831a-e5438c774226 ==============================
[0m20:45:33.608538 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:45:33.608922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt show --select monthly_revenue_orders --limit=100', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:33.658660 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:45:33.658959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104924510>]}
[0m20:45:33.708391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f7ce0>]}
[0m20:45:33.736794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3a50>]}
[0m20:45:33.737485 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:45:33.748964 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:45:33.822332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:45:33.822788 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:45:33.940509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:45:33.948016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104853020>]}
[0m20:45:34.008687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b39630>]}
[0m20:45:34.009044 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:45:34.009212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106361cc0>]}
[0m20:45:34.010090 [info ] [MainThread]: 
[0m20:45:34.010420 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:45:34.013074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:45:34.019310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:45:34.048657 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:45:34.048929 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:45:34.049118 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:45:34.049290 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:45:34.049456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:34.049598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:34.616806 [debug] [ThreadPool]: SQL status: BEGIN in 0.567 seconds
[0m20:45:34.618367 [debug] [ThreadPool]: SQL status: BEGIN in 0.569 seconds
[0m20:45:34.619091 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:45:34.619722 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:45:34.620127 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:45:34.620381 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:45:34.656754 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m20:45:34.657923 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m20:45:34.661560 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:45:34.662832 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:45:34.691965 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:45:34.692539 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:45:34.701453 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:34.701719 [debug] [MainThread]: On master: BEGIN
[0m20:45:34.701897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:35.011287 [debug] [MainThread]: SQL status: BEGIN in 0.309 seconds
[0m20:45:35.012332 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:35.013321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:45:35.054768 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m20:45:35.059232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8112fbe9-8c5a-404f-831a-e5438c774226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639fb90>]}
[0m20:45:35.059577 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:35.091934 [debug] [MainThread]: On master: Close
[0m20:45:35.093607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:35.094333 [info ] [MainThread]: 
[0m20:45:35.097524 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:45:35.097986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:45:35.098232 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:45:35.106267 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:45:35.107146 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:45:35.113416 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:45:35.113897 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
  
  limit 100

[0m20:45:35.114249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:35.402796 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.288 seconds
[0m20:45:35.404994 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:45:35.405841 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:45:35.406844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:35.407077 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:45:35.407267 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m20:45:35.407679 [debug] [MainThread]: Command end result
[0m20:45:35.427844 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-02    |         2623 |
| 2024-05    |         1391 |
| 2024-05    |         3040 |
| 2024-06    |         3166 |
| 2024-07    |         1315 |
| 2024-07    |         2267 |
| 2024-04    |         2888 |
| 2024-08    |          644 |
| 2024-02    |         2471 |
| 2024-05    |         1498 |
| 2024-05    |         2463 |
| 2024-06    |         2620 |
| 2024-07    |          549 |
| 2024-09    |         1245 |
| 2024-09    |          949 |
| 2024-01    |         1529 |
| 2024-05    |         1808 |
| 2024-03    |          491 |
| 2024-01    |         2121 |
| 2024-06    |         1681 |
| 2024-03    |         2694 |
| 2024-07    |          311 |
| 2024-05    |         1466 |
| 2024-09    |          827 |
| 2024-02    |         1169 |
| 2024-07    |          700 |
| 2024-05    |         1579 |
| 2024-04    |         1239 |
| 2024-01    |         2330 |
| 2024-01    |          317 |
| 2024-03    |         2789 |
| 2024-01    |          671 |
| 2024-06    |         1715 |
| 2024-10    |         1844 |
| 2024-04    |         4070 |
| 2024-07    |          223 |
| 2024-04    |         3892 |
| 2024-08    |         3674 |
| 2024-08    |         1096 |
| 2024-08    |         2472 |
| 2024-03    |         1703 |
| 2024-09    |         1431 |
| 2024-07    |         1976 |
| 2024-05    |         1285 |
| 2024-08    |         1581 |
| 2024-04    |         4618 |
| 2024-05    |         2141 |
| 2024-04    |         2199 |
| 2024-09    |         1125 |
| 2024-04    |         2147 |
| 2024-03    |          207 |
| 2024-06    |         1548 |
| 2024-01    |         1098 |
| 2024-02    |          929 |
| 2024-05    |         4046 |
| 2024-01    |         4102 |
| 2024-07    |         4674 |
| 2024-07    |          891 |
| 2024-04    |         1240 |
| 2024-05    |         1353 |
| 2024-08    |         1172 |
| 2024-04    |         1794 |
| 2024-08    |         4344 |
| 2024-05    |         1487 |
| 2024-02    |         4194 |
| 2024-04    |         4506 |
| 2024-01    |         2514 |
| 2024-02    |         1278 |
| 2024-06    |         1025 |
| 2024-06    |         3564 |
| 2024-06    |         1939 |
| 2024-09    |         3694 |
| 2024-03    |         2418 |
| 2024-03    |         2471 |
| 2024-05    |         2142 |
| 2024-10    |         1645 |
| 2024-04    |         2123 |
| 2024-01    |          758 |
| 2024-07    |         4533 |
| 2024-04    |         1817 |
| 2024-06    |         1307 |
| 2024-02    |         3441 |
| 2024-05    |         3790 |
| 2024-03    |         4077 |
| 2024-07    |         1395 |
| 2024-04    |         4504 |
| 2024-01    |         3895 |
| 2024-03    |         3257 |
| 2024-01    |         5178 |
| 2024-01    |         1133 |
| 2024-05    |         1554 |
| 2024-09    |         1298 |
| 2024-06    |         3503 |
| 2024-05    |          468 |
| 2024-01    |         3407 |
| 2024-10    |         2610 |
| 2024-09    |         1715 |
| 2024-05    |         3702 |
| 2024-06    |          984 |
| 2024-08    |         4213 |

[0m20:45:35.429731 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.870936, "process_user_time": 1.136752, "process_kernel_time": 0.175202, "process_mem_max_rss": "124764160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:35.430083 [debug] [MainThread]: Command `dbt show` succeeded at 20:45:35.430030 after 1.87 seconds
[0m20:45:35.430310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0dbd0>]}
[0m20:45:35.430503 [debug] [MainThread]: Flushing usage events
[0m20:45:35.656775 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:48:45.646885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10296d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b3ed0>]}


============================== 20:48:45.650404 | 7cdac610-e8c3-45a6-a66b-4347aa7614dc ==============================
[0m20:48:45.650404 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:48:45.650956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:45.700972 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:48:45.701225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae8510>]}
[0m20:48:45.757078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f7ce0>]}
[0m20:48:45.784425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b3a50>]}
[0m20:48:45.785110 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:48:45.796456 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:48:45.869266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:48:45.869636 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:48:45.992790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:48:45.999395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a17020>]}
[0m20:48:46.057470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a35010>]}
[0m20:48:46.057805 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:48:46.057985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105961710>]}
[0m20:48:46.059161 [info ] [MainThread]: 
[0m20:48:46.059508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:46.061630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:48:46.095093 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:48:46.095362 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:48:46.095528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:46.611513 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.516 seconds
[0m20:48:46.615297 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:48:46.616772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:48:46.617140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:48:46.621472 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:48:46.622891 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:48:46.623180 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:48:46.623415 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:48:46.623629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:46.623923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:46.922506 [debug] [ThreadPool]: SQL status: BEGIN in 0.298 seconds
[0m20:48:46.924426 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:48:46.924953 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:48:46.948448 [debug] [ThreadPool]: SQL status: BEGIN in 0.325 seconds
[0m20:48:46.949560 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:48:46.950096 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:48:46.957666 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.032 seconds
[0m20:48:46.961016 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:48:46.991886 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.041 seconds
[0m20:48:46.993018 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:48:46.993639 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:48:47.024635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:48:47.030770 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:47.031019 [debug] [MainThread]: On master: BEGIN
[0m20:48:47.031162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:47.344811 [debug] [MainThread]: SQL status: BEGIN in 0.313 seconds
[0m20:48:47.346522 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:47.347671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:47.393784 [debug] [MainThread]: SQL status: SELECT 3 in 0.045 seconds
[0m20:48:47.398455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105997ad0>]}
[0m20:48:47.398853 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:47.431998 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:47.432343 [debug] [MainThread]: On master: BEGIN
[0m20:48:47.496292 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m20:48:47.497166 [debug] [MainThread]: On master: COMMIT
[0m20:48:47.497769 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:47.498219 [debug] [MainThread]: On master: COMMIT
[0m20:48:47.539372 [debug] [MainThread]: SQL status: COMMIT in 0.040 seconds
[0m20:48:47.541050 [debug] [MainThread]: On master: Close
[0m20:48:47.542203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:47.542505 [info ] [MainThread]: 
[0m20:48:47.545579 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:48:47.545913 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:48:47.546164 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:48:47.546527 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:48:47.546890 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:48:47.547233 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:48:47.547578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:48:47.547877 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:48:47.548106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:48:47.548610 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:48:47.549045 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:48:47.549433 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:48:47.558691 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:48:47.559930 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:48:47.562045 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:48:47.562777 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:48:47.563050 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:48:47.568609 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:48:47.608855 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:48:47.609333 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:48:47.609730 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:48:47.610297 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:47.610535 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:47.610722 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:48:47.610910 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:47.611110 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:48:47.611290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:47.611468 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:48:47.611631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:48:47.611925 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:48:47.894119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.283 seconds
[0m20:48:47.894496 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:47.894744 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:48:47.902036 [debug] [Thread-2 (]: SQL status: BEGIN in 0.290 seconds
[0m20:48:47.902246 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:47.902451 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:48:47.911072 [debug] [Thread-3 (]: SQL status: BEGIN in 0.299 seconds
[0m20:48:47.912358 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:47.913076 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:48:47.945637 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m20:48:47.953034 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.058 seconds
[0m20:48:47.957164 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:47.957462 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:47.957748 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:48:47.958272 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:48:47.958771 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:48:47.961824 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:47.962242 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:48:47.986858 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:48:47.987216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:48:47.989173 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:47.991741 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:47.992056 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:48:47.992290 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:48:47.994726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:48:47.996689 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:47.996969 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:48:48.022699 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:48:48.023144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:48:48.033101 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:48:48.034086 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:48:48.034349 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:48:48.034631 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:48.034842 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:48.035533 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:48:48.035737 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:48:48.035945 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:48:48.036146 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:48.036395 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:48:48.072344 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:48:48.072588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m20:48:48.077265 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:48:48.077516 [debug] [Thread-3 (]: SQL status: COMMIT in 0.041 seconds
[0m20:48:48.078745 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:48:48.082198 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:48:48.083625 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:48:48.083977 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:48:48.084218 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:48:48.084522 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:48:48.084765 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:48:48.085104 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:48:48.120285 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:48:48.120505 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:48:48.122113 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:48:48.122332 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.037 seconds
[0m20:48:48.123137 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:48:48.124025 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:48:48.125362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de47e0>]}
[0m20:48:48.125937 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc14f0>]}
[0m20:48:48.126208 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8f930>]}
[0m20:48:48.126573 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:48:48.127154 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:48:48.127775 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.58s]
[0m20:48:48.128198 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:48:48.128583 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:48:48.128954 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:48:48.129743 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:48:48.130194 [info ] [Thread-2 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:48:48.130515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m20:48:48.130751 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:48:48.132612 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.132943 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:48:48.133224 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:48:48.133567 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:48:48.133908 [info ] [Thread-3 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:48:48.134442 [info ] [Thread-1 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:48:48.134705 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:48:48.135225 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:48:48.135646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:48:48.135947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m20:48:48.148505 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:48:48.153095 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.153405 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:48:48.153760 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:48:48.154038 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:48:48.155745 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:48:48.157611 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.159264 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:48:48.159580 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.160039 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:48:48.160307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:48:48.160819 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:48:48.161079 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:48:48.161332 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:48:48.163500 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:48:48.165125 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:48:48.166843 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.167511 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.167819 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.168045 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.168248 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:48:48.168464 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:48:48.168660 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:48:48.168863 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:48:48.169056 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:48:48.169241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:48.464684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.304 seconds
[0m20:48:48.465050 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.465294 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    COUNT(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:48:48.478084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.309 seconds
[0m20:48:48.478346 [debug] [Thread-4 (]: SQL status: BEGIN in 0.309 seconds
[0m20:48:48.478603 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.478832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.310 seconds
[0m20:48:48.479144 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.479405 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:48:48.479652 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.479884 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:48:48.480178 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:48:48.527890 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.062 seconds
[0m20:48:48.530077 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.530307 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:48:48.536196 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.056 seconds
[0m20:48:48.538250 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.538498 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:48:48.554496 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.074 seconds
[0m20:48:48.556268 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.556515 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:48:48.560732 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:48:48.562450 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.562674 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.082 seconds
[0m20:48:48.562906 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:48:48.564799 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.565072 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:48:48.574050 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:48:48.575660 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.576000 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:48:48.590264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:48:48.592256 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.592701 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:48:48.598260 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:48:48.599840 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.600063 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:48:48.600464 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:48:48.603940 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:48:48.604193 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.604405 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:48:48.605992 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:48:48.606863 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:48:48.607083 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.607292 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:48:48.621868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:48:48.622700 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:48:48.622940 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.623132 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:48:48.630207 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:48:48.631107 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:48:48.631327 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.631522 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:48:48.640794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m20:48:48.642020 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:48:48.642245 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m20:48:48.644049 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:48:48.648055 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:48:48.648314 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:48:48.648639 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:48.648899 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:48:48.659620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m20:48:48.660845 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:48:48.661155 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:48:48.661370 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:48:48.667112 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m20:48:48.668294 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:48:48.668596 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:48:48.668803 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:48:48.686530 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:48:48.690179 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:48:48.690420 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.041 seconds
[0m20:48:48.691307 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:48:48.691609 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc4360>]}
[0m20:48:48.692013 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.54s]
[0m20:48:48.692615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f41310>]}
[0m20:48:48.693533 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:48:48.694232 [info ] [Thread-2 (]: 6 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 282[0m in 0.56s]
[0m20:48:48.694550 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:48:48.694974 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:48:48.695253 [info ] [Thread-4 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:48:48.695529 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m20:48:48.695804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.orders_by_day)
[0m20:48:48.696102 [info ] [Thread-2 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:48:48.696345 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:48:48.696574 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m20:48:48.738986 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.070 seconds
[0m20:48:48.739287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.078 seconds
[0m20:48:48.740638 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:48:48.740908 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:48:48.741791 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:48:48.742535 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:48:48.744032 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:48:48.744671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057007d0>]}
[0m20:48:48.745034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057011f0>]}
[0m20:48:48.745416 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:48:48.745652 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m20:48:48.746008 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.61s]
[0m20:48:48.746336 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.61s]
[0m20:48:48.748619 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:48:48.750783 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:48:48.751244 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:48:48.751609 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:48:48.752169 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:48.752394 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:48.752608 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:48:48.752797 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:48:48.752983 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:48:48.753148 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:48:49.037943 [debug] [Thread-4 (]: SQL status: BEGIN in 0.285 seconds
[0m20:48:49.038266 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:49.038464 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:48:49.046146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.293 seconds
[0m20:48:49.047032 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:49.047651 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:48:49.108040 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.069 seconds
[0m20:48:49.112468 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:49.112809 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:48:49.115490 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.067 seconds
[0m20:48:49.118707 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:49.118996 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:48:49.146477 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:48:49.152097 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:49.152350 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:48:49.154061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:48:49.155673 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:49.155909 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:48:49.182467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:48:49.186199 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:48:49.186889 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:49.187499 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:48:49.189909 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:48:49.190898 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:48:49.191190 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:49.191417 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:48:49.222801 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m20:48:49.226401 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:48:49.226820 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:48:49.227061 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m20:48:49.227338 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:48:49.228589 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:48:49.228958 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:48:49.229344 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:48:49.262566 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:48:49.266247 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:48:49.268143 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:48:49.269611 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m20:48:49.270249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aed0d0>]}
[0m20:48:49.271297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdac610-e8c3-45a6-a66b-4347aa7614dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aed0d0>]}
[0m20:48:49.270817 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.57s]
[0m20:48:49.272013 [info ] [Thread-2 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.57s]
[0m20:48:49.273710 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:48:49.274057 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m20:48:49.275123 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:49.275371 [debug] [MainThread]: On master: BEGIN
[0m20:48:49.275578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:49.570437 [debug] [MainThread]: SQL status: BEGIN in 0.294 seconds
[0m20:48:49.571439 [debug] [MainThread]: On master: COMMIT
[0m20:48:49.571926 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:49.572429 [debug] [MainThread]: On master: COMMIT
[0m20:48:49.606212 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m20:48:49.607534 [debug] [MainThread]: On master: Close
[0m20:48:49.609440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:49.610190 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:48:49.610630 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:48:49.611122 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:48:49.611426 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:48:49.611751 [info ] [MainThread]: 
[0m20:48:49.611985 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.55 seconds (3.55s).
[0m20:48:49.614703 [debug] [MainThread]: Command end result
[0m20:48:49.641048 [info ] [MainThread]: 
[0m20:48:49.641392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:49.641673 [info ] [MainThread]: 
[0m20:48:49.641911 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:48:49.643206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0406556, "process_user_time": 1.550714, "process_kernel_time": 0.221809, "process_mem_max_rss": "127107072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:49.643583 [debug] [MainThread]: Command `dbt run` succeeded at 20:48:49.643519 after 4.04 seconds
[0m20:48:49.643827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103265310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a7830>]}
[0m20:48:49.644055 [debug] [MainThread]: Flushing usage events
[0m20:48:49.756049 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:48:54.742564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfbed0>]}


============================== 20:48:54.745334 | b5b0726a-1b9f-41c8-b81e-123a26373ef3 ==============================
[0m20:48:54.745334 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:48:54.745770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select monthly_revenue_orders --limit=100', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:48:54.782703 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:48:54.782996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e30510>]}
[0m20:48:54.833332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a03ce0>]}
[0m20:48:54.862424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abfa50>]}
[0m20:48:54.863066 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:48:54.872422 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:48:54.935494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:48:54.935744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:48:54.938573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:48:54.962931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e5c70>]}
[0m20:48:55.020939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8210>]}
[0m20:48:55.021257 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:48:55.021439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107996ea0>]}
[0m20:48:55.022432 [info ] [MainThread]: 
[0m20:48:55.022773 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:55.025027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:48:55.031842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:48:55.056458 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:48:55.056747 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:48:55.057000 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:48:55.057185 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:48:55.057444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:55.057654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:55.388999 [debug] [ThreadPool]: SQL status: BEGIN in 0.331 seconds
[0m20:48:55.390532 [debug] [ThreadPool]: SQL status: BEGIN in 0.333 seconds
[0m20:48:55.391586 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:48:55.392131 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:48:55.392695 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:48:55.393305 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:48:55.432939 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.039 seconds
[0m20:48:55.433667 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.040 seconds
[0m20:48:55.434873 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:48:55.437136 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:48:55.472298 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:48:55.472695 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:48:55.480551 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:55.480940 [debug] [MainThread]: On master: BEGIN
[0m20:48:55.481205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:55.774618 [debug] [MainThread]: SQL status: BEGIN in 0.293 seconds
[0m20:48:55.776056 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:55.776870 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:55.819827 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m20:48:55.823854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b0726a-1b9f-41c8-b81e-123a26373ef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a02c90>]}
[0m20:48:55.824249 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:55.858576 [debug] [MainThread]: On master: Close
[0m20:48:55.860491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:48:55.861211 [info ] [MainThread]: 
[0m20:48:55.864354 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:48:55.864698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:48:55.864944 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:48:55.871403 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:55.872489 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:48:55.878133 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:48:55.878480 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    COUNT(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date DESC
  
  limit 100

[0m20:48:55.878716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:56.218327 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.339 seconds
[0m20:48:56.223067 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:48:56.224128 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:48:56.224977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:56.225183 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:48:56.225353 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m20:48:56.225844 [debug] [MainThread]: Command end result
[0m20:48:56.244674 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| order_date | total_orders |
| ---------- | ------------ |
| 2024-10    |            6 |
| 2024-10    |            1 |
| 2024-10    |            3 |
| 2024-10    |            3 |
| 2024-10    |            6 |
| 2024-10    |            5 |
| 2024-10    |            2 |
| 2024-10    |            2 |
| 2024-10    |            4 |
| 2024-10    |            4 |
| 2024-10    |            2 |
| 2024-10    |            3 |
| 2024-10    |            5 |
| 2024-10    |            3 |
| 2024-10    |            2 |
| 2024-10    |            2 |
| 2024-09    |            2 |
| 2024-09    |            2 |
| 2024-09    |            1 |
| 2024-09    |            4 |
| 2024-09    |            2 |
| 2024-09    |            1 |
| 2024-09    |            4 |
| 2024-09    |            3 |
| 2024-09    |            1 |
| 2024-09    |            4 |
| 2024-09    |            2 |
| 2024-09    |            4 |
| 2024-09    |            2 |
| 2024-09    |            4 |
| 2024-09    |            5 |
| 2024-09    |            7 |
| 2024-09    |            5 |
| 2024-09    |            5 |
| 2024-09    |            4 |
| 2024-09    |            5 |
| 2024-09    |            3 |
| 2024-09    |            3 |
| 2024-09    |            5 |
| 2024-09    |            3 |
| 2024-09    |            3 |
| 2024-09    |            3 |
| 2024-09    |            3 |
| 2024-09    |            4 |
| 2024-09    |            2 |
| 2024-08    |            6 |
| 2024-08    |            2 |
| 2024-08    |            4 |
| 2024-08    |            4 |
| 2024-08    |            1 |
| 2024-08    |            3 |
| 2024-08    |            7 |
| 2024-08    |            4 |
| 2024-08    |            5 |
| 2024-08    |            2 |
| 2024-08    |            4 |
| 2024-08    |            2 |
| 2024-08    |            4 |
| 2024-08    |            5 |
| 2024-08    |            3 |
| 2024-08    |            5 |
| 2024-08    |            2 |
| 2024-08    |            2 |
| 2024-08    |            4 |
| 2024-08    |            4 |
| 2024-08    |            2 |
| 2024-08    |            5 |
| 2024-08    |            6 |
| 2024-08    |            4 |
| 2024-08    |            3 |
| 2024-08    |            4 |
| 2024-08    |            3 |
| 2024-08    |            6 |
| 2024-08    |            5 |
| 2024-08    |            1 |
| 2024-07    |            5 |
| 2024-07    |            5 |
| 2024-07    |            5 |
| 2024-07    |            1 |
| 2024-07    |            6 |
| 2024-07    |            7 |
| 2024-07    |            2 |
| 2024-07    |            1 |
| 2024-07    |            4 |
| 2024-07    |            1 |
| 2024-07    |            3 |
| 2024-07    |            6 |
| 2024-07    |            3 |
| 2024-07    |            5 |
| 2024-07    |            1 |
| 2024-07    |            1 |
| 2024-07    |            3 |
| 2024-07    |            2 |
| 2024-07    |            4 |
| 2024-07    |            3 |
| 2024-07    |            1 |
| 2024-07    |            5 |
| 2024-07    |            7 |
| 2024-07    |            1 |
| 2024-07    |            3 |

[0m20:48:56.246394 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5465918, "process_user_time": 1.025091, "process_kernel_time": 0.142067, "process_mem_max_rss": "122585088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:48:56.247050 [debug] [MainThread]: Command `dbt show` succeeded at 20:48:56.246955 after 1.55 seconds
[0m20:48:56.247404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ed860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d05bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d05b30>]}
[0m20:48:56.247735 [debug] [MainThread]: Flushing usage events
[0m20:48:56.252539 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:50:19.878031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045496a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7bed0>]}


============================== 20:50:19.881542 | 22986c7b-a36c-4074-a9f7-9c8cf728572e ==============================
[0m20:50:19.881542 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:50:19.881940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:19.931509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:50:19.931836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb0510>]}
[0m20:50:19.986148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b83ce0>]}
[0m20:50:20.013980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3fa50>]}
[0m20:50:20.014680 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:50:20.026752 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:50:20.099252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:20.099724 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:20.220775 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:50:20.227756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edf020>]}
[0m20:50:20.284618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca9010>]}
[0m20:50:20.284927 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:50:20.285119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5710>]}
[0m20:50:20.286408 [info ] [MainThread]: 
[0m20:50:20.286750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:20.289274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:50:20.322033 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:50:20.322305 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:50:20.322462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:20.881409 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.558 seconds
[0m20:50:20.885882 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:50:20.887555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:50:20.887950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:50:20.892608 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:50:20.893656 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:50:20.893877 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:50:20.894099 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:50:20.894336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:20.894530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:21.197631 [debug] [ThreadPool]: SQL status: BEGIN in 0.303 seconds
[0m20:50:21.198412 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:50:21.198987 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:50:21.206059 [debug] [ThreadPool]: SQL status: BEGIN in 0.311 seconds
[0m20:50:21.206725 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:50:21.207672 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:21.237428 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m20:50:21.240729 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:50:21.245408 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.036 seconds
[0m20:50:21.248616 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:50:21.273548 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:50:21.281707 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:50:21.291167 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:21.291439 [debug] [MainThread]: On master: BEGIN
[0m20:50:21.291667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:21.609495 [debug] [MainThread]: SQL status: BEGIN in 0.318 seconds
[0m20:50:21.610198 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:21.610657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:21.654627 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m20:50:21.659133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfbad0>]}
[0m20:50:21.659576 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:21.693446 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:21.694237 [debug] [MainThread]: On master: BEGIN
[0m20:50:21.757400 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m20:50:21.758474 [debug] [MainThread]: On master: COMMIT
[0m20:50:21.759209 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:21.759960 [debug] [MainThread]: On master: COMMIT
[0m20:50:21.799263 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m20:50:21.799940 [debug] [MainThread]: On master: Close
[0m20:50:21.801647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:21.802278 [info ] [MainThread]: 
[0m20:50:21.805970 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:50:21.806340 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:50:21.806576 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:50:21.806917 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:50:21.807232 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:50:21.807512 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:50:21.807836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:50:21.808543 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:50:21.809226 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:50:21.809721 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:50:21.810140 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:50:21.810533 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:50:21.818662 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:50:21.820908 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:50:21.822635 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:50:21.823262 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:50:21.823513 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:50:21.830914 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:50:21.859843 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:50:21.855384 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:50:21.860982 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:50:21.861629 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:21.861945 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:21.862294 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:21.862518 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:50:21.862732 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:50:21.862922 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:50:21.863105 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:21.863312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:21.863521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:22.148880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.285 seconds
[0m20:50:22.149322 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:22.149600 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:50:22.157072 [debug] [Thread-2 (]: SQL status: BEGIN in 0.294 seconds
[0m20:50:22.157367 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:22.157592 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:50:22.171571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.308 seconds
[0m20:50:22.171876 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:22.172112 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:50:22.190307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m20:50:22.198282 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:22.198569 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m20:50:22.198787 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:50:22.201023 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:22.201317 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:50:22.216421 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m20:50:22.218326 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:22.218573 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:50:22.234035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:50:22.238547 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:22.238805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:50:22.239017 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:50:22.240605 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:22.240885 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:50:22.256447 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:50:22.261356 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:22.261584 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:50:22.269695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:50:22.270404 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:50:22.285304 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:50:22.286694 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:50:22.286936 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:22.287158 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:22.287373 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:50:22.287570 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:50:22.296042 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:22.296903 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:50:22.297128 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:22.297328 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:50:22.318243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m20:50:22.322589 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:50:22.322860 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m20:50:22.326061 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:22.327319 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:50:22.327557 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:50:22.327871 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:22.328121 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:50:22.328780 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m20:50:22.331185 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:50:22.331770 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:22.332143 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:50:22.360104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:50:22.360419 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:50:22.362164 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:50:22.363107 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:50:22.365043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070587e0>]}
[0m20:50:22.365524 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.56s]
[0m20:50:22.365948 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:50:22.366880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544d4f0>]}
[0m20:50:22.367554 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.56s]
[0m20:50:22.367997 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:50:22.370075 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.038 seconds
[0m20:50:22.371268 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:50:22.371841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064892d0>]}
[0m20:50:22.372388 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.56s]
[0m20:50:22.372901 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:50:22.373671 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:50:22.374152 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:50:22.374433 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:50:22.374647 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:50:22.375038 [info ] [Thread-2 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:50:22.375388 [info ] [Thread-1 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:50:22.375681 [info ] [Thread-3 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:50:22.376009 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:50:22.376357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:50:22.376619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m20:50:22.376854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:50:22.377780 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:50:22.377342 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:50:22.377541 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:50:22.380232 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:50:22.377126 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:50:22.382242 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.384066 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:22.384519 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:50:22.387073 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:50:22.387431 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:50:22.387758 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:50:22.402393 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:50:22.403848 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:50:22.406205 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.406508 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:50:22.408397 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:22.410562 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:50:22.411043 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.411331 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.411592 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:50:22.411908 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:50:22.412144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:50:22.412427 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.412632 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:22.412834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:22.413134 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:50:22.413377 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:50:22.413677 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:22.413887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:22.697342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.284 seconds
[0m20:50:22.697698 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.697953 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:50:22.704962 [debug] [Thread-4 (]: SQL status: BEGIN in 0.291 seconds
[0m20:50:22.705229 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.705475 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:50:22.715918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.302 seconds
[0m20:50:22.716142 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:22.716370 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    WITH daily_orders AS (
  SELECT order_date,
         SUM(order_id) as total_orders,
         ROW_NUMBER() OVER (PARTITION BY DATE_TRUNC('month', order_date), order_date ORDER BY order_date DESC) as row_num
  FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
SELECT date_trunc('month', order_date) AS order_date,
       total_orders
FROM daily_orders
WHERE row_num = 1
GROUP BY order_date
ORDER BY order_date DESC;
  );
  
[0m20:50:22.749126 [debug] [Thread-3 (]: SQL status: BEGIN in 0.337 seconds
[0m20:50:22.749368 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.749588 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:50:22.752838 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: ORDER BY order_date DESC;
                                 ^

[0m20:50:22.753079 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:50:22.760666 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.055 seconds
[0m20:50:22.764703 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.764954 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:50:22.766066 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.068 seconds
[0m20:50:22.767887 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.768156 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:50:22.786083 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:50:22.795627 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:50:22.796203 [debug] [Thread-1 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  syntax error at or near ";"
  LINE 23: ORDER BY order_date DESC;
                                   ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:22.798230 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.798560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b56a0>]}
[0m20:50:22.798824 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:50:22.799250 [error] [Thread-1 (]: 6 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.42s]
[0m20:50:22.799686 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:50:22.799938 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:50:22.801148 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.051 seconds
[0m20:50:22.800770 [info ] [Thread-1 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:50:22.803119 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.803358 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:50:22.803799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:50:22.804225 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:50:22.806952 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.807327 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:50:22.807764 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:50:22.810286 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:50:22.811052 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:50:22.813603 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:50:22.814297 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:22.814567 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:50:22.814811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:22.829534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:50:22.833377 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:50:22.833699 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.833923 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:50:22.841123 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:50:22.843268 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.843519 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:50:22.845683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:50:22.847055 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:50:22.847297 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.847498 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:50:22.871068 [debug] [Thread-4 (]: SQL status: COMMIT in 0.037 seconds
[0m20:50:22.872693 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:50:22.874734 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:22.875002 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:50:22.878996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m20:50:22.880278 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:50:22.880522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:50:22.880893 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:22.881871 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:50:22.882108 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:50:22.882328 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.882575 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:50:22.913554 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:50:22.914459 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:50:22.914970 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107116870>]}
[0m20:50:22.915382 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.54s]
[0m20:50:22.915844 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:50:22.916133 [debug] [Thread-4 (]: Began running node model.ecommerce_project.product_performance
[0m20:50:22.916460 [info ] [Thread-4 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:50:22.916740 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.product_performance)
[0m20:50:22.916970 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:50:22.921967 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:50:22.922447 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.product_performance
[0m20:50:22.924425 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:50:22.924837 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:22.925042 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:50:22.925232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:50:22.925552 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.043 seconds
[0m20:50:22.925854 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m20:50:22.926808 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:50:22.928081 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:50:22.971649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c49010>]}
[0m20:50:22.972135 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:22.972590 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.60s]
[0m20:50:22.972916 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:50:22.973316 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:50:23.015138 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.041 seconds
[0m20:50:23.016317 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:50:23.016821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aedf70>]}
[0m20:50:23.017199 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.64s]
[0m20:50:23.017520 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:50:23.109460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.295 seconds
[0m20:50:23.109821 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:23.110062 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:50:23.170257 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.060 seconds
[0m20:50:23.172383 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:23.172661 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:50:23.205479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:50:23.207190 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:23.207431 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:50:23.241353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:23.242360 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:50:23.242633 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:23.242847 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:50:23.251733 [debug] [Thread-4 (]: SQL status: BEGIN in 0.326 seconds
[0m20:50:23.251960 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:23.252179 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:50:23.280847 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m20:50:23.286016 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:50:23.286502 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:23.286749 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:50:23.312453 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.060 seconds
[0m20:50:23.317433 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:23.317697 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:50:23.321686 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:50:23.322618 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:50:23.323123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dfd70>]}
[0m20:50:23.323564 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.52s]
[0m20:50:23.323960 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:50:23.352215 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:23.355822 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:23.356374 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:50:23.392513 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:50:23.395681 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:50:23.395971 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:23.396194 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:50:23.436641 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m20:50:23.441909 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:50:23.442282 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:23.442504 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:50:23.479891 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:50:23.484827 [debug] [Thread-4 (]: On model.ecommerce_project.product_performance: Close
[0m20:50:23.486329 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22986c7b-a36c-4074-a9f7-9c8cf728572e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c49010>]}
[0m20:50:23.486786 [info ] [Thread-4 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.57s]
[0m20:50:23.487165 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.product_performance
[0m20:50:23.488481 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:23.488753 [debug] [MainThread]: On master: BEGIN
[0m20:50:23.489360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:23.785657 [debug] [MainThread]: SQL status: BEGIN in 0.296 seconds
[0m20:50:23.786016 [debug] [MainThread]: On master: COMMIT
[0m20:50:23.786203 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:23.786383 [debug] [MainThread]: On master: COMMIT
[0m20:50:23.821189 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m20:50:23.821579 [debug] [MainThread]: On master: Close
[0m20:50:23.822003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:23.822265 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:50:23.822459 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m20:50:23.822625 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:50:23.822781 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:50:23.823050 [info ] [MainThread]: 
[0m20:50:23.823260 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m20:50:23.824306 [debug] [MainThread]: Command end result
[0m20:50:23.842270 [info ] [MainThread]: 
[0m20:50:23.842575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:23.842748 [info ] [MainThread]: 
[0m20:50:23.842976 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  syntax error at or near ";"
  LINE 23: ORDER BY order_date DESC;
                                   ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:23.843152 [info ] [MainThread]: 
[0m20:50:23.843324 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:50:23.844585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.009744, "process_user_time": 1.535925, "process_kernel_time": 0.220679, "process_mem_max_rss": "127680512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:23.845037 [debug] [MainThread]: Command `dbt run` failed at 20:50:23.844953 after 4.01 seconds
[0m20:50:23.845313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b2a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726bb90>]}
[0m20:50:23.845522 [debug] [MainThread]: Flushing usage events
[0m20:50:23.995130 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:50:29.518412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180b3ed0>]}


============================== 20:50:29.521704 | 3be1860a-5d8d-4af5-94e4-b360c8d323e4 ==============================
[0m20:50:29.521704 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:50:29.522106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:29.563435 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:50:29.563767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182ec510>]}
[0m20:50:29.612581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf7ce0>]}
[0m20:50:29.641888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef3a50>]}
[0m20:50:29.642739 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:50:29.653066 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:50:29.725794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:50:29.726299 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:29.846850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:50:29.853694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118217020>]}
[0m20:50:29.909794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190e5010>]}
[0m20:50:29.910122 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:50:29.910304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119011710>]}
[0m20:50:29.911476 [info ] [MainThread]: 
[0m20:50:29.911818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:29.914305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:50:29.946442 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:50:29.946837 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:50:29.947021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:30.275350 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.328 seconds
[0m20:50:30.279306 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:50:30.281036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:50:30.281491 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:50:30.285424 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:50:30.286432 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:50:30.286661 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:50:30.286849 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:50:30.287025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:30.287194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:30.589803 [debug] [ThreadPool]: SQL status: BEGIN in 0.302 seconds
[0m20:50:30.590813 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:50:30.591654 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:30.597674 [debug] [ThreadPool]: SQL status: BEGIN in 0.310 seconds
[0m20:50:30.598465 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:50:30.599929 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:50:30.630355 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m20:50:30.633309 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:50:30.636303 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m20:50:30.637284 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:50:30.665586 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:50:30.666086 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:50:30.674087 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:30.674368 [debug] [MainThread]: On master: BEGIN
[0m20:50:30.674588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:30.999749 [debug] [MainThread]: SQL status: BEGIN in 0.325 seconds
[0m20:50:31.000667 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:31.001554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:31.049171 [debug] [MainThread]: SQL status: SELECT 3 in 0.045 seconds
[0m20:50:31.052461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11904bad0>]}
[0m20:50:31.053043 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:31.087731 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:31.088947 [debug] [MainThread]: On master: BEGIN
[0m20:50:31.159507 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m20:50:31.160015 [debug] [MainThread]: On master: COMMIT
[0m20:50:31.160245 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:31.160477 [debug] [MainThread]: On master: COMMIT
[0m20:50:31.191405 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m20:50:31.191796 [debug] [MainThread]: On master: Close
[0m20:50:31.192430 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:31.192688 [info ] [MainThread]: 
[0m20:50:31.194996 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:50:31.195279 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:50:31.195530 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:50:31.195910 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:50:31.196189 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:50:31.196533 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:50:31.196830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:50:31.197152 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:50:31.197409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:50:31.197666 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:50:31.197903 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:50:31.198144 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:50:31.204977 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:50:31.207753 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:50:31.209877 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:50:31.210757 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:50:31.216787 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:50:31.225857 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:50:31.247211 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:50:31.247598 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:50:31.249625 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:50:31.250334 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.250633 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.250957 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.251198 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:50:31.251454 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:50:31.251665 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:50:31.251849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:31.252019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:31.252183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:31.541185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.289 seconds
[0m20:50:31.541990 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.542601 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:50:31.558181 [debug] [Thread-2 (]: SQL status: BEGIN in 0.306 seconds
[0m20:50:31.558676 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.559153 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:50:31.567956 [debug] [Thread-3 (]: SQL status: BEGIN in 0.315 seconds
[0m20:50:31.568846 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.569483 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:50:31.586417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m20:50:31.593860 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.594167 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:50:31.605819 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m20:50:31.608622 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.609097 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:50:31.615968 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m20:50:31.619558 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.619995 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:50:31.628435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:31.630596 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.630897 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:50:31.642861 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:50:31.645203 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.645478 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:50:31.651573 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:50:31.653887 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.654264 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:50:31.665253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:31.679348 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:50:31.679740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:31.680002 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.681098 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:50:31.681458 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:50:31.681738 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.682056 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:50:31.691422 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:50:31.692425 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:50:31.692669 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.692875 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:50:31.716262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m20:50:31.716508 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m20:50:31.721352 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:50:31.722614 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:50:31.725883 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:50:31.726172 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m20:50:31.726492 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:50:31.726744 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:50:31.727997 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:50:31.728254 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:50:31.728618 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:50:31.728940 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:50:31.764044 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m20:50:31.765962 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:50:31.766231 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.037 seconds
[0m20:50:31.766479 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.037 seconds
[0m20:50:31.767297 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:50:31.768233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194947e0>]}
[0m20:50:31.769082 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:50:31.769507 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.57s]
[0m20:50:31.769820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c4410>]}
[0m20:50:31.770435 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:50:31.770812 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190cecc0>]}
[0m20:50:31.771292 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.57s]
[0m20:50:31.771735 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.57s]
[0m20:50:31.772132 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:50:31.772448 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:50:31.773016 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:50:31.773275 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:50:31.773505 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:50:31.773744 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:50:31.774031 [info ] [Thread-3 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:50:31.774337 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:50:31.774621 [info ] [Thread-2 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:50:31.774893 [info ] [Thread-1 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:50:31.775210 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:50:31.775570 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:50:31.775854 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m20:50:31.776115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m20:50:31.776363 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:50:31.776595 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:50:31.776865 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:50:31.777103 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:50:31.779226 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:50:31.781025 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:50:31.782530 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:31.784360 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:50:31.785234 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:50:31.792424 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:50:31.792702 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:50:31.799556 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:50:31.801425 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:50:31.801735 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:50:31.803782 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:50:31.806032 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:31.806564 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:31.806907 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:31.807224 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:50:31.807496 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:50:31.807726 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:31.807953 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:31.808154 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:31.808340 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:50:31.808547 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:50:31.808771 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:50:31.809110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:31.809307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:32.117484 [debug] [Thread-4 (]: SQL status: BEGIN in 0.309 seconds
[0m20:50:32.117854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.309 seconds
[0m20:50:32.118176 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:32.118418 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:32.118663 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:50:32.118922 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:50:32.135703 [debug] [Thread-3 (]: SQL status: BEGIN in 0.327 seconds
[0m20:50:32.136595 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:32.137300 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:50:32.170773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.362 seconds
[0m20:50:32.171147 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:50:32.171470 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    WITH daily_orders AS (
  SELECT order_date,
         SUM(order_id) as total_orders,
         ROW_NUMBER() OVER (PARTITION BY DATE_TRUNC('month', order_date), order_date ORDER BY order_date DESC) as row_num
  FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
SELECT date_trunc('month', order_date) AS order_date,
       total_orders
FROM daily_orders
WHERE row_num = 1
GROUP BY order_date
ORDER BY order_date DESC
  );
  
[0m20:50:32.185545 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.066 seconds
[0m20:50:32.187726 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:32.187986 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:50:32.193240 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.074 seconds
[0m20:50:32.194974 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:32.195222 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:50:32.212932 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "stg_sales.order_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 13:   SELECT order_date,
                  ^

[0m20:50:32.213618 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:50:32.216147 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.078 seconds
[0m20:50:32.220690 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:32.221011 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:50:32.221824 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:32.225752 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:32.226398 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:50:32.229455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:32.232380 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:32.232833 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:50:32.252298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:50:32.257602 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:32.257908 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:50:32.258159 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:50:32.258492 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:50:32.262256 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:50:32.262621 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:32.263647 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:50:32.265161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:50:32.266117 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:50:32.266374 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:32.266640 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:50:32.272026 [debug] [Thread-2 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  column "stg_sales.order_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:   SELECT order_date,
                    ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:32.272548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11977b930>]}
[0m20:50:32.273214 [error] [Thread-2 (]: 6 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.50s]
[0m20:50:32.273858 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:50:32.274268 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:50:32.275192 [info ] [Thread-2 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:50:32.275615 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:50:32.275867 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:50:32.277520 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:50:32.278023 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:50:32.280639 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:50:32.281325 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.281618 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:50:32.281888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:50:32.300089 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:50:32.301433 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:50:32.301745 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:32.301976 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:50:32.303274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m20:50:32.303578 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m20:50:32.305081 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:50:32.306373 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:50:32.308383 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:50:32.308760 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:50:32.309001 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:50:32.309236 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:50:32.342228 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:50:32.342564 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m20:50:32.342804 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:50:32.343818 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:50:32.348963 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:50:32.350053 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:50:32.350571 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:50:32.350992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8993d0>]}
[0m20:50:32.351291 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8994f0>]}
[0m20:50:32.351538 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:50:32.351965 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.57s]
[0m20:50:32.352303 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.58s]
[0m20:50:32.352844 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:50:32.353194 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:50:32.353466 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:50:32.353869 [info ] [Thread-1 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:50:32.354166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:50:32.354396 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:50:32.356094 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:50:32.356597 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:50:32.358568 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:50:32.358983 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.359196 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:50:32.359398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:32.393086 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.040 seconds
[0m20:50:32.432922 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:50:32.433433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd5010>]}
[0m20:50:32.433905 [info ] [Thread-3 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.66s]
[0m20:50:32.434240 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:50:32.573390 [debug] [Thread-2 (]: SQL status: BEGIN in 0.291 seconds
[0m20:50:32.573772 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.574025 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:50:32.634202 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.060 seconds
[0m20:50:32.636707 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.637015 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:50:32.653415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.294 seconds
[0m20:50:32.653710 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.653940 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:50:32.669415 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:50:32.671436 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.671688 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:50:32.706245 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:50:32.707318 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:50:32.707589 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.707807 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:50:32.713565 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.059 seconds
[0m20:50:32.715740 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.715983 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:50:32.739315 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m20:50:32.742225 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:50:32.742585 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:50:32.742821 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:50:32.745691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:50:32.747599 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.747856 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:50:32.791468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m20:50:32.792301 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.049 seconds
[0m20:50:32.794805 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:50:32.795857 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:50:32.796128 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.796465 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:50:32.796818 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a67950>]}
[0m20:50:32.797300 [info ] [Thread-2 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.52s]
[0m20:50:32.797737 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:50:32.830518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:50:32.832323 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:50:32.832756 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:50:32.833075 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:50:32.865412 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m20:50:32.868104 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:50:32.869551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be1860a-5d8d-4af5-94e4-b360c8d323e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a899550>]}
[0m20:50:32.870094 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.52s]
[0m20:50:32.870515 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:50:32.871365 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:32.871568 [debug] [MainThread]: On master: BEGIN
[0m20:50:32.871736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:33.181374 [debug] [MainThread]: SQL status: BEGIN in 0.310 seconds
[0m20:50:33.181725 [debug] [MainThread]: On master: COMMIT
[0m20:50:33.181923 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:33.182108 [debug] [MainThread]: On master: COMMIT
[0m20:50:33.217632 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m20:50:33.219397 [debug] [MainThread]: On master: Close
[0m20:50:33.221461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:33.221672 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:50:33.221834 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:50:33.221988 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:50:33.222147 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:50:33.222428 [info ] [MainThread]: 
[0m20:50:33.222655 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m20:50:33.224841 [debug] [MainThread]: Command end result
[0m20:50:33.251839 [info ] [MainThread]: 
[0m20:50:33.252179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:50:33.252641 [info ] [MainThread]: 
[0m20:50:33.252972 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  column "stg_sales.order_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 13:   SELECT order_date,
                    ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:50:33.253328 [info ] [MainThread]: 
[0m20:50:33.253661 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:50:33.255110 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7806149, "process_user_time": 1.514823, "process_kernel_time": 0.190055, "process_mem_max_rss": "126238720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:33.255561 [debug] [MainThread]: Command `dbt run` failed at 20:50:33.255489 after 3.78 seconds
[0m20:50:33.255892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8fbe30>]}
[0m20:50:33.256184 [debug] [MainThread]: Flushing usage events
[0m20:50:33.260582 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:52:38.448925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029016a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045efed0>]}


============================== 20:52:38.452534 | 5fbd7100-d1b2-4131-8b94-b4b3fc693b2c ==============================
[0m20:52:38.452534 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:52:38.452903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:38.504020 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:52:38.504368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104724510>]}
[0m20:52:38.553748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f7ce0>]}
[0m20:52:38.581388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044efa50>]}
[0m20:52:38.582111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:52:38.593525 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:52:38.666179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:52:38.666550 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:52:38.786902 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:52:38.793341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104653020>]}
[0m20:52:38.850053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105535010>]}
[0m20:52:38.850343 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:52:38.850510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105461710>]}
[0m20:52:38.851621 [info ] [MainThread]: 
[0m20:52:38.851915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:38.854121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:52:38.886521 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:52:38.886784 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:52:38.887016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:39.413433 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.526 seconds
[0m20:52:39.416841 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:52:39.418722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:52:39.419106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:52:39.423278 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:52:39.424327 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:52:39.424555 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:52:39.424738 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:52:39.424909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:39.425073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:39.723808 [debug] [ThreadPool]: SQL status: BEGIN in 0.298 seconds
[0m20:52:39.725192 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:52:39.726017 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:52:39.731440 [debug] [ThreadPool]: SQL status: BEGIN in 0.306 seconds
[0m20:52:39.732109 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:52:39.732563 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:52:39.763667 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m20:52:39.768469 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:52:39.770415 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m20:52:39.771355 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:52:39.807826 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:52:39.809908 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:52:39.817600 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:39.817846 [debug] [MainThread]: On master: BEGIN
[0m20:52:39.818021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:40.120652 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m20:52:40.122594 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:40.123418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:40.165262 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:52:40.168642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549bad0>]}
[0m20:52:40.169322 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:40.203492 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:40.204134 [debug] [MainThread]: On master: BEGIN
[0m20:52:40.268217 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m20:52:40.268898 [debug] [MainThread]: On master: COMMIT
[0m20:52:40.269370 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:40.269817 [debug] [MainThread]: On master: COMMIT
[0m20:52:40.304229 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m20:52:40.305601 [debug] [MainThread]: On master: Close
[0m20:52:40.307498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:52:40.308228 [info ] [MainThread]: 
[0m20:52:40.311059 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:52:40.311346 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:52:40.311596 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:52:40.312305 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:52:40.312700 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:52:40.313821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:52:40.313120 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:52:40.314604 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:52:40.314902 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:52:40.315151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:52:40.315395 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:52:40.320836 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:52:40.321302 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:52:40.324389 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:52:40.326710 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:52:40.327393 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:52:40.333739 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:52:40.353232 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:52:40.363679 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:52:40.365710 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:52:40.366160 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:52:40.366810 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.367074 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:52:40.367278 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:52:40.367497 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.367845 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.368079 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:52:40.368271 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:52:40.368458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:52:40.368635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:40.664483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.295 seconds
[0m20:52:40.666771 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.668152 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:52:40.671466 [debug] [Thread-2 (]: SQL status: BEGIN in 0.304 seconds
[0m20:52:40.672309 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.673058 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:52:40.704645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.336 seconds
[0m20:52:40.705783 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.706323 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:52:40.714433 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.045 seconds
[0m20:52:40.723062 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.723377 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m20:52:40.723621 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:52:40.725882 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.726194 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:52:40.756130 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:52:40.761221 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.761472 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m20:52:40.761687 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:52:40.761889 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:52:40.763708 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.765415 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.765651 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:52:40.765870 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:52:40.792045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m20:52:40.806275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:52:40.806639 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m20:52:40.811816 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:52:40.813678 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.814539 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:52:40.814782 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.815004 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:52:40.815212 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.815409 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:52:40.815758 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:52:40.847954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:52:40.849142 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:52:40.849407 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.849626 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:52:40.852485 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:52:40.857063 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:52:40.857326 [debug] [Thread-3 (]: SQL status: COMMIT in 0.041 seconds
[0m20:52:40.860468 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:52:40.861770 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:52:40.862008 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:52:40.862328 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:52:40.862583 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:52:40.880682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m20:52:40.881986 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:52:40.882302 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:52:40.882517 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:52:40.894282 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:52:40.894573 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.032 seconds
[0m20:52:40.896313 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:52:40.897177 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:52:40.898839 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e47e0>]}
[0m20:52:40.899545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac14f0>]}
[0m20:52:40.900004 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:52:40.900475 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.58s]
[0m20:52:40.900951 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:52:40.901337 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:52:40.901839 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:52:40.902105 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:52:40.902394 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:52:40.902663 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:52:40.903047 [info ] [Thread-2 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:52:40.903499 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:52:40.903860 [info ] [Thread-3 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:52:40.904144 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m20:52:40.904392 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:52:40.904631 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:52:40.904866 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:52:40.907375 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:52:40.907716 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:52:40.909454 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:52:40.911315 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:52:40.911954 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:52:40.917999 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:52:40.924297 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.042 seconds
[0m20:52:40.929860 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:52:40.932978 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:52:40.933271 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:52:40.934260 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:52:40.936166 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:52:40.936682 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:52:40.937033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd7d50>]}
[0m20:52:40.937265 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:52:40.937502 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:40.937876 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.62s]
[0m20:52:40.938149 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:40.938377 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:52:40.938600 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:52:40.938924 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:52:40.939111 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:52:40.939367 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:52:40.939631 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:52:40.939867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:52:40.940274 [info ] [Thread-1 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:52:40.940666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.orders_by_customer)
[0m20:52:40.940900 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:52:40.942309 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:52:40.942966 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:52:40.945936 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:52:40.946475 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:40.946671 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:52:40.946951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:41.247807 [debug] [Thread-3 (]: SQL status: BEGIN in 0.309 seconds
[0m20:52:41.248178 [debug] [Thread-2 (]: SQL status: BEGIN in 0.308 seconds
[0m20:52:41.248435 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:52:41.248668 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:41.248900 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as order_date,
    SUM(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date, total_orders
ORDER BY order_date DESC
  );
  
[0m20:52:41.249236 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:52:41.255743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.309 seconds
[0m20:52:41.255960 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:41.256183 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:52:41.270362 [debug] [Thread-4 (]: SQL status: BEGIN in 0.331 seconds
[0m20:52:41.271246 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:41.271839 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:52:41.288203 [debug] [Thread-3 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 14:     SUM(order_id) as total_orders
             ^

[0m20:52:41.289123 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: ROLLBACK
[0m20:52:41.310831 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.061 seconds
[0m20:52:41.316981 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:41.317363 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:52:41.325669 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:52:41.330482 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.074 seconds
[0m20:52:41.332378 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:41.332701 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:52:41.338067 [debug] [Thread-3 (]: Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 14:     SUM(order_id) as total_orders
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:52:41.338448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9db70>]}
[0m20:52:41.338904 [error] [Thread-3 (]: 6 of 9 ERROR creating sql table model public.monthly_revenue_orders ............ [[31mERROR[0m in 0.43s]
[0m20:52:41.339321 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:52:41.339681 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:52:41.341268 [info ] [Thread-3 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:52:41.341763 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m20:52:41.342133 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:52:41.344507 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:52:41.344926 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.073 seconds
[0m20:52:41.347798 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:41.348229 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:52:41.348557 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:52:41.350501 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:41.350799 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:52:41.351080 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:52:41.353388 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:52:41.353936 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.354182 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:52:41.354538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:52:41.364482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:52:41.366557 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:41.366816 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:52:41.382603 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:52:41.384949 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:41.385214 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:52:41.391844 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:52:41.395635 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:52:41.395920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:52:41.396157 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:41.397071 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:52:41.397358 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:52:41.397592 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:41.397851 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:52:41.421819 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:52:41.422894 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:52:41.423117 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:41.423316 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:52:41.431010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m20:52:41.431251 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m20:52:41.432650 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:52:41.436898 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:52:41.438859 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:52:41.439200 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:52:41.439430 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:52:41.439651 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:52:41.454895 [debug] [Thread-4 (]: SQL status: COMMIT in 0.031 seconds
[0m20:52:41.456141 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:52:41.456473 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:52:41.456687 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:52:41.471199 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.031 seconds
[0m20:52:41.472197 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:52:41.472604 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b79430>]}
[0m20:52:41.472992 [info ] [Thread-2 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.57s]
[0m20:52:41.473403 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:52:41.473866 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m20:52:41.474325 [info ] [Thread-2 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:52:41.474694 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:52:41.474950 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:52:41.476626 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:52:41.477165 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m20:52:41.517342 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.060 seconds
[0m20:52:41.517668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.078 seconds
[0m20:52:41.518534 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:52:41.519375 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:52:41.520101 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:52:41.520587 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b76ed0>]}
[0m20:52:41.520824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f6390>]}
[0m20:52:41.521128 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.62s]
[0m20:52:41.521607 [info ] [Thread-1 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.58s]
[0m20:52:41.521906 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:41.522214 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:52:41.522458 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:52:41.522629 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:52:41.522930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:52:41.629578 [debug] [Thread-3 (]: SQL status: BEGIN in 0.275 seconds
[0m20:52:41.629945 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.630195 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:52:41.687089 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.057 seconds
[0m20:52:41.689254 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.689512 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:52:41.721933 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:52:41.723647 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.723881 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:52:41.761717 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:52:41.762759 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:52:41.763033 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.763256 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:52:41.794707 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m20:52:41.796479 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:52:41.796869 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:52:41.797134 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:52:41.828017 [debug] [Thread-2 (]: SQL status: BEGIN in 0.305 seconds
[0m20:52:41.828911 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:41.829643 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:52:41.855948 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.058 seconds
[0m20:52:41.857173 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:52:41.857745 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab0470>]}
[0m20:52:41.858181 [info ] [Thread-3 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.52s]
[0m20:52:41.858952 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:52:41.888114 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.058 seconds
[0m20:52:41.891265 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:41.891763 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:52:41.934126 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m20:52:41.945759 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:41.946483 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:52:41.984164 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:52:41.987322 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:52:41.987887 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:41.988197 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:52:42.023915 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m20:52:42.028680 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:52:42.029198 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:52:42.029493 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:52:42.066296 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:52:42.069633 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m20:52:42.070932 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fbd7100-d1b2-4131-8b94-b4b3fc693b2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c39eb0>]}
[0m20:52:42.071964 [info ] [Thread-2 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.60s]
[0m20:52:42.072628 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m20:52:42.073972 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:42.074248 [debug] [MainThread]: On master: BEGIN
[0m20:52:42.074528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:42.379097 [debug] [MainThread]: SQL status: BEGIN in 0.305 seconds
[0m20:52:42.379443 [debug] [MainThread]: On master: COMMIT
[0m20:52:42.379636 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:42.379813 [debug] [MainThread]: On master: COMMIT
[0m20:52:42.407341 [debug] [MainThread]: SQL status: COMMIT in 0.027 seconds
[0m20:52:42.408248 [debug] [MainThread]: On master: Close
[0m20:52:42.409527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:42.409867 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:52:42.410054 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:52:42.410217 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:52:42.410383 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:52:42.410721 [info ] [MainThread]: 
[0m20:52:42.410957 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m20:52:42.412996 [debug] [MainThread]: Command end result
[0m20:52:42.439556 [info ] [MainThread]: 
[0m20:52:42.439978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:42.440223 [info ] [MainThread]: 
[0m20:52:42.440528 [error] [MainThread]:   Database Error in model monthly_revenue_orders (models/marts/sales_reporting/monthly_revenue_orders.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 14:     SUM(order_id) as total_orders
               ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:52:42.440761 [info ] [MainThread]: 
[0m20:52:42.440999 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m20:52:42.442655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.0372434, "process_user_time": 1.570523, "process_kernel_time": 0.225995, "process_mem_max_rss": "127500288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:42.443147 [debug] [MainThread]: Command `dbt run` failed at 20:52:42.443069 after 4.04 seconds
[0m20:52:42.443457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a56cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca7a10>]}
[0m20:52:42.443739 [debug] [MainThread]: Flushing usage events
[0m20:52:42.537028 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:56:34.892278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bed6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451fed0>]}


============================== 20:56:34.895776 | c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d ==============================
[0m20:56:34.895776 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:56:34.896166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:56:34.951019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:56:34.951378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104654510>]}
[0m20:56:35.002393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227ce0>]}
[0m20:56:35.031658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e7a50>]}
[0m20:56:35.032357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:56:35.046249 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:56:35.120471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:56:35.120953 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:56:35.242936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:56:35.249530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104583020>]}
[0m20:56:35.306820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552d0f0>]}
[0m20:56:35.307136 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:56:35.307361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105279710>]}
[0m20:56:35.308619 [info ] [MainThread]: 
[0m20:56:35.309031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:35.311309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:56:35.343932 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:56:35.344164 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:56:35.344319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:35.884609 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.539 seconds
[0m20:56:35.887957 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:56:35.889681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m20:56:35.890057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:56:35.894521 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:56:35.895541 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:56:35.896064 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:56:35.896476 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:56:35.896815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:35.897126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:36.206013 [debug] [ThreadPool]: SQL status: BEGIN in 0.309 seconds
[0m20:56:36.206651 [debug] [ThreadPool]: SQL status: BEGIN in 0.309 seconds
[0m20:56:36.207067 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:56:36.207484 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:56:36.207943 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:36.208453 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:56:36.246101 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m20:56:36.247607 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m20:56:36.250240 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:56:36.251320 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:56:36.282925 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:56:36.286298 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:56:36.296447 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:36.296743 [debug] [MainThread]: On master: BEGIN
[0m20:56:36.296922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:36.601602 [debug] [MainThread]: SQL status: BEGIN in 0.304 seconds
[0m20:56:36.602638 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:36.603571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:36.646931 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m20:56:36.651146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105293ad0>]}
[0m20:56:36.651892 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:36.681614 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:36.683104 [debug] [MainThread]: On master: BEGIN
[0m20:56:36.745387 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m20:56:36.746126 [debug] [MainThread]: On master: COMMIT
[0m20:56:36.746549 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:36.747124 [debug] [MainThread]: On master: COMMIT
[0m20:56:36.777441 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m20:56:36.778325 [debug] [MainThread]: On master: Close
[0m20:56:36.780043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:36.780717 [info ] [MainThread]: 
[0m20:56:36.783781 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:56:36.784081 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:56:36.784328 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:56:36.784743 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:56:36.785294 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:56:36.785637 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:56:36.785987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m20:56:36.786262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m20:56:36.786990 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:56:36.787505 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:56:36.787914 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:56:36.788295 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:56:36.796089 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:56:36.798146 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:56:36.799724 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:56:36.800486 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:56:36.811349 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:56:36.829531 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:56:36.841402 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:56:36.843542 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:56:36.843723 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:56:36.844473 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:36.844761 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:36.844968 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:56:36.845197 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:56:36.845397 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:36.845586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:36.845763 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:56:36.845982 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:56:36.846340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:37.157977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.311 seconds
[0m20:56:37.158504 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:37.158941 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:56:37.166064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.320 seconds
[0m20:56:37.166304 [debug] [Thread-2 (]: SQL status: BEGIN in 0.321 seconds
[0m20:56:37.166557 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:37.166792 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:37.167025 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:56:37.167275 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:56:37.214192 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m20:56:37.221171 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m20:56:37.221436 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m20:56:37.222512 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:37.224685 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:37.226442 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:37.226694 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:56:37.226925 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:56:37.227150 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:56:37.262945 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:56:37.268820 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:37.269579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m20:56:37.269878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m20:56:37.270203 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:56:37.272347 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:37.273986 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:37.274264 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:56:37.274518 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:56:37.306161 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:56:37.306581 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:56:37.306791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:56:37.318429 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:56:37.319350 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:56:37.320266 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:56:37.320520 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:37.320742 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:37.320950 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:37.321147 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:56:37.321346 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:56:37.321539 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:56:37.351492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m20:56:37.351908 [debug] [Thread-3 (]: SQL status: COMMIT in 0.030 seconds
[0m20:56:37.358254 [debug] [Thread-2 (]: SQL status: COMMIT in 0.036 seconds
[0m20:56:37.359018 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:56:37.360447 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:56:37.361703 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:56:37.365445 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:56:37.365962 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:56:37.366393 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:56:37.366680 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:56:37.366954 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:56:37.367216 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:56:37.402351 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:56:37.402654 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:56:37.404461 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:56:37.404797 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.037 seconds
[0m20:56:37.405701 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:56:37.406747 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:56:37.407902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e4520>]}
[0m20:56:37.408429 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.62s]
[0m20:56:37.408752 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106384af0>]}
[0m20:56:37.409153 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:56:37.409425 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105512cc0>]}
[0m20:56:37.409783 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.62s]
[0m20:56:37.410244 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.62s]
[0m20:56:37.410766 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:56:37.411196 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:56:37.411988 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:56:37.412409 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:56:37.412758 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:56:37.413107 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:56:37.413483 [info ] [Thread-2 (]: 7 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:56:37.414014 [info ] [Thread-4 (]: 4 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:56:37.414430 [info ] [Thread-3 (]: 6 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:56:37.414814 [info ] [Thread-1 (]: 5 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:56:37.415235 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m20:56:37.415535 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m20:56:37.415818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m20:56:37.416095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m20:56:37.416366 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:56:37.416652 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:56:37.416909 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:56:37.417150 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:56:37.419683 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:56:37.421691 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:56:37.423662 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.425703 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.426597 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:56:37.426886 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:56:37.427113 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:56:37.434720 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:56:37.445793 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:56:37.446884 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:56:37.448666 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.450395 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.451077 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.451291 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:56:37.451513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:37.451778 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:37.452071 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.452398 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.452605 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:56:37.452819 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:56:37.453033 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:56:37.453256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:56:37.453447 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:56:37.453624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:37.741675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.290 seconds
[0m20:56:37.742180 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.742456 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:56:37.749582 [debug] [Thread-2 (]: SQL status: BEGIN in 0.296 seconds
[0m20:56:37.749881 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.750145 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:56:37.794671 [debug] [Thread-4 (]: SQL status: BEGIN in 0.341 seconds
[0m20:56:37.795116 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:37.795441 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:56:37.797666 [debug] [Thread-3 (]: SQL status: BEGIN in 0.344 seconds
[0m20:56:37.797912 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.798140 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m20:56:37.801603 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.059 seconds
[0m20:56:37.803911 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.804157 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:56:37.814679 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.064 seconds
[0m20:56:37.819355 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.819612 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:56:37.834054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:56:37.838882 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.839141 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:56:37.850367 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:56:37.853141 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.853437 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:56:37.870236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:56:37.877384 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:56:37.877676 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.082 seconds
[0m20:56:37.877939 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.878142 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.080 seconds
[0m20:56:37.879984 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:37.880225 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:56:37.882140 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.882407 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:56:37.882675 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:56:37.885583 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:56:37.886514 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:56:37.886745 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.886939 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:56:37.916668 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:56:37.917692 [debug] [Thread-2 (]: SQL status: COMMIT in 0.030 seconds
[0m20:56:37.918352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m20:56:37.921172 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.921410 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m20:56:37.922586 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:56:37.923916 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:56:37.924148 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:56:37.925678 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:37.927470 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:56:37.927826 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:56:37.928083 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:56:37.928312 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:56:37.928577 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:56:37.965675 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m20:56:37.967155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m20:56:37.969462 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:56:37.970641 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:56:37.971020 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m20:56:37.971369 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:37.971658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.043 seconds
[0m20:56:37.971928 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:37.973121 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:56:37.973634 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:56:37.975323 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:56:37.975722 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:56:37.976544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106376040>]}
[0m20:56:37.976992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c600>]}
[0m20:56:37.977505 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.56s]
[0m20:56:37.978130 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.56s]
[0m20:56:37.978836 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:56:37.979431 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:56:37.979922 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:56:37.980436 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:56:37.980975 [info ] [Thread-2 (]: 8 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:56:37.981412 [info ] [Thread-1 (]: 9 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:56:37.981788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.orders_by_day)
[0m20:56:37.982146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m20:56:37.982396 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:56:37.982617 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:56:37.984341 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:56:37.989568 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:56:37.990361 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:56:37.990667 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:56:37.992702 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:56:38.035792 [debug] [Thread-3 (]: SQL status: COMMIT in 0.060 seconds
[0m20:56:38.036164 [debug] [Thread-4 (]: SQL status: COMMIT in 0.060 seconds
[0m20:56:38.037247 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:56:38.038577 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:56:38.040002 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:56:38.040421 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:38.040760 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:56:38.040962 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.041196 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:56:38.041409 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.041594 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:56:38.041811 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:56:38.042035 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:56:38.042264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:56:38.042464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:38.075660 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.034 seconds
[0m20:56:38.076677 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:56:38.077139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b485f0>]}
[0m20:56:38.077555 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 10[0m in 0.66s]
[0m20:56:38.078033 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:56:38.089135 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.047 seconds
[0m20:56:38.090180 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:56:38.090740 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a833b0>]}
[0m20:56:38.091111 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.68s]
[0m20:56:38.091522 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:56:38.329550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.287 seconds
[0m20:56:38.330051 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.330352 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:56:38.337956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.295 seconds
[0m20:56:38.338854 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.339728 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:56:38.392027 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.061 seconds
[0m20:56:38.396577 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.397058 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:56:38.400775 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.061 seconds
[0m20:56:38.403325 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.403573 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:56:38.431750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:56:38.435439 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.435733 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:56:38.437787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:56:38.439581 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.439834 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:56:38.470589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:56:38.471468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:56:38.474269 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:56:38.475474 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:56:38.476204 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.476751 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.477143 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:56:38.477460 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:56:38.511786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m20:56:38.512102 [debug] [Thread-2 (]: SQL status: COMMIT in 0.034 seconds
[0m20:56:38.513433 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:56:38.515044 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:56:38.515463 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:56:38.515808 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:56:38.516042 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:56:38.516268 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:56:38.553952 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:56:38.554251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.038 seconds
[0m20:56:38.555341 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:56:38.556223 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:56:38.556717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052110d0>]}
[0m20:56:38.557019 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c96f8f-81dd-4fae-86c3-dd74f1e3ec5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104534a10>]}
[0m20:56:38.557426 [info ] [Thread-1 (]: 9 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.57s]
[0m20:56:38.557772 [info ] [Thread-2 (]: 8 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.58s]
[0m20:56:38.558267 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:56:38.558595 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:56:38.559529 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:38.559729 [debug] [MainThread]: On master: BEGIN
[0m20:56:38.559893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:38.857297 [debug] [MainThread]: SQL status: BEGIN in 0.297 seconds
[0m20:56:38.857712 [debug] [MainThread]: On master: COMMIT
[0m20:56:38.857949 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:38.858185 [debug] [MainThread]: On master: COMMIT
[0m20:56:38.889969 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m20:56:38.891593 [debug] [MainThread]: On master: Close
[0m20:56:38.893375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:38.893979 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:56:38.894192 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:56:38.894351 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:56:38.894501 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:56:38.894790 [info ] [MainThread]: 
[0m20:56:38.895016 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m20:56:38.896160 [debug] [MainThread]: Command end result
[0m20:56:38.923232 [info ] [MainThread]: 
[0m20:56:38.923639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:38.923894 [info ] [MainThread]: 
[0m20:56:38.924141 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:56:38.925790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0780144, "process_user_time": 1.55713, "process_kernel_time": 0.219979, "process_mem_max_rss": "128303104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:56:38.926220 [debug] [MainThread]: Command `dbt run` succeeded at 20:56:38.926145 after 4.08 seconds
[0m20:56:38.926515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103203410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106394dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106394a70>]}
[0m20:56:38.926808 [debug] [MainThread]: Flushing usage events
[0m20:56:39.056968 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:56:41.699299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449fed0>]}


============================== 20:56:41.702534 | 4e0d8973-91b8-4064-a41c-b733f478ae2c ==============================
[0m20:56:41.702534 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:56:41.702910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt show --select monthly_revenue_orders --limit=100', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:41.742791 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:56:41.743111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d4510>]}
[0m20:56:41.792128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a7ce0>]}
[0m20:56:41.821100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104267a50>]}
[0m20:56:41.821834 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:56:41.833080 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:56:41.906168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:41.906439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:41.909569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:56:41.930316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8da90>]}
[0m20:56:41.993260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458c210>]}
[0m20:56:41.993605 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:56:41.993779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513aea0>]}
[0m20:56:41.994672 [info ] [MainThread]: 
[0m20:56:41.994998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:41.997492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:56:41.997926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:56:42.031992 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:56:42.032302 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:56:42.032555 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:56:42.032801 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:56:42.033009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:42.033229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:42.321174 [debug] [ThreadPool]: SQL status: BEGIN in 0.288 seconds
[0m20:56:42.321598 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:56:42.321834 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:56:42.355809 [debug] [ThreadPool]: SQL status: BEGIN in 0.323 seconds
[0m20:56:42.356496 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:56:42.357327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m20:56:42.357924 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:42.360810 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:56:42.393880 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:56:42.401095 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.040 seconds
[0m20:56:42.405680 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:56:42.439741 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:56:42.449360 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:42.449634 [debug] [MainThread]: On master: BEGIN
[0m20:56:42.449810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:42.759054 [debug] [MainThread]: SQL status: BEGIN in 0.309 seconds
[0m20:56:42.760609 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:42.761572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:42.803538 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m20:56:42.805168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e0d8973-91b8-4064-a41c-b733f478ae2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a6c90>]}
[0m20:56:42.805501 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:42.834383 [debug] [MainThread]: On master: Close
[0m20:56:42.836460 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:42.837633 [info ] [MainThread]: 
[0m20:56:42.841115 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:56:42.841479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.monthly_revenue_orders)
[0m20:56:42.841722 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:56:42.850823 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:42.851815 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:56:42.858547 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:56:42.858921 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  
  limit 100

[0m20:56:42.859241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:43.161422 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.302 seconds
[0m20:56:43.166557 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:56:43.168482 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:56:43.169873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:43.170194 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:56:43.170459 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m20:56:43.170972 [debug] [MainThread]: Command end result
[0m20:56:43.195041 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| month   | total_orders |
| ------- | ------------ |
| 2024-10 |           53 |
| 2024-09 |           96 |
| 2024-08 |          112 |
| 2024-07 |          104 |
| 2024-06 |           88 |
| 2024-05 |          108 |
| 2024-04 |          104 |
| 2024-03 |          108 |
| 2024-02 |          118 |
| 2024-01 |          109 |

[0m20:56:43.196505 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5402559, "process_user_time": 1.059376, "process_kernel_time": 0.159377, "process_mem_max_rss": "122257408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:56:43.196998 [debug] [MainThread]: Command `dbt show` succeeded at 20:56:43.196922 after 1.54 seconds
[0m20:56:43.197312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105191860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a9bd0>]}
[0m20:56:43.197586 [debug] [MainThread]: Flushing usage events
[0m20:56:43.202451 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:58:07.206606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079efed0>]}


============================== 20:58:07.210011 | b281c18e-f408-449c-ba3f-65b304669370 ==============================
[0m20:58:07.210011 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:58:07.210399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:07.251382 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:58:07.251722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b24510>]}
[0m20:58:07.310002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f7ce0>]}
[0m20:58:07.339060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078efa50>]}
[0m20:58:07.339822 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:58:07.350151 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:58:07.422830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:58:07.423304 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/monthly_revenue_orders.sql
[0m20:58:07.541182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:58:07.547840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a53020>]}
[0m20:58:07.606053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120945010>]}
[0m20:58:07.606342 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:58:07.606513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120871710>]}
[0m20:58:07.607636 [info ] [MainThread]: 
[0m20:58:07.607938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:07.610145 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m20:58:07.642999 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m20:58:07.643281 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m20:58:07.643451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:08.106212 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.463 seconds
[0m20:58:08.107480 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m20:58:08.109713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m20:58:08.110085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:58:08.115341 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:58:08.116770 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:58:08.117069 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:58:08.117269 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:58:08.117442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:08.117616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:08.397526 [debug] [ThreadPool]: SQL status: BEGIN in 0.279 seconds
[0m20:58:08.398644 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:58:08.399195 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:58:08.401001 [debug] [ThreadPool]: SQL status: BEGIN in 0.283 seconds
[0m20:58:08.402010 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:58:08.402553 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:58:08.434107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.031 seconds
[0m20:58:08.434823 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:58:08.437628 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:58:08.438848 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:58:08.466329 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:58:08.467876 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:58:08.474671 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:08.474989 [debug] [MainThread]: On master: BEGIN
[0m20:58:08.475168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:08.753069 [debug] [MainThread]: SQL status: BEGIN in 0.278 seconds
[0m20:58:08.754036 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:08.754747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:08.795827 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m20:58:08.800369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208abad0>]}
[0m20:58:08.800761 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:08.833446 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:08.834317 [debug] [MainThread]: On master: BEGIN
[0m20:58:08.893518 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m20:58:08.895008 [debug] [MainThread]: On master: COMMIT
[0m20:58:08.895632 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:08.896262 [debug] [MainThread]: On master: COMMIT
[0m20:58:08.925888 [debug] [MainThread]: SQL status: COMMIT in 0.029 seconds
[0m20:58:08.926921 [debug] [MainThread]: On master: Close
[0m20:58:08.928491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:08.930040 [info ] [MainThread]: 
[0m20:58:08.933537 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m20:58:08.934100 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m20:58:08.934397 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m20:58:08.934790 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m20:58:08.935208 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_products ................................ [RUN]
[0m20:58:08.935572 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_sales ................................... [RUN]
[0m20:58:08.936018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m20:58:08.936693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m20:58:08.937283 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m20:58:08.937726 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m20:58:08.937972 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m20:58:08.938185 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m20:58:08.945563 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m20:58:08.949066 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m20:58:08.951528 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m20:58:08.952567 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m20:58:08.952961 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m20:58:08.966197 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m20:58:08.987716 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m20:58:08.988964 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m20:58:08.990901 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m20:58:08.991637 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:08.992026 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:08.992311 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m20:58:08.992601 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m20:58:08.992839 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:08.993064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:08.993294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:08.993498 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m20:58:08.993893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:09.264383 [debug] [Thread-1 (]: SQL status: BEGIN in 0.271 seconds
[0m20:58:09.264764 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:09.265007 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m20:58:09.283326 [debug] [Thread-3 (]: SQL status: BEGIN in 0.289 seconds
[0m20:58:09.283643 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:09.283924 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m20:58:09.292381 [debug] [Thread-2 (]: SQL status: BEGIN in 0.299 seconds
[0m20:58:09.293117 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:09.293712 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m20:58:09.309694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.044 seconds
[0m20:58:09.318491 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:09.319059 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:58:09.323715 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.040 seconds
[0m20:58:09.325961 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:09.326209 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:58:09.343587 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m20:58:09.347226 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:09.347477 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m20:58:09.348426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m20:58:09.350032 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:09.350257 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:58:09.359769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:58:09.364079 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:09.364338 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:58:09.382208 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:58:09.386598 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:09.386852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:58:09.387075 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:58:09.398410 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:58:09.398715 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:09.398983 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m20:58:09.399201 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m20:58:09.400080 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:58:09.400334 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:09.400540 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m20:58:09.427666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m20:58:09.431730 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m20:58:09.431996 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:58:09.435437 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m20:58:09.435669 [debug] [Thread-3 (]: SQL status: COMMIT in 0.035 seconds
[0m20:58:09.436567 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:58:09.436804 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m20:58:09.437980 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m20:58:09.438199 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:09.438577 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m20:58:09.438811 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m20:58:09.439031 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m20:58:09.473557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:58:09.476718 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m20:58:09.477111 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m20:58:09.478694 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m20:58:09.478976 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.040 seconds
[0m20:58:09.479323 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m20:58:09.480554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cf64c0>]}
[0m20:58:09.481584 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m20:58:09.481833 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m20:58:09.482229 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.54s]
[0m20:58:09.482911 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m20:58:09.483339 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc14f0>]}
[0m20:58:09.483845 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.55s]
[0m20:58:09.484228 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m20:58:09.484806 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:58:09.485136 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_customer
[0m20:58:09.485476 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m20:58:09.485880 [info ] [Thread-1 (]: 5 of 9 START sql table model public.monthly_revenue_orders ..................... [RUN]
[0m20:58:09.486304 [info ] [Thread-3 (]: 6 of 9 START sql table model public.orders_by_customer ......................... [RUN]
[0m20:58:09.486695 [info ] [Thread-4 (]: 4 of 9 START sql table model public.customer_lifetime_value .................... [RUN]
[0m20:58:09.487124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m20:58:09.487484 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.orders_by_customer)
[0m20:58:09.487885 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m20:58:09.488199 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:58:09.488487 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m20:58:09.488768 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m20:58:09.491058 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.492695 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m20:58:09.494655 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m20:58:09.495480 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:58:09.495833 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m20:58:09.496134 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m20:58:09.512293 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.514330 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m20:58:09.516589 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m20:58:09.517145 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m20:58:09.518187 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m20:58:09.518482 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.518845 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m20:58:09.519081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:09.519370 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cf23d0>]}
[0m20:58:09.519628 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:09.519964 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:09.520332 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.58s]
[0m20:58:09.520601 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m20:58:09.520817 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m20:58:09.521125 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m20:58:09.521318 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.521500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:09.521778 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_day
[0m20:58:09.522369 [info ] [Thread-2 (]: 7 of 9 START sql table model public.orders_by_day .............................. [RUN]
[0m20:58:09.522700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_day)
[0m20:58:09.522936 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m20:58:09.524436 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m20:58:09.524946 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_day
[0m20:58:09.526905 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m20:58:09.527288 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:09.527471 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m20:58:09.527636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:09.788642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.269 seconds
[0m20:58:09.789017 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.789333 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m20:58:09.801094 [debug] [Thread-4 (]: SQL status: BEGIN in 0.280 seconds
[0m20:58:09.801355 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:09.801595 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m20:58:09.811751 [debug] [Thread-3 (]: SQL status: BEGIN in 0.290 seconds
[0m20:58:09.812059 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:09.812345 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m20:58:09.832156 [debug] [Thread-2 (]: SQL status: BEGIN in 0.304 seconds
[0m20:58:09.832381 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:09.832599 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m20:58:09.849313 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.059 seconds
[0m20:58:09.854849 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.855108 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m20:58:09.882958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:58:09.886511 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.886800 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m20:58:09.939594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.052 seconds
[0m20:58:09.947470 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:58:09.948092 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:09.948497 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m20:58:09.966676 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.165 seconds
[0m20:58:09.969304 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:09.969659 [debug] [Thread-2 (]: SQL status: SELECT 282 in 0.137 seconds
[0m20:58:09.970088 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m20:58:09.972521 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:09.972865 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.160 seconds
[0m20:58:09.973214 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m20:58:09.975023 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:09.975320 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m20:58:10.008501 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m20:58:10.010563 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:10.010782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m20:58:10.010976 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m20:58:10.012603 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:10.012905 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m20:58:10.015269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.066 seconds
[0m20:58:10.015546 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m20:58:10.016784 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m20:58:10.018292 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:10.019904 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:10.020386 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m20:58:10.020813 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m20:58:10.043398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:58:10.044553 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:58:10.044783 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:10.044965 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m20:58:10.045155 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m20:58:10.045948 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:58:10.046147 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:10.046317 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m20:58:10.051180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m20:58:10.052554 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:58:10.052773 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:10.052969 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m20:58:10.056360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m20:58:10.057251 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:58:10.057764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122052740>]}
[0m20:58:10.058160 [info ] [Thread-1 (]: 5 of 9 OK created sql table model public.monthly_revenue_orders ................ [[32mSELECT 10[0m in 0.57s]
[0m20:58:10.058684 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:58:10.058975 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m20:58:10.059448 [info ] [Thread-1 (]: 8 of 9 START sql table model public.product_performance ........................ [RUN]
[0m20:58:10.059806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m20:58:10.060025 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m20:58:10.061593 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m20:58:10.062031 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m20:58:10.066517 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m20:58:10.066919 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.067317 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m20:58:10.067681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:10.086292 [debug] [Thread-4 (]: SQL status: COMMIT in 0.041 seconds
[0m20:58:10.087936 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m20:58:10.088356 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m20:58:10.088601 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m20:58:10.097294 [debug] [Thread-3 (]: SQL status: COMMIT in 0.044 seconds
[0m20:58:10.098855 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m20:58:10.099194 [debug] [Thread-2 (]: SQL status: COMMIT in 0.053 seconds
[0m20:58:10.099661 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m20:58:10.137259 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.048 seconds
[0m20:58:10.138052 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m20:58:10.138303 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m20:58:10.139076 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m20:58:10.139355 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m20:58:10.139712 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m20:58:10.140102 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202fd0d0>]}
[0m20:58:10.140549 [info ] [Thread-4 (]: 4 of 9 OK created sql table model public.customer_lifetime_value ............... [[32mSELECT 642[0m in 0.65s]
[0m20:58:10.140900 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m20:58:10.141148 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m20:58:10.141468 [info ] [Thread-4 (]: 9 of 9 START sql table model public.category_performance ....................... [RUN]
[0m20:58:10.141745 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.category_performance)
[0m20:58:10.141951 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m20:58:10.143548 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m20:58:10.144080 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m20:58:10.145996 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m20:58:10.146472 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.146651 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m20:58:10.146810 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:10.173826 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:58:10.174988 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_day: Close
[0m20:58:10.175428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a11670>]}
[0m20:58:10.175769 [info ] [Thread-2 (]: 7 of 9 OK created sql table model public.orders_by_day ......................... [[32mSELECT 282[0m in 0.65s]
[0m20:58:10.176053 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.036 seconds
[0m20:58:10.176384 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_day
[0m20:58:10.177137 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_customer: Close
[0m20:58:10.177565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a13830>]}
[0m20:58:10.177865 [info ] [Thread-3 (]: 6 of 9 OK created sql table model public.orders_by_customer .................... [[32mSELECT 642[0m in 0.69s]
[0m20:58:10.178145 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m20:58:10.351708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.284 seconds
[0m20:58:10.352128 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.352385 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m20:58:10.400370 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.048 seconds
[0m20:58:10.402591 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.402870 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m20:58:10.420585 [debug] [Thread-4 (]: SQL status: BEGIN in 0.274 seconds
[0m20:58:10.420832 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.421057 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m20:58:10.436043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:58:10.440163 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.440438 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:58:10.473190 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.051 seconds
[0m20:58:10.474098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m20:58:10.476891 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.478397 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:58:10.478660 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m20:58:10.478887 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.479166 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m20:58:10.510179 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m20:58:10.519870 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.520133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m20:58:10.520353 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m20:58:10.521562 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m20:58:10.521946 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m20:58:10.522281 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m20:58:10.549472 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m20:58:10.553220 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:58:10.553890 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.554439 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m20:58:10.560900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m20:58:10.563832 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m20:58:10.564627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220a0770>]}
[0m20:58:10.565069 [info ] [Thread-1 (]: 8 of 9 OK created sql table model public.product_performance ................... [[32mSELECT 4[0m in 0.50s]
[0m20:58:10.565497 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m20:58:10.596787 [debug] [Thread-4 (]: SQL status: COMMIT in 0.042 seconds
[0m20:58:10.599443 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m20:58:10.599942 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m20:58:10.600203 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m20:58:10.633872 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.033 seconds
[0m20:58:10.637173 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m20:58:10.639028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b281c18e-f408-449c-ba3f-65b304669370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202fc410>]}
[0m20:58:10.639540 [info ] [Thread-4 (]: 9 of 9 OK created sql table model public.category_performance .................. [[32mSELECT 2[0m in 0.50s]
[0m20:58:10.640329 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m20:58:10.641684 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:10.641953 [debug] [MainThread]: On master: BEGIN
[0m20:58:10.642131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:10.944982 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m20:58:10.945838 [debug] [MainThread]: On master: COMMIT
[0m20:58:10.946276 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:10.946800 [debug] [MainThread]: On master: COMMIT
[0m20:58:10.987539 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m20:58:10.988213 [debug] [MainThread]: On master: Close
[0m20:58:10.988684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:10.988881 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m20:58:10.989049 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m20:58:10.989227 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m20:58:10.989374 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m20:58:10.989623 [info ] [MainThread]: 
[0m20:58:10.989831 [info ] [MainThread]: Finished running 3 view models, 6 table models in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m20:58:10.990979 [debug] [MainThread]: Command end result
[0m20:58:11.008712 [info ] [MainThread]: 
[0m20:58:11.009014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:11.009189 [info ] [MainThread]: 
[0m20:58:11.009363 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m20:58:11.010647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8454096, "process_user_time": 1.513978, "process_kernel_time": 0.200855, "process_mem_max_rss": "125796352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:11.011052 [debug] [MainThread]: Command `dbt run` succeeded at 20:58:11.010990 after 3.85 seconds
[0m20:58:11.011273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221a7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1221a7a70>]}
[0m20:58:11.011476 [debug] [MainThread]: Flushing usage events
[0m20:58:11.129799 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m20:58:13.919491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb3ed0>]}


============================== 20:58:13.922279 | b9152d75-257d-41a8-a977-51c156f3f8fa ==============================
[0m20:58:13.922279 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:58:13.922694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt show --select monthly_revenue_orders --limit=100', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:58:13.961495 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:58:13.961801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de8510>]}
[0m20:58:14.011562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f7ce0>]}
[0m20:58:14.041578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb3a50>]}
[0m20:58:14.042198 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:58:14.052266 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:58:14.116261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:14.116528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:14.119359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:58:14.140994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a5a90>]}
[0m20:58:14.197721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da0210>]}
[0m20:58:14.198019 [info ] [MainThread]: Found 9 models, 1 snapshot, 3 sources, 424 macros
[0m20:58:14.198195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a6ea0>]}
[0m20:58:14.199148 [info ] [MainThread]: 
[0m20:58:14.199549 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:14.201925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m20:58:14.203151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m20:58:14.232293 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:58:14.232619 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:58:14.232796 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m20:58:14.232954 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m20:58:14.233195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:14.233356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:14.508692 [debug] [ThreadPool]: SQL status: BEGIN in 0.275 seconds
[0m20:58:14.509176 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m20:58:14.509420 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:58:14.513650 [debug] [ThreadPool]: SQL status: BEGIN in 0.280 seconds
[0m20:58:14.513895 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m20:58:14.514109 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:58:14.540770 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.031 seconds
[0m20:58:14.543968 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m20:58:14.549018 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m20:58:14.552134 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m20:58:14.573176 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m20:58:14.577825 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m20:58:14.586777 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:14.587022 [debug] [MainThread]: On master: BEGIN
[0m20:58:14.587203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:14.859609 [debug] [MainThread]: SQL status: BEGIN in 0.271 seconds
[0m20:58:14.864471 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:14.864984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:14.905760 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m20:58:14.907322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9152d75-257d-41a8-a977-51c156f3f8fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0ec90>]}
[0m20:58:14.907603 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:14.933783 [debug] [MainThread]: On master: Close
[0m20:58:14.936012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:14.937016 [info ] [MainThread]: 
[0m20:58:14.940530 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m20:58:14.940924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.monthly_revenue_orders)
[0m20:58:14.941349 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m20:58:14.951080 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:14.952300 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m20:58:14.959311 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m20:58:14.959770 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
  SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  
  limit 100

[0m20:58:14.960034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:15.229014 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.269 seconds
[0m20:58:15.233245 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m20:58:15.234757 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m20:58:15.235748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:15.235988 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m20:58:15.236169 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m20:58:15.236606 [debug] [MainThread]: Command end result
[0m20:58:15.256971 [info ] [MainThread]: Previewing node 'monthly_revenue_orders':
| month   | total_orders | total_revenue |
| ------- | ------------ | ------------- |
| 2024-10 |           53 |     27,083.04 |
| 2024-09 |           96 |     49,950.94 |
| 2024-08 |          112 |     63,272.30 |
| 2024-07 |          104 |     54,192.03 |
| 2024-06 |           88 |     44,933.60 |
| 2024-05 |          108 |     54,909.71 |
| 2024-04 |          104 |     49,690.09 |
| 2024-03 |          108 |     53,449.94 |
| 2024-02 |          118 |     61,949.98 |
| 2024-01 |          109 |     59,619.89 |

[0m20:58:15.258559 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.3794746, "process_user_time": 1.036751, "process_kernel_time": 0.145844, "process_mem_max_rss": "120864768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:58:15.259096 [debug] [MainThread]: Command `dbt show` succeeded at 20:58:15.259008 after 1.38 seconds
[0m20:58:15.259441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f9860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d15bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d15b30>]}
[0m20:58:15.259762 [debug] [MainThread]: Flushing usage events
[0m20:58:15.264447 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:14:34.952164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b3ed0>]}


============================== 21:14:34.955539 | ee54fced-2977-41ea-836b-a219d673c796 ==============================
[0m21:14:34.955539 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:14:34.955990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:14:35.039737 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:14:35.040050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ec510>]}
[0m21:14:35.096557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f7ce0>]}
[0m21:14:35.124790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b3a50>]}
[0m21:14:35.125503 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:14:35.140275 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:14:35.215789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:14:35.216210 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models/marts/sales_reporting/customer_order_frequency.sql
[0m21:14:35.337785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:14:35.344492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111716f30>]}
[0m21:14:35.402612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e9010>]}
[0m21:14:35.402931 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:14:35.403112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123158b0>]}
[0m21:14:35.404374 [info ] [MainThread]: 
[0m21:14:35.404723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:35.406834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:14:35.453290 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:14:35.453527 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:14:35.453684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:36.113853 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.660 seconds
[0m21:14:36.117833 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:14:36.120024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m21:14:36.124255 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:14:36.124746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:14:36.125250 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:14:36.127269 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:14:36.127665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:36.128015 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:14:36.128514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:36.415983 [debug] [ThreadPool]: SQL status: BEGIN in 0.288 seconds
[0m21:14:36.416326 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:14:36.416530 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:14:36.448318 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.031 seconds
[0m21:14:36.452460 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:14:36.453288 [debug] [ThreadPool]: SQL status: BEGIN in 0.325 seconds
[0m21:14:36.453509 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:14:36.453707 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:14:36.484346 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:14:36.488257 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.034 seconds
[0m21:14:36.491544 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:14:36.520474 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:14:36.526541 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:36.526796 [debug] [MainThread]: On master: BEGIN
[0m21:14:36.526975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:36.851787 [debug] [MainThread]: SQL status: BEGIN in 0.324 seconds
[0m21:14:36.853074 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:36.853814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:36.900367 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m21:14:36.905296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123377d0>]}
[0m21:14:36.905688 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:36.939008 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:36.940098 [debug] [MainThread]: On master: BEGIN
[0m21:14:37.010228 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m21:14:37.010576 [debug] [MainThread]: On master: COMMIT
[0m21:14:37.010771 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:37.010954 [debug] [MainThread]: On master: COMMIT
[0m21:14:37.046478 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m21:14:37.047137 [debug] [MainThread]: On master: Close
[0m21:14:37.048646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:37.049290 [info ] [MainThread]: 
[0m21:14:37.052629 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:14:37.052953 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:14:37.053140 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:14:37.053410 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_products ............................... [RUN]
[0m21:14:37.053877 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m21:14:37.054176 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m21:14:37.054726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m21:14:37.055534 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:14:37.056106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m21:14:37.056553 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:14:37.056784 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:14:37.056972 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:14:37.063638 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:14:37.065400 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:14:37.066636 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:14:37.067274 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:14:37.067524 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:14:37.074148 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:14:37.103087 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:14:37.105668 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:14:37.106064 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:14:37.106894 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.107162 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.107377 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:14:37.107578 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.107803 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:14:37.108020 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:14:37.108237 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:14:37.108501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:37.108850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:37.414062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.305 seconds
[0m21:14:37.415410 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.416090 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:14:37.422572 [debug] [Thread-3 (]: SQL status: BEGIN in 0.314 seconds
[0m21:14:37.423380 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.424044 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:14:37.430463 [debug] [Thread-2 (]: SQL status: BEGIN in 0.321 seconds
[0m21:14:37.431305 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.432278 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:14:37.462558 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m21:14:37.470484 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m21:14:37.470923 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.473212 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.473504 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:14:37.473741 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:14:37.481752 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m21:14:37.483617 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.483902 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:14:37.504835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:14:37.506719 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.506963 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:14:37.507183 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:14:37.509696 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.510342 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:14:37.514514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:14:37.516469 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.516738 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:14:37.540685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:14:37.549182 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m21:14:37.553043 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:14:37.554020 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:14:37.554237 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:14:37.554462 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.554672 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.555487 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:14:37.555713 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:14:37.555914 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:14:37.556109 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.556392 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:14:37.589556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m21:14:37.594016 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:14:37.594286 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m21:14:37.594512 [debug] [Thread-2 (]: SQL status: COMMIT in 0.038 seconds
[0m21:14:37.597654 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:14:37.598950 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:14:37.600091 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:14:37.600323 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:14:37.600640 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:14:37.600937 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:14:37.601195 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:14:37.601428 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:14:37.639397 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.038 seconds
[0m21:14:37.639628 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m21:14:37.641196 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:14:37.641431 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.040 seconds
[0m21:14:37.642303 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:14:37.643143 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:14:37.644124 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127949f0>]}
[0m21:14:37.644405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139a8af0>]}
[0m21:14:37.645160 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11392ea80>]}
[0m21:14:37.644879 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.59s]
[0m21:14:37.645722 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.59s]
[0m21:14:37.646403 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.59s]
[0m21:14:37.646818 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:14:37.647191 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:14:37.647829 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:14:37.648749 [debug] [Thread-2 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:14:37.649154 [info ] [Thread-2 (]: 7 of 10 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:14:37.649483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.monthly_revenue_orders)
[0m21:14:37.649717 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:14:37.652470 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:37.652880 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:14:37.653157 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m21:14:37.653405 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:14:37.653869 [info ] [Thread-3 (]: 5 of 10 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:14:37.654193 [info ] [Thread-4 (]: 4 of 10 START sql table model public.category_performance ...................... [RUN]
[0m21:14:37.654591 [info ] [Thread-1 (]: 6 of 10 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:14:37.654993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.customer_lifetime_value)
[0m21:14:37.655399 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m21:14:37.655743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_order_frequency)
[0m21:14:37.656029 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:14:37.656260 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:14:37.656492 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:14:37.656707 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:14:37.670785 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:14:37.675395 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:37.677140 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:14:37.678494 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:14:37.679419 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:14:37.679719 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:14:37.680046 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:37.680304 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m21:14:37.682757 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:14:37.684407 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:14:37.684715 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:14:37.686548 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:14:37.686916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:14:37.687456 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:14:37.687708 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:14:37.687894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:37.688103 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:37.688341 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:37.688588 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:14:37.688783 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:14:37.688981 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:14:37.689194 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:37.992196 [debug] [Thread-4 (]: SQL status: BEGIN in 0.303 seconds
[0m21:14:37.992558 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:37.992842 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:14:38.012698 [debug] [Thread-3 (]: SQL status: BEGIN in 0.323 seconds
[0m21:14:38.013094 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:38.013351 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:14:38.026614 [debug] [Thread-2 (]: SQL status: BEGIN in 0.340 seconds
[0m21:14:38.026918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.339 seconds
[0m21:14:38.027181 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:38.027431 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:14:38.027656 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:14:38.027904 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(date) as first_order,
    MAX(date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:14:38.044808 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.051 seconds
[0m21:14:38.048689 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:38.048958 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:14:38.074693 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_id" does not exist
LINE 14:     COUNT(order_id) as total_orders,
                   ^

[0m21:14:38.075450 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: ROLLBACK
[0m21:14:38.080671 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.067 seconds
[0m21:14:38.081256 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:14:38.085776 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:38.086077 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.058 seconds
[0m21:14:38.087983 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:38.088245 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:14:38.090105 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:38.090441 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:14:38.090773 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:14:38.106612 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:14:38.113618 [debug] [Thread-1 (]: Database Error in model customer_order_frequency (models/marts/sales_reporting/customer_order_frequency.sql)
  column "order_id" does not exist
  LINE 14:     COUNT(order_id) as total_orders,
                     ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_order_frequency.sql
[0m21:14:38.114006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113981cc0>]}
[0m21:14:38.114430 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model public.customer_order_frequency ......... [[31mERROR[0m in 0.46s]
[0m21:14:38.114826 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:14:38.115119 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:14:38.115995 [info ] [Thread-1 (]: 8 of 10 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:14:38.116327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.orders_by_customer)
[0m21:14:38.116581 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:14:38.119388 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:14:38.120113 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:14:38.120496 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:14:38.123542 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:14:38.123962 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:14:38.124254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:14:38.127974 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:14:38.129790 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:38.131998 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:38.132355 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:38.133099 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:14:38.133372 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.133624 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:14:38.136793 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:14:38.137244 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:14:38.137570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:14:38.169183 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:14:38.170346 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:14:38.170611 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:14:38.170850 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:38.171763 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:14:38.172018 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:14:38.172243 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:38.172492 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:14:38.172930 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m21:14:38.174261 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:14:38.176291 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:14:38.176563 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:14:38.213864 [debug] [Thread-3 (]: SQL status: COMMIT in 0.041 seconds
[0m21:14:38.215364 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:14:38.215612 [debug] [Thread-2 (]: SQL status: COMMIT in 0.043 seconds
[0m21:14:38.215952 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:14:38.256573 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.080 seconds
[0m21:14:38.257551 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:14:38.257830 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:14:38.258742 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m21:14:38.259062 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:14:38.259337 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:14:38.259638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279b2f0>]}
[0m21:14:38.260007 [info ] [Thread-4 (]: 4 of 10 OK created sql table model public.category_performance ................. [[32mSELECT 2[0m in 0.60s]
[0m21:14:38.260322 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m21:14:38.260535 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:14:38.260822 [info ] [Thread-4 (]: 9 of 10 START sql table model public.orders_by_day ............................. [RUN]
[0m21:14:38.261039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.orders_by_day)
[0m21:14:38.261219 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:14:38.262718 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:14:38.263224 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:14:38.265053 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:14:38.265387 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.265557 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:14:38.265712 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:14:38.301757 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.042 seconds
[0m21:14:38.302872 [debug] [Thread-3 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:14:38.303337 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122254f0>]}
[0m21:14:38.303723 [info ] [Thread-3 (]: 5 of 10 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.65s]
[0m21:14:38.304058 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:14:38.304293 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m21:14:38.304596 [info ] [Thread-3 (]: 10 of 10 START sql table model public.product_performance ...................... [RUN]
[0m21:14:38.304880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.product_performance)
[0m21:14:38.305101 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:14:38.305313 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:14:38.306079 [debug] [Thread-2 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:14:38.307532 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:14:38.308002 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b93ad0>]}
[0m21:14:38.308523 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m21:14:38.310160 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:14:38.308347 [info ] [Thread-2 (]: 7 of 10 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.66s]
[0m21:14:38.310785 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:14:38.311164 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.311404 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:14:38.311581 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:14:38.443958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.306 seconds
[0m21:14:38.444338 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.444593 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:14:38.500826 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.056 seconds
[0m21:14:38.504056 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.504482 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:14:38.532601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:14:38.534699 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.535010 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:14:38.544040 [debug] [Thread-4 (]: SQL status: BEGIN in 0.278 seconds
[0m21:14:38.544365 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.544718 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:14:38.568000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:14:38.568946 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:14:38.569211 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.569432 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:14:38.596181 [debug] [Thread-3 (]: SQL status: BEGIN in 0.285 seconds
[0m21:14:38.596432 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.596718 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:14:38.598688 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.054 seconds
[0m21:14:38.600531 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.600773 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:14:38.606534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m21:14:38.608097 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:14:38.608438 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:14:38.608663 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:14:38.633241 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:14:38.638637 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.638892 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:14:38.645381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m21:14:38.648075 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:14:38.649781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112aec90>]}
[0m21:14:38.650356 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.53s]
[0m21:14:38.650721 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:14:38.658771 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.062 seconds
[0m21:14:38.661427 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.661984 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:14:38.668743 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:14:38.669796 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:14:38.670045 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.670263 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:14:38.692465 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:14:38.697567 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.697811 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:14:38.703074 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m21:14:38.705290 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:14:38.705627 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:14:38.705836 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:14:38.732558 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:14:38.735759 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:14:38.736582 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.737479 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:14:38.744563 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.038 seconds
[0m21:14:38.745754 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:14:38.746352 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11279b110>]}
[0m21:14:38.746807 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.49s]
[0m21:14:38.747198 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:14:38.762761 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m21:14:38.764284 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:14:38.765461 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:14:38.765933 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:14:38.803628 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.037 seconds
[0m21:14:38.806554 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m21:14:38.808253 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee54fced-2977-41ea-836b-a219d673c796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122a8b30>]}
[0m21:14:38.809001 [info ] [Thread-3 (]: 10 of 10 OK created sql table model public.product_performance ................. [[32mSELECT 4[0m in 0.50s]
[0m21:14:38.809534 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m21:14:38.810510 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:38.810931 [debug] [MainThread]: On master: BEGIN
[0m21:14:38.811334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:39.120615 [debug] [MainThread]: SQL status: BEGIN in 0.309 seconds
[0m21:14:39.121612 [debug] [MainThread]: On master: COMMIT
[0m21:14:39.122479 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:39.123100 [debug] [MainThread]: On master: COMMIT
[0m21:14:39.156378 [debug] [MainThread]: SQL status: COMMIT in 0.033 seconds
[0m21:14:39.157069 [debug] [MainThread]: On master: Close
[0m21:14:39.158118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:39.158557 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m21:14:39.158919 [debug] [MainThread]: Connection 'model.ecommerce_project.monthly_revenue_orders' was properly closed.
[0m21:14:39.159278 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:14:39.159710 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:14:39.160282 [info ] [MainThread]: 
[0m21:14:39.160845 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m21:14:39.163780 [debug] [MainThread]: Command end result
[0m21:14:39.191678 [info ] [MainThread]: 
[0m21:14:39.192041 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:14:39.192283 [info ] [MainThread]: 
[0m21:14:39.192581 [error] [MainThread]:   Database Error in model customer_order_frequency (models/marts/sales_reporting/customer_order_frequency.sql)
  column "order_id" does not exist
  LINE 14:     COUNT(order_id) as total_orders,
                     ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_order_frequency.sql
[0m21:14:39.192817 [info ] [MainThread]: 
[0m21:14:39.193048 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:14:39.194679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2865386, "process_user_time": 1.578329, "process_kernel_time": 0.263828, "process_mem_max_rss": "125665280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:14:39.195041 [debug] [MainThread]: Command `dbt run` failed at 21:14:39.194976 after 4.29 seconds
[0m21:14:39.195298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bcb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bcb950>]}
[0m21:14:39.195529 [debug] [MainThread]: Flushing usage events
[0m21:14:39.406779 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:15:40.400960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefed0>]}


============================== 21:15:40.403511 | 70182ffa-5b45-4a01-a320-3298484d9742 ==============================
[0m21:15:40.403511 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:15:40.403890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:15:40.441741 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:15:40.442122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ec510>]}
[0m21:15:40.491083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf7ce0>]}
[0m21:15:40.520225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108defa50>]}
[0m21:15:40.520869 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:15:40.530915 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:15:40.595575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:15:40.596034 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/customer_order_frequency.sql
[0m21:15:40.713604 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:15:40.720385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091172f0>]}
[0m21:15:40.771143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8490f0>]}
[0m21:15:40.771458 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:15:40.771633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a365570>]}
[0m21:15:40.772838 [info ] [MainThread]: 
[0m21:15:40.773233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:40.775457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:15:40.803534 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:15:40.803777 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:15:40.803941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:41.358138 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.554 seconds
[0m21:15:41.361388 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:15:41.363645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m21:15:41.364212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:15:41.368413 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:15:41.369406 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:15:41.369617 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:15:41.369797 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:15:41.370011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:41.370238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:41.673459 [debug] [ThreadPool]: SQL status: BEGIN in 0.303 seconds
[0m21:15:41.674862 [debug] [ThreadPool]: SQL status: BEGIN in 0.305 seconds
[0m21:15:41.675405 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:15:41.675955 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:15:41.676713 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:15:41.677489 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:15:41.713394 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m21:15:41.714806 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.037 seconds
[0m21:15:41.718196 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:15:41.719603 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:15:41.748818 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:15:41.750705 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:15:41.759836 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:41.760066 [debug] [MainThread]: On master: BEGIN
[0m21:15:41.760241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:42.070947 [debug] [MainThread]: SQL status: BEGIN in 0.310 seconds
[0m21:15:42.071874 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:42.072757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:42.114271 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m21:15:42.119146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a3ad0>]}
[0m21:15:42.119572 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:42.153035 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:42.153794 [debug] [MainThread]: On master: BEGIN
[0m21:15:42.241227 [debug] [MainThread]: SQL status: BEGIN in 0.087 seconds
[0m21:15:42.242635 [debug] [MainThread]: On master: COMMIT
[0m21:15:42.243082 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:42.243517 [debug] [MainThread]: On master: COMMIT
[0m21:15:42.276415 [debug] [MainThread]: SQL status: COMMIT in 0.032 seconds
[0m21:15:42.277562 [debug] [MainThread]: On master: Close
[0m21:15:42.279285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:42.279982 [info ] [MainThread]: 
[0m21:15:42.283341 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:15:42.283716 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:15:42.284352 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:15:42.285144 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m21:15:42.285756 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m21:15:42.286111 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_products ............................... [RUN]
[0m21:15:42.286442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m21:15:42.286763 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:15:42.286990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m21:15:42.287210 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:15:42.287420 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:15:42.287608 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:15:42.295416 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:15:42.297904 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:15:42.300252 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:15:42.301201 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:15:42.301607 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:15:42.301885 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:15:42.337099 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:15:42.339199 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:15:42.340131 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:15:42.340973 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.341266 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:15:42.341509 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.341758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:42.342009 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.342229 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:15:42.342566 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:15:42.342762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:15:42.342947 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:42.652187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.310 seconds
[0m21:15:42.652584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.310 seconds
[0m21:15:42.652854 [debug] [Thread-3 (]: SQL status: BEGIN in 0.310 seconds
[0m21:15:42.653072 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.653287 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.653499 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.653718 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:15:42.653955 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:15:42.654183 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:15:42.703765 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m21:15:42.714350 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.714943 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m21:15:42.715365 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.061 seconds
[0m21:15:42.715746 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:15:42.718326 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.720246 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.720531 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:15:42.720760 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:15:42.748341 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:15:42.749984 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.750228 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:15:42.756481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:15:42.758273 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.758545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:15:42.758763 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:15:42.760318 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.760596 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:15:42.784478 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:15:42.796144 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:15:42.796446 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:15:42.796697 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.796946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:15:42.797794 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:15:42.798020 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:15:42.798833 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:15:42.799077 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.799342 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.799579 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:15:42.799779 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:15:42.829959 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m21:15:42.830373 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m21:15:42.834693 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:15:42.834938 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m21:15:42.836132 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:15:42.839356 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:15:42.840527 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:15:42.840847 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:15:42.841066 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:15:42.841365 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:15:42.841572 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:15:42.841815 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:15:42.878207 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.036 seconds
[0m21:15:42.878440 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.037 seconds
[0m21:15:42.880030 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:15:42.880255 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m21:15:42.881076 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:15:42.881939 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:15:42.883004 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab3c940>]}
[0m21:15:42.883289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea87d0>]}
[0m21:15:42.883718 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.60s]
[0m21:15:42.884026 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8263c0>]}
[0m21:15:42.884409 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.60s]
[0m21:15:42.885059 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:15:42.885764 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.60s]
[0m21:15:42.886368 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:15:42.887034 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:15:42.887287 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:15:42.887530 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:15:42.887773 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:15:42.888022 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:15:42.888385 [info ] [Thread-4 (]: 4 of 10 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:15:42.888673 [info ] [Thread-3 (]: 5 of 10 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:15:42.888938 [info ] [Thread-1 (]: 6 of 10 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:15:42.889200 [info ] [Thread-2 (]: 7 of 10 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:15:42.889543 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m21:15:42.889783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.customer_order_frequency)
[0m21:15:42.890060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m21:15:42.890595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m21:15:42.890966 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:15:42.891304 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:15:42.891585 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:15:42.891849 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:15:42.894666 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:15:42.896695 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:15:42.898616 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:42.900655 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:15:42.901445 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:15:42.907768 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:15:42.908047 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:15:42.918340 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:15:42.918693 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:15:42.921067 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:15:42.922924 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:42.925219 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:15:42.925704 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:42.925928 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:15:42.926166 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:15:42.926496 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:42.926805 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:15:42.927053 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:42.927252 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:15:42.927505 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:15:42.927719 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:15:42.927913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:42.928101 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:42.928306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:43.228048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.300 seconds
[0m21:15:43.228406 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:43.228651 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:15:43.235846 [debug] [Thread-3 (]: SQL status: BEGIN in 0.308 seconds
[0m21:15:43.236115 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:15:43.236364 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(date) as first_order,
    MAX(date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:15:43.245878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m21:15:43.246096 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:43.246324 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:15:43.254362 [debug] [Thread-4 (]: SQL status: BEGIN in 0.328 seconds
[0m21:15:43.254635 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:43.254863 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:15:43.271107 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 15:     MIN(date) as first_order,
                 ^

[0m21:15:43.272358 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: ROLLBACK
[0m21:15:43.287572 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.058 seconds
[0m21:15:43.295511 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:43.295777 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:15:43.303395 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.056 seconds
[0m21:15:43.307231 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:43.307508 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:15:43.309224 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:15:43.313578 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.058 seconds
[0m21:15:43.314276 [debug] [Thread-3 (]: Database Error in model customer_order_frequency (models/marts/sales_reporting/customer_order_frequency.sql)
  column "date" does not exist
  LINE 15:     MIN(date) as first_order,
                   ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_order_frequency.sql
[0m21:15:43.316384 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:43.316681 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af416a0>]}
[0m21:15:43.316930 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:15:43.317315 [error] [Thread-3 (]: 5 of 10 ERROR creating sql table model public.customer_order_frequency ......... [[31mERROR[0m in 0.43s]
[0m21:15:43.317780 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:15:43.318083 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:15:43.318908 [info ] [Thread-3 (]: 8 of 10 START sql table model public.orders_by_day ............................. [RUN]
[0m21:15:43.319184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.orders_by_day)
[0m21:15:43.319434 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:15:43.320986 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:15:43.321537 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:15:43.324444 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:15:43.324916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:15:43.327591 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:43.327982 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:15:43.328370 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.328620 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:15:43.328830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:43.343322 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:15:43.345527 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:43.345889 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:15:43.351020 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:15:43.353151 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:43.353438 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:15:43.356138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:15:43.360260 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:15:43.360604 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:43.360842 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:15:43.382429 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:15:43.383631 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:15:43.383884 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:43.384095 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:15:43.391466 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m21:15:43.392347 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:15:43.392564 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:43.392764 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:15:43.399645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m21:15:43.401007 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:15:43.403106 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:15:43.403370 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:15:43.415500 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m21:15:43.416723 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:15:43.417049 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:15:43.417331 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:15:43.431863 [debug] [Thread-4 (]: SQL status: COMMIT in 0.039 seconds
[0m21:15:43.436283 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:15:43.436661 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:15:43.436896 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:15:43.439296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m21:15:43.440245 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:15:43.440675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae89cd0>]}
[0m21:15:43.441076 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.55s]
[0m21:15:43.441484 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:15:43.441723 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m21:15:43.442064 [info ] [Thread-1 (]: 9 of 10 START sql table model public.product_performance ....................... [RUN]
[0m21:15:43.442345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m21:15:43.442565 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:15:43.444077 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:15:43.444708 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m21:15:43.484282 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.067 seconds
[0m21:15:43.484745 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:15:43.484962 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.048 seconds
[0m21:15:43.485755 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:15:43.486669 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:15:43.487107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8fb0>]}
[0m21:15:43.487427 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:43.487762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fef90>]}
[0m21:15:43.488138 [info ] [Thread-2 (]: 7 of 10 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.60s]
[0m21:15:43.488408 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:15:43.488784 [info ] [Thread-4 (]: 4 of 10 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.60s]
[0m21:15:43.489252 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:15:43.489456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:43.489767 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:15:43.490025 [debug] [Thread-2 (]: Began running node model.ecommerce_project.category_performance
[0m21:15:43.490497 [info ] [Thread-2 (]: 10 of 10 START sql table model public.category_performance ..................... [RUN]
[0m21:15:43.490722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.category_performance)
[0m21:15:43.490897 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:15:43.492380 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:15:43.492993 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.category_performance
[0m21:15:43.494566 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:15:43.495024 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:43.495203 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:15:43.495365 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:43.611819 [debug] [Thread-3 (]: SQL status: BEGIN in 0.283 seconds
[0m21:15:43.612251 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.612499 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:15:43.662847 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.050 seconds
[0m21:15:43.665535 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.665792 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:15:43.700494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:15:43.702202 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.702450 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:15:43.736401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:15:43.737511 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:15:43.737778 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.737996 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:15:43.774618 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m21:15:43.775956 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:15:43.776316 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:15:43.776537 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:15:43.807713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.318 seconds
[0m21:15:43.808645 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.032 seconds
[0m21:15:43.809359 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:43.811382 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:15:43.811651 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:15:43.812193 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e8fb0>]}
[0m21:15:43.812635 [info ] [Thread-3 (]: 8 of 10 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.49s]
[0m21:15:43.813037 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:15:43.814276 [debug] [Thread-2 (]: SQL status: BEGIN in 0.319 seconds
[0m21:15:43.814544 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:43.814804 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:15:43.898908 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.086 seconds
[0m21:15:43.905444 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:43.906019 [debug] [Thread-2 (]: SQL status: SELECT 2 in 0.091 seconds
[0m21:15:43.906321 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:15:43.908546 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:43.908885 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:15:43.947457 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m21:15:43.948308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.039 seconds
[0m21:15:43.952600 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:43.954738 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:43.954996 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:15:43.955228 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:15:43.989584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:15:43.993471 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:15:43.995313 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:43.995767 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.040 seconds
[0m21:15:43.996170 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:15:43.997589 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:15:43.998048 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:43.998304 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:15:44.034088 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m21:15:44.034416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m21:15:44.035724 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:15:44.037382 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:15:44.037755 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:15:44.038221 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:15:44.038590 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:15:44.038890 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:15:44.081896 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m21:15:44.082899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:15:44.085260 [debug] [Thread-2 (]: On model.ecommerce_project.category_performance: Close
[0m21:15:44.087031 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m21:15:44.087562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da63f0>]}
[0m21:15:44.087840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70182ffa-5b45-4a01-a320-3298484d9742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2fc0b0>]}
[0m21:15:44.088181 [info ] [Thread-2 (]: 10 of 10 OK created sql table model public.category_performance ................ [[32mSELECT 2[0m in 0.60s]
[0m21:15:44.088846 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.category_performance
[0m21:15:44.088492 [info ] [Thread-1 (]: 9 of 10 OK created sql table model public.product_performance .................. [[32mSELECT 4[0m in 0.65s]
[0m21:15:44.089287 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m21:15:44.090031 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:44.090224 [debug] [MainThread]: On master: BEGIN
[0m21:15:44.090366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:44.419471 [debug] [MainThread]: SQL status: BEGIN in 0.329 seconds
[0m21:15:44.421124 [debug] [MainThread]: On master: COMMIT
[0m21:15:44.421987 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:44.422560 [debug] [MainThread]: On master: COMMIT
[0m21:15:44.459163 [debug] [MainThread]: SQL status: COMMIT in 0.036 seconds
[0m21:15:44.460593 [debug] [MainThread]: On master: Close
[0m21:15:44.462588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:44.463159 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:15:44.463659 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m21:15:44.463885 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:15:44.464068 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m21:15:44.464369 [info ] [MainThread]: 
[0m21:15:44.464600 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m21:15:44.466824 [debug] [MainThread]: Command end result
[0m21:15:44.493017 [info ] [MainThread]: 
[0m21:15:44.493351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:15:44.493554 [info ] [MainThread]: 
[0m21:15:44.493881 [error] [MainThread]:   Database Error in model customer_order_frequency (models/marts/sales_reporting/customer_order_frequency.sql)
  column "date" does not exist
  LINE 15:     MIN(date) as first_order,
                   ^
  compiled code at target/run/ecommerce_project/models/marts/sales_reporting/customer_order_frequency.sql
[0m21:15:44.494123 [info ] [MainThread]: 
[0m21:15:44.494339 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m21:15:44.495433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.134961, "process_user_time": 1.570367, "process_kernel_time": 0.194958, "process_mem_max_rss": "126173184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:15:44.495812 [debug] [MainThread]: Command `dbt run` failed at 21:15:44.495719 after 4.14 seconds
[0m21:15:44.496097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb7b90>]}
[0m21:15:44.496469 [debug] [MainThread]: Flushing usage events
[0m21:15:44.599185 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:16:08.294732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227f3ed0>]}


============================== 21:16:08.297782 | 1eded2b5-2e89-4f58-bf91-06f728b8f4e2 ==============================
[0m21:16:08.297782 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:08.298134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:08.335527 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:16:08.335867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122924510>]}
[0m21:16:08.386454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223f7ce0>]}
[0m21:16:08.415352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226f3a50>]}
[0m21:16:08.415971 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:16:08.425798 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:16:08.492730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:08.493159 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/customer_order_frequency.sql
[0m21:16:08.613650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:16:08.620573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12285b2f0>]}
[0m21:16:08.672582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1240350f0>]}
[0m21:16:08.672930 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:16:08.673143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236f9570>]}
[0m21:16:08.674487 [info ] [MainThread]: 
[0m21:16:08.674808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:08.677049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:16:08.705514 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:16:08.705782 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:16:08.705943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:09.138833 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.432 seconds
[0m21:16:09.144697 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:16:09.146901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m21:16:09.147487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:16:09.151683 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:16:09.152693 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:16:09.152901 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:16:09.153091 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:16:09.153316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:09.153532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:09.481574 [debug] [ThreadPool]: SQL status: BEGIN in 0.328 seconds
[0m21:16:09.484370 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:16:09.485383 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:16:09.486288 [debug] [ThreadPool]: SQL status: BEGIN in 0.333 seconds
[0m21:16:09.486766 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:16:09.487001 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:16:09.521465 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m21:16:09.522134 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m21:16:09.525030 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:16:09.526236 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:16:09.557416 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:16:09.558675 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:16:09.566942 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:09.567240 [debug] [MainThread]: On master: BEGIN
[0m21:16:09.567432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:09.889663 [debug] [MainThread]: SQL status: BEGIN in 0.322 seconds
[0m21:16:09.891320 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:09.892074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:09.935962 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m21:16:09.940200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123723ad0>]}
[0m21:16:09.940873 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:09.972875 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:09.975838 [debug] [MainThread]: On master: BEGIN
[0m21:16:10.039875 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m21:16:10.040670 [debug] [MainThread]: On master: COMMIT
[0m21:16:10.041337 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:10.041637 [debug] [MainThread]: On master: COMMIT
[0m21:16:10.079918 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m21:16:10.080246 [debug] [MainThread]: On master: Close
[0m21:16:10.080721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:10.080932 [info ] [MainThread]: 
[0m21:16:10.083290 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:16:10.083699 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:16:10.084940 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:16:10.084507 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m21:16:10.085397 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_products ............................... [RUN]
[0m21:16:10.085921 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m21:16:10.086630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m21:16:10.087174 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m21:16:10.087795 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:16:10.088195 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:16:10.088577 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:16:10.088943 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:16:10.094254 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:16:10.096279 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:16:10.098529 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:16:10.099350 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:16:10.099715 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:16:10.111468 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:16:10.137429 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:16:10.135336 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:16:10.138363 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:16:10.138997 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.139265 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.139509 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.139720 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:16:10.139997 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:16:10.140231 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:16:10.140445 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:10.140638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:10.140827 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:16:10.437917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.297 seconds
[0m21:16:10.440003 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.441816 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:16:10.454609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.314 seconds
[0m21:16:10.455289 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.456037 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:16:10.458372 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m21:16:10.459017 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.459536 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:16:10.485904 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m21:16:10.494172 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.494470 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:16:10.503800 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.043 seconds
[0m21:16:10.505991 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.506326 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m21:16:10.506575 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:16:10.508419 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.508725 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:16:10.525459 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:16:10.530483 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.530717 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:16:10.543198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:16:10.544051 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:16:10.548120 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.550001 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.550240 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:16:10.550463 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:16:10.565117 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:16:10.587379 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:16:10.587815 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:16:10.588140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:16:10.588361 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.589361 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:16:10.590220 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:16:10.590462 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:16:10.590689 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.590895 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.591138 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:16:10.591387 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:16:10.623073 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m21:16:10.628017 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:16:10.628287 [debug] [Thread-2 (]: SQL status: COMMIT in 0.037 seconds
[0m21:16:10.631618 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:16:10.631859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.040 seconds
[0m21:16:10.633101 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:16:10.633341 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:16:10.634472 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:16:10.634781 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:16:10.635158 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:16:10.635407 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:16:10.635630 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:16:10.668405 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m21:16:10.670007 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:16:10.670237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m21:16:10.670465 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.035 seconds
[0m21:16:10.671276 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:16:10.672217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124330890>]}
[0m21:16:10.673060 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:16:10.673842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc14f0>]}
[0m21:16:10.673543 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.58s]
[0m21:16:10.674432 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243fea80>]}
[0m21:16:10.675105 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.59s]
[0m21:16:10.675628 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:16:10.676024 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.59s]
[0m21:16:10.676374 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:16:10.676907 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:16:10.677165 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:16:10.677394 [debug] [Thread-3 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:16:10.677641 [debug] [Thread-1 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:16:10.677913 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:16:10.678259 [info ] [Thread-4 (]: 4 of 10 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:16:10.678586 [info ] [Thread-3 (]: 5 of 10 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:16:10.678895 [info ] [Thread-1 (]: 6 of 10 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:16:10.679174 [info ] [Thread-2 (]: 7 of 10 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:16:10.679620 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m21:16:10.680005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.customer_order_frequency)
[0m21:16:10.680335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.monthly_revenue_orders)
[0m21:16:10.680633 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m21:16:10.680937 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:16:10.681226 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:16:10.681507 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:16:10.681832 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:16:10.684580 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:16:10.686428 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:16:10.687989 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:10.690048 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:16:10.691001 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:16:10.697084 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:16:10.697412 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:16:10.709106 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:16:10.709442 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:16:10.712943 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:16:10.714784 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:10.716697 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:16:10.717334 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:10.717636 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:16:10.717883 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:16:10.718346 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:10.718610 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:10.718816 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:10.719000 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:16:10.719237 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:16:10.719498 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:16:10.719710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:10.719935 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:10.720159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:11.044176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.324 seconds
[0m21:16:11.045008 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:11.045562 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:16:11.055617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.337 seconds
[0m21:16:11.060387 [debug] [Thread-3 (]: SQL status: BEGIN in 0.340 seconds
[0m21:16:11.061124 [debug] [Thread-2 (]: SQL status: BEGIN in 0.341 seconds
[0m21:16:11.061615 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:11.061904 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:11.062083 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:11.062278 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:16:11.062484 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(order_date) as first_order,
    MAX(order_date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:16:11.062791 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:16:11.125384 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.079 seconds
[0m21:16:11.128627 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:11.128889 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:16:11.147479 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.084 seconds
[0m21:16:11.152608 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:11.152871 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:16:11.154134 [debug] [Thread-3 (]: SQL status: SELECT 642 in 0.091 seconds
[0m21:16:11.154369 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.091 seconds
[0m21:16:11.156465 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:11.158246 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:11.158500 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency" rename to "customer_order_frequency__dbt_backup"
[0m21:16:11.158746 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:16:11.160312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:16:11.161976 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:11.162264 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:16:11.187695 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:16:11.193807 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:11.194258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:16:11.194541 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:16:11.194845 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:16:11.195216 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:16:11.200057 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:16:11.202181 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:11.204340 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:11.204640 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:11.204912 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:16:11.205189 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp" rename to "customer_order_frequency"
[0m21:16:11.205449 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:16:11.234561 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:16:11.235774 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:16:11.236211 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:11.236540 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:16:11.242805 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:16:11.243859 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:16:11.244149 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:11.244375 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:16:11.247262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m21:16:11.248626 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:16:11.248886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.043 seconds
[0m21:16:11.249129 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:11.251374 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:16:11.251808 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:16:11.254655 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:16:11.255052 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:16:11.276466 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m21:16:11.277947 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:16:11.278312 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:16:11.278559 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:16:11.284000 [debug] [Thread-3 (]: SQL status: COMMIT in 0.039 seconds
[0m21:16:11.288300 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup"
[0m21:16:11.288665 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:11.288909 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup" cascade
[0m21:16:11.291793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m21:16:11.292062 [debug] [Thread-2 (]: SQL status: COMMIT in 0.037 seconds
[0m21:16:11.292980 [debug] [Thread-1 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:16:11.294131 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:16:11.294518 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:16:11.294852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1246217f0>]}
[0m21:16:11.295088 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:16:11.295615 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.61s]
[0m21:16:11.296343 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:16:11.296864 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:16:11.297295 [info ] [Thread-1 (]: 8 of 10 START sql table model public.orders_by_day ............................. [RUN]
[0m21:16:11.297713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m21:16:11.298056 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:16:11.299891 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:16:11.300465 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:16:11.341013 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:16:11.342677 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:16:11.342945 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.064 seconds
[0m21:16:11.343904 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:16:11.344110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.055 seconds
[0m21:16:11.345024 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:16:11.345917 [debug] [Thread-3 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:16:11.346247 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242e7bf0>]}
[0m21:16:11.346473 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.347020 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:16:11.347268 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242e7bf0>]}
[0m21:16:11.346857 [info ] [Thread-2 (]: 7 of 10 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.67s]
[0m21:16:11.347504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:11.347711 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242e7c50>]}
[0m21:16:11.348080 [info ] [Thread-3 (]: 5 of 10 OK created sql table model public.customer_order_frequency ............. [[32mSELECT 642[0m in 0.67s]
[0m21:16:11.348441 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:16:11.348909 [info ] [Thread-4 (]: 4 of 10 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.67s]
[0m21:16:11.349275 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:16:11.349530 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m21:16:11.349839 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:16:11.350048 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m21:16:11.350314 [info ] [Thread-2 (]: 9 of 10 START sql table model public.product_performance ....................... [RUN]
[0m21:16:11.350726 [info ] [Thread-3 (]: 10 of 10 START sql table model public.category_performance ..................... [RUN]
[0m21:16:11.351033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.product_performance)
[0m21:16:11.351261 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.category_performance)
[0m21:16:11.351495 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:16:11.351684 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:16:11.353096 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:16:11.354579 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:16:11.355116 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m21:16:11.355312 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m21:16:11.357507 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:16:11.359217 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:16:11.359845 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.360058 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.360235 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:16:11.360415 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:16:11.360579 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:16:11.360734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:16:11.628509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.281 seconds
[0m21:16:11.628986 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.629241 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:16:11.656224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.295 seconds
[0m21:16:11.656470 [debug] [Thread-3 (]: SQL status: BEGIN in 0.296 seconds
[0m21:16:11.656711 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.656946 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.657184 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:16:11.657441 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:16:11.686802 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.057 seconds
[0m21:16:11.693190 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.693511 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:16:11.724923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:16:11.727173 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.727483 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.070 seconds
[0m21:16:11.727743 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.070 seconds
[0m21:16:11.727987 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:16:11.729837 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.731823 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.732144 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:16:11.732410 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:16:11.760443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:16:11.760672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:16:11.761619 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:16:11.761851 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:16:11.763493 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.763735 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.765393 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.765644 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:16:11.765867 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:16:11.766095 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:16:11.799141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:16:11.800266 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:16:11.803249 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:16:11.803496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.037 seconds
[0m21:16:11.804880 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:16:11.805127 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.806334 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:16:11.806585 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.806801 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:16:11.807133 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:16:11.807399 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:16:11.807699 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:16:11.838815 [debug] [Thread-2 (]: SQL status: COMMIT in 0.031 seconds
[0m21:16:11.840372 [debug] [Thread-3 (]: SQL status: COMMIT in 0.032 seconds
[0m21:16:11.841075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.033 seconds
[0m21:16:11.844383 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:16:11.845866 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:16:11.847254 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:16:11.847631 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:16:11.847967 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:16:11.848235 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:16:11.848576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123691070>]}
[0m21:16:11.848795 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:16:11.849284 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.55s]
[0m21:16:11.849668 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:16:11.894234 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:16:11.894877 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.046 seconds
[0m21:16:11.897368 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m21:16:11.898336 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m21:16:11.898904 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226eb350>]}
[0m21:16:11.899191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eded2b5-2e89-4f58-bf91-06f728b8f4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227364b0>]}
[0m21:16:11.899627 [info ] [Thread-3 (]: 10 of 10 OK created sql table model public.category_performance ................ [[32mSELECT 2[0m in 0.55s]
[0m21:16:11.900412 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m21:16:11.899999 [info ] [Thread-2 (]: 9 of 10 OK created sql table model public.product_performance .................. [[32mSELECT 4[0m in 0.55s]
[0m21:16:11.900923 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m21:16:11.901968 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:11.902181 [debug] [MainThread]: On master: BEGIN
[0m21:16:11.902355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:12.204110 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m21:16:12.204457 [debug] [MainThread]: On master: COMMIT
[0m21:16:12.204651 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:12.204966 [debug] [MainThread]: On master: COMMIT
[0m21:16:12.240739 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m21:16:12.241571 [debug] [MainThread]: On master: Close
[0m21:16:12.242823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:12.243470 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:16:12.243862 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:16:12.244233 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m21:16:12.244647 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_lifetime_value' was properly closed.
[0m21:16:12.244999 [info ] [MainThread]: 
[0m21:16:12.245247 [info ] [MainThread]: Finished running 3 view models, 7 table models in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m21:16:12.247871 [debug] [MainThread]: Command end result
[0m21:16:12.272548 [info ] [MainThread]: 
[0m21:16:12.272923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:12.273179 [info ] [MainThread]: 
[0m21:16:12.273433 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m21:16:12.275170 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0218596, "process_user_time": 1.586604, "process_kernel_time": 0.216398, "process_mem_max_rss": "127975424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:16:12.275595 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:12.275529 after 4.02 seconds
[0m21:16:12.275842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123445e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124693f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124693a70>]}
[0m21:16:12.276074 [debug] [MainThread]: Flushing usage events
[0m21:16:12.301374 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:16:24.484284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb3ed0>]}


============================== 21:16:24.486867 | cce35a80-25ab-49ab-9d88-966c8501c34b ==============================
[0m21:16:24.486867 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:24.487224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select customer_order_frequency --limit=100', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:24.523556 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:16:24.523857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe8510>]}
[0m21:16:24.580701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f7ce0>]}
[0m21:16:24.609498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf3a50>]}
[0m21:16:24.610064 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:16:24.620670 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:16:24.688985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:24.689342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:24.692208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:16:24.713481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fdd60>]}
[0m21:16:24.773431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa0210>]}
[0m21:16:24.773776 [info ] [MainThread]: Found 10 models, 1 snapshot, 3 sources, 424 macros
[0m21:16:24.773966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f43ee0>]}
[0m21:16:24.775083 [info ] [MainThread]: 
[0m21:16:24.775453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:24.777776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:16:24.779074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:16:24.810739 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:16:24.811029 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:16:24.811222 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:16:24.811462 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:16:24.811650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:24.811813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:25.260121 [debug] [ThreadPool]: SQL status: BEGIN in 0.448 seconds
[0m21:16:25.260502 [debug] [ThreadPool]: SQL status: BEGIN in 0.449 seconds
[0m21:16:25.260814 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:16:25.261040 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:16:25.261262 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:16:25.261515 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:16:25.300577 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.039 seconds
[0m21:16:25.300956 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.039 seconds
[0m21:16:25.302048 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:16:25.303216 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:16:25.336730 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:16:25.337652 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:16:25.349418 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:25.349740 [debug] [MainThread]: On master: BEGIN
[0m21:16:25.349923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:25.656339 [debug] [MainThread]: SQL status: BEGIN in 0.304 seconds
[0m21:16:25.658616 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:25.660288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:25.701639 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m21:16:25.704308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce35a80-25ab-49ab-9d88-966c8501c34b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d0ac90>]}
[0m21:16:25.705062 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:25.740431 [debug] [MainThread]: On master: Close
[0m21:16:25.743179 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:25.743554 [info ] [MainThread]: 
[0m21:16:25.745773 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:16:25.746234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.customer_order_frequency)
[0m21:16:25.746525 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:16:25.752273 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:16:25.753253 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:16:25.759552 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:16:25.760077 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
  SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(order_date) as first_order,
    MAX(order_date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  
  limit 100

[0m21:16:25.760466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:26.083625 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.323 seconds
[0m21:16:26.088386 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:16:26.089163 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:16:26.090209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:26.090473 [debug] [MainThread]: Connection 'model.ecommerce_project.customer_order_frequency' was properly closed.
[0m21:16:26.090724 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:16:26.091131 [debug] [MainThread]: Command end result
[0m21:16:26.112859 [info ] [MainThread]: Previewing node 'customer_order_frequency':
| customer_id | total_orders | first_order | last_order |      avg |
| ----------- | ------------ | ----------- | ---------- | -------- |
|           3 |            1 |  2024-02-28 | 2024-02-28 |          |
|           6 |            2 |  2024-05-22 | 2024-08-25 |  95.000… |
|           8 |            1 |  2024-09-23 | 2024-09-23 |          |
|           9 |            1 |  2024-01-03 | 2024-01-03 |          |
|          11 |            2 |  2024-03-18 | 2024-08-26 | 161.000… |
|          13 |            3 |  2024-05-27 | 2024-08-26 |  45.500… |
|          14 |            4 |  2024-02-08 | 2024-05-24 |  35.333… |
|          15 |            1 |  2024-06-14 | 2024-06-14 |          |
|          16 |            1 |  2024-01-03 | 2024-01-03 |          |
|          18 |            1 |  2024-01-12 | 2024-01-12 |          |
|          21 |            2 |  2024-04-28 | 2024-06-28 |  61.000… |
|          24 |            2 |  2024-04-20 | 2024-05-06 |  16.000… |
|          25 |            2 |  2024-03-14 | 2024-06-27 | 105.000… |
|          26 |            2 |  2024-02-18 | 2024-06-26 | 129.000… |
|          28 |            2 |  2024-06-11 | 2024-06-26 |  15.000… |
|          29 |            1 |  2024-05-27 | 2024-05-27 |          |
|          32 |            4 |  2024-02-08 | 2024-10-02 |  79.000… |
|          33 |            1 |  2024-04-19 | 2024-04-19 |          |
|          34 |            1 |  2024-08-08 | 2024-08-08 |          |
|          37 |            1 |  2024-04-12 | 2024-04-12 |          |
|          38 |            1 |  2024-07-21 | 2024-07-21 |          |
|          39 |            1 |  2024-02-03 | 2024-02-03 |          |
|          40 |            1 |  2024-09-11 | 2024-09-11 |          |
|          41 |            1 |  2024-08-06 | 2024-08-06 |          |
|          42 |            2 |  2024-04-06 | 2024-08-19 | 135.000… |
|          43 |            1 |  2024-08-05 | 2024-08-05 |          |
|          44 |            2 |  2024-03-11 | 2024-06-13 |  94.000… |
|          47 |            1 |  2024-08-15 | 2024-08-15 |          |
|          48 |            2 |  2024-02-16 | 2024-08-13 | 179.000… |
|          49 |            1 |  2024-08-22 | 2024-08-22 |          |
|          50 |            4 |  2024-03-24 | 2024-08-09 |  46.000… |
|          51 |            3 |  2024-02-12 | 2024-05-11 |  44.500… |
|          53 |            1 |  2024-07-09 | 2024-07-09 |          |
|          55 |            2 |  2024-02-01 | 2024-05-04 |  93.000… |
|          59 |            3 |  2024-04-12 | 2024-08-30 |  70.000… |
|          60 |            2 |  2024-05-27 | 2024-09-13 | 109.000… |
|          61 |            1 |  2024-04-10 | 2024-04-10 |          |
|          62 |            1 |  2024-01-30 | 2024-01-30 |          |
|          65 |            1 |  2024-02-01 | 2024-02-01 |          |
|          66 |            1 |  2024-04-25 | 2024-04-25 |          |
|          67 |            1 |  2024-07-08 | 2024-07-08 |          |
|          68 |            3 |  2024-03-25 | 2024-07-25 |  61.000… |
|          70 |            1 |  2024-08-27 | 2024-08-27 |          |
|          72 |            1 |  2024-02-16 | 2024-02-16 |          |
|          73 |            1 |  2024-09-30 | 2024-09-30 |          |
|          74 |            2 |  2024-01-07 | 2024-03-28 |  81.000… |
|          75 |            1 |  2024-07-23 | 2024-07-23 |          |
|          76 |            2 |  2024-03-07 | 2024-07-10 | 125.000… |
|          77 |            1 |  2024-09-06 | 2024-09-06 |          |
|          78 |            3 |  2024-04-17 | 2024-07-08 |  41.000… |
|          79 |            1 |  2024-06-08 | 2024-06-08 |          |
|          80 |            4 |  2024-03-10 | 2024-05-05 |  18.667… |
|          82 |            3 |  2024-04-06 | 2024-10-13 |  95.000… |
|          83 |            1 |  2024-03-03 | 2024-03-03 |          |
|          86 |            1 |  2024-09-11 | 2024-09-11 |          |
|          87 |            1 |  2024-08-23 | 2024-08-23 |          |
|          88 |            2 |  2024-01-26 | 2024-07-03 | 159.000… |
|          89 |            1 |  2024-06-27 | 2024-06-27 |          |
|          90 |            2 |  2024-04-03 | 2024-04-29 |  26.000… |
|          92 |            1 |  2024-07-08 | 2024-07-08 |          |
|          93 |            1 |  2024-09-28 | 2024-09-28 |          |
|          96 |            3 |  2024-01-11 | 2024-08-03 | 102.500… |
|          97 |            2 |  2024-02-28 | 2024-08-13 | 167.000… |
|          98 |            1 |  2024-01-06 | 2024-01-06 |          |
|         100 |            1 |  2024-08-05 | 2024-08-05 |          |
|         101 |            1 |  2024-05-23 | 2024-05-23 |          |
|         102 |            1 |  2024-07-09 | 2024-07-09 |          |
|         103 |            1 |  2024-03-28 | 2024-03-28 |          |
|         106 |            2 |  2024-05-30 | 2024-08-22 |  84.000… |
|         107 |            1 |  2024-06-15 | 2024-06-15 |          |
|         108 |            2 |  2024-03-29 | 2024-08-04 | 128.000… |
|         110 |            1 |  2024-08-27 | 2024-08-27 |          |
|         111 |            3 |  2024-01-05 | 2024-08-05 | 106.500… |
|         112 |            3 |  2024-01-09 | 2024-08-29 | 116.500… |
|         115 |            1 |  2024-03-15 | 2024-03-15 |          |
|         118 |            1 |  2024-08-29 | 2024-08-29 |          |
|         121 |            1 |  2024-09-27 | 2024-09-27 |          |
|         123 |            3 |  2024-04-13 | 2024-10-13 |  91.500… |
|         129 |            1 |  2024-03-06 | 2024-03-06 |          |
|         130 |            1 |  2024-03-19 | 2024-03-19 |          |
|         131 |            1 |  2024-04-23 | 2024-04-23 |          |
|         132 |            1 |  2024-02-17 | 2024-02-17 |          |
|         133 |            1 |  2024-04-20 | 2024-04-20 |          |
|         136 |            2 |  2024-03-29 | 2024-05-08 |  40.000… |
|         137 |            1 |  2024-02-25 | 2024-02-25 |          |
|         138 |            1 |  2024-04-06 | 2024-04-06 |          |
|         141 |            2 |  2024-01-08 | 2024-08-21 | 226.000… |
|         142 |            2 |  2024-05-02 | 2024-08-13 | 103.000… |
|         143 |            2 |  2024-05-29 | 2024-07-13 |  45.000… |
|         144 |            1 |  2024-01-10 | 2024-01-10 |          |
|         145 |            3 |  2024-04-15 | 2024-09-29 |  83.500… |
|         146 |            1 |  2024-10-09 | 2024-10-09 |          |
|         147 |            2 |  2024-04-15 | 2024-04-17 |   2.000… |
|         149 |            1 |  2024-10-11 | 2024-10-11 |          |
|         150 |            2 |  2024-01-27 | 2024-06-15 | 140.000… |
|         151 |            2 |  2024-06-16 | 2024-08-03 |  48.000… |
|         152 |            1 |  2024-06-21 | 2024-06-21 |          |
|         153 |            2 |  2024-02-25 | 2024-09-23 | 211.000… |
|         154 |            1 |  2024-07-07 | 2024-07-07 |          |
|         156 |            2 |  2024-03-18 | 2024-04-28 |  41.000… |

[0m21:16:26.114921 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.6746475, "process_user_time": 1.040781, "process_kernel_time": 0.164365, "process_mem_max_rss": "121126912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:16:26.115350 [debug] [MainThread]: Command `dbt show` succeeded at 21:16:26.115282 after 1.68 seconds
[0m21:16:26.115628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afde90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d5ef0>]}
[0m21:16:26.115863 [debug] [MainThread]: Flushing usage events
[0m21:16:26.120371 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:24:47.782219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10385d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058efed0>]}


============================== 21:24:47.785852 | 7f64115b-ad6e-42af-8434-1deb518b4c8b ==============================
[0m21:24:47.785852 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:24:47.786237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:24:47.835816 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:24:47.836138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a24510>]}
[0m21:24:47.891621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f7ce0>]}
[0m21:24:47.919623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057efa50>]}
[0m21:24:47.920327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:24:47.931723 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:24:48.010742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:24:48.011157 [debug] [MainThread]: Partial parsing: added file: ecommerce_project://models/marts/sales_reporting/top_10_customers_by_revenue.sql
[0m21:24:48.133972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:24:48.140906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105953200>]}
[0m21:24:48.198827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072410f0>]}
[0m21:24:48.199102 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:24:48.199269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107065570>]}
[0m21:24:48.200411 [info ] [MainThread]: 
[0m21:24:48.200706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:24:48.202889 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:24:48.236187 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:24:48.236448 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:24:48.236627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:48.682130 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.445 seconds
[0m21:24:48.686475 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:24:48.688546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m21:24:48.692618 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:24:48.693008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:24:48.693226 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:24:48.694254 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:24:48.694463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:48.694658 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:24:48.694928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:48.966241 [debug] [ThreadPool]: SQL status: BEGIN in 0.271 seconds
[0m21:24:48.967459 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:24:48.973335 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:24:48.974092 [debug] [ThreadPool]: SQL status: BEGIN in 0.280 seconds
[0m21:24:48.974670 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:24:48.975277 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:24:49.009727 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m21:24:49.010418 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m21:24:49.012615 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:24:49.014036 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:24:49.042059 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:24:49.043209 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:24:49.049877 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:49.050089 [debug] [MainThread]: On master: BEGIN
[0m21:24:49.050232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:49.313538 [debug] [MainThread]: SQL status: BEGIN in 0.263 seconds
[0m21:24:49.314420 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:49.315326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:24:49.362618 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m21:24:49.366725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709b890>]}
[0m21:24:49.367151 [debug] [MainThread]: On master: ROLLBACK
[0m21:24:49.392902 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:49.393202 [debug] [MainThread]: On master: BEGIN
[0m21:24:49.441207 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m21:24:49.441598 [debug] [MainThread]: On master: COMMIT
[0m21:24:49.441830 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:49.442038 [debug] [MainThread]: On master: COMMIT
[0m21:24:49.472865 [debug] [MainThread]: SQL status: COMMIT in 0.030 seconds
[0m21:24:49.473704 [debug] [MainThread]: On master: Close
[0m21:24:49.475557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:24:49.477017 [info ] [MainThread]: 
[0m21:24:49.480114 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:24:49.480664 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:24:49.480963 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:24:49.481360 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m21:24:49.481972 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m21:24:49.482539 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_products ............................... [RUN]
[0m21:24:49.483250 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:24:49.483527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_customers)
[0m21:24:49.483753 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_products)
[0m21:24:49.483981 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:24:49.484190 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:24:49.484380 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:24:49.491851 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:24:49.494551 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:24:49.497000 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:24:49.497818 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:24:49.504097 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:24:49.510901 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:24:49.533870 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:24:49.535899 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:24:49.536458 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:24:49.537483 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:49.537746 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:49.537983 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:24:49.538203 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:49.538424 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:24:49.538650 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:49.538904 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:24:49.539137 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:24:49.539423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:49.805223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.266 seconds
[0m21:24:49.805754 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:49.806030 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:24:49.809359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.271 seconds
[0m21:24:49.809581 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:49.809828 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:24:49.828026 [debug] [Thread-3 (]: SQL status: BEGIN in 0.288 seconds
[0m21:24:49.829063 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:49.829818 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:24:49.855112 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m21:24:49.857542 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m21:24:49.865772 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:49.868032 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:49.868270 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:24:49.868523 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:24:49.876717 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.046 seconds
[0m21:24:49.878534 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:49.878771 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:24:49.893961 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m21:24:49.897286 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:49.897742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:24:49.898067 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:24:49.900160 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:49.900491 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:24:49.911478 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:24:49.913202 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:49.913434 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:24:49.925913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m21:24:49.932655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:24:49.943028 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:24:49.944220 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:24:49.944506 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:49.944727 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:49.944936 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:24:49.945134 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:24:49.947109 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:24:49.948270 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:24:49.948607 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:49.948895 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:24:49.985673 [debug] [Thread-2 (]: SQL status: COMMIT in 0.040 seconds
[0m21:24:49.986204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m21:24:49.992240 [debug] [Thread-3 (]: SQL status: COMMIT in 0.043 seconds
[0m21:24:49.992675 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:24:49.994523 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:24:49.996162 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:24:50.000852 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:24:50.001468 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:24:50.001918 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:24:50.002222 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:24:50.002501 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:24:50.002840 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:24:50.032710 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.029 seconds
[0m21:24:50.033115 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.030 seconds
[0m21:24:50.034852 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:24:50.035717 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:24:50.035999 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.033 seconds
[0m21:24:50.036824 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:24:50.037865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ec890>]}
[0m21:24:50.038144 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107707110>]}
[0m21:24:50.038422 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c0d70>]}
[0m21:24:50.038849 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.55s]
[0m21:24:50.040022 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:24:50.039177 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.55s]
[0m21:24:50.039672 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.56s]
[0m21:24:50.040574 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:24:50.040874 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:24:50.041364 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:24:50.041573 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m21:24:50.041769 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:24:50.041984 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:24:50.042222 [info ] [Thread-2 (]: 6 of 11 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:24:50.042517 [info ] [Thread-4 (]: 4 of 11 START sql table model public.category_performance ...................... [RUN]
[0m21:24:50.042804 [info ] [Thread-1 (]: 5 of 11 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:24:50.043068 [info ] [Thread-3 (]: 7 of 11 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:24:50.043303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_order_frequency)
[0m21:24:50.043582 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m21:24:50.043849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_lifetime_value)
[0m21:24:50.044077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m21:24:50.044302 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:24:50.044515 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:24:50.044716 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:24:50.045011 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:24:50.046972 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.048314 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:24:50.049570 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.051246 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.051914 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:24:50.063881 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.064377 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:24:50.064635 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:24:50.064854 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m21:24:50.066853 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.068529 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.068806 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.070486 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:24:50.070787 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:24:50.071112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:50.071388 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.071723 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.071933 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:24:50.072192 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.072398 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:24:50.072574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:50.072749 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:24:50.072910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:50.073141 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:24:50.329393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m21:24:50.329809 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.330060 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:24:50.345451 [debug] [Thread-3 (]: SQL status: BEGIN in 0.273 seconds
[0m21:24:50.345801 [debug] [Thread-2 (]: SQL status: BEGIN in 0.275 seconds
[0m21:24:50.346002 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.346204 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.346420 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:24:50.346730 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(order_date) as first_order,
    MAX(order_date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:24:50.362802 [debug] [Thread-4 (]: SQL status: BEGIN in 0.290 seconds
[0m21:24:50.363041 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.363269 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:24:50.385938 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.055 seconds
[0m21:24:50.388033 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.388296 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:24:50.415396 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.068 seconds
[0m21:24:50.417627 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.417905 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.071 seconds
[0m21:24:50.418167 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency" rename to "customer_order_frequency__dbt_backup"
[0m21:24:50.418390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:24:50.418635 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.055 seconds
[0m21:24:50.420684 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.423233 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.425138 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.425395 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:24:50.425631 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:24:50.425850 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:24:50.449515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:24:50.451831 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.452089 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp" rename to "customer_order_frequency"
[0m21:24:50.456813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:24:50.457064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:24:50.461900 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:24:50.462274 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:24:50.464070 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.464336 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.466052 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.466283 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:24:50.466499 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:24:50.466716 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:24:50.480937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:24:50.481913 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:24:50.482144 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.482350 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:24:50.493892 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m21:24:50.494808 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:24:50.495146 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.495353 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:24:50.495553 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:24:50.496802 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:24:50.497034 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.497245 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:24:50.499812 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m21:24:50.501129 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:24:50.503495 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:24:50.503856 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:24:50.515459 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m21:24:50.517197 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup"
[0m21:24:50.517672 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:24:50.517989 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup" cascade
[0m21:24:50.526568 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m21:24:50.531829 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:24:50.532192 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m21:24:50.532666 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:24:50.534289 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:24:50.534563 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:24:50.534908 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:24:50.535212 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:24:50.535735 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m21:24:50.536691 [debug] [Thread-1 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:24:50.537127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dd940>]}
[0m21:24:50.537552 [info ] [Thread-1 (]: 5 of 11 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.49s]
[0m21:24:50.537954 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:24:50.538300 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:24:50.538777 [info ] [Thread-1 (]: 8 of 11 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:24:50.539120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.orders_by_customer)
[0m21:24:50.539386 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:24:50.541247 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:24:50.541881 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:24:50.584432 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:24:50.584748 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.049 seconds
[0m21:24:50.584983 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.067 seconds
[0m21:24:50.586558 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:24:50.587482 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:24:50.588167 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m21:24:50.588794 [debug] [Thread-2 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:24:50.589372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6c3b0>]}
[0m21:24:50.589658 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:50.589963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057460f0>]}
[0m21:24:50.590211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105747530>]}
[0m21:24:50.590557 [info ] [Thread-4 (]: 4 of 11 OK created sql table model public.category_performance ................. [[32mSELECT 2[0m in 0.55s]
[0m21:24:50.590784 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:24:50.591089 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.55s]
[0m21:24:50.591366 [info ] [Thread-2 (]: 6 of 11 OK created sql table model public.customer_order_frequency ............. [[32mSELECT 642[0m in 0.55s]
[0m21:24:50.591642 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m21:24:50.591811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:50.592178 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:24:50.592487 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:24:50.592725 [debug] [Thread-4 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:24:50.593055 [debug] [Thread-3 (]: Began running node model.ecommerce_project.product_performance
[0m21:24:50.593329 [debug] [Thread-2 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:24:50.593634 [info ] [Thread-4 (]: 9 of 11 START sql table model public.orders_by_day ............................. [RUN]
[0m21:24:50.593933 [info ] [Thread-3 (]: 10 of 11 START sql table model public.product_performance ...................... [RUN]
[0m21:24:50.594219 [info ] [Thread-2 (]: 11 of 11 START sql table model public.top_10_customers_by_revenue .............. [RUN]
[0m21:24:50.594513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.orders_by_day)
[0m21:24:50.594759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.product_performance)
[0m21:24:50.594998 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:24:50.595205 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:24:50.595387 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:24:50.595564 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:24:50.597137 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:24:50.598517 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:24:50.600346 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:50.601030 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.product_performance
[0m21:24:50.601281 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:24:50.601482 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:24:50.603132 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:24:50.605143 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:24:50.606689 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:50.607290 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:50.607485 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:24:50.607706 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:50.607873 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:24:50.608109 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:24:50.608313 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:50.608684 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:24:50.608967 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: BEGIN
[0m21:24:50.609320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:24:50.869720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.278 seconds
[0m21:24:50.870022 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:50.870300 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:24:50.876914 [debug] [Thread-4 (]: SQL status: BEGIN in 0.269 seconds
[0m21:24:50.877167 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:50.877448 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:24:50.892769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.284 seconds
[0m21:24:50.893093 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:50.893304 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:24:50.897554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.288 seconds
[0m21:24:50.897901 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:50.898144 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
LIMIT 10
  );
  
[0m21:24:50.932354 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.062 seconds
[0m21:24:50.934170 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:50.934384 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:24:50.938265 [debug] [Thread-4 (]: SQL status: SELECT 282 in 0.061 seconds
[0m21:24:50.939951 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:50.940161 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:24:50.966156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:24:50.982840 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:50.983160 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.090 seconds
[0m21:24:50.983370 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.085 seconds
[0m21:24:50.983534 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.043 seconds
[0m21:24:50.983832 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:24:50.986193 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:50.987737 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:50.989129 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:50.989500 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:24:50.989773 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue" rename to "top_10_customers_by_revenue__dbt_backup"
[0m21:24:50.989976 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:24:51.017280 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m21:24:51.017671 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m21:24:51.019516 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:51.019718 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:24:51.020457 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:24:51.020652 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:24:51.021873 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:51.022057 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:51.022366 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp" rename to "top_10_customers_by_revenue"
[0m21:24:51.022626 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:24:51.024864 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:24:51.025644 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:24:51.025900 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:51.026106 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:24:51.057582 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:24:51.059367 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:24:51.059636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.037 seconds
[0m21:24:51.059839 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:51.060583 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:24:51.060782 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:24:51.060981 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m21:24:51.061203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m21:24:51.061466 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:51.062801 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:24:51.064393 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:24:51.064706 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:24:51.065019 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:24:51.065280 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:24:51.065524 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:24:51.065734 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:24:51.090603 [debug] [Thread-2 (]: SQL status: COMMIT in 0.029 seconds
[0m21:24:51.102360 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup"
[0m21:24:51.103075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m21:24:51.104054 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m21:24:51.104441 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.038 seconds
[0m21:24:51.104838 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:24:51.105882 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:24:51.107405 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:24:51.108332 [debug] [Thread-4 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:24:51.108633 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
drop table if exists "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup" cascade
[0m21:24:51.108994 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:24:51.109300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e1130>]}
[0m21:24:51.109592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e2a50>]}
[0m21:24:51.109874 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:24:51.110264 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.57s]
[0m21:24:51.110652 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.52s]
[0m21:24:51.111065 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:24:51.111414 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:24:51.155567 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.045 seconds
[0m21:24:51.156554 [debug] [Thread-3 (]: On model.ecommerce_project.product_performance: Close
[0m21:24:51.156787 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.047 seconds
[0m21:24:51.157523 [debug] [Thread-2 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:24:51.157802 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f3530>]}
[0m21:24:51.158061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f64115b-ad6e-42af-8434-1deb518b4c8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f1d30>]}
[0m21:24:51.158395 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public.top_10_customers_by_revenue ......... [[32mSELECT 10[0m in 0.56s]
[0m21:24:51.158664 [info ] [Thread-3 (]: 10 of 11 OK created sql table model public.product_performance ................. [[32mSELECT 4[0m in 0.56s]
[0m21:24:51.159076 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:24:51.159343 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.product_performance
[0m21:24:51.160243 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:51.160420 [debug] [MainThread]: On master: BEGIN
[0m21:24:51.160565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:24:51.467171 [debug] [MainThread]: SQL status: BEGIN in 0.306 seconds
[0m21:24:51.467918 [debug] [MainThread]: On master: COMMIT
[0m21:24:51.468332 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:51.468723 [debug] [MainThread]: On master: COMMIT
[0m21:24:51.515651 [debug] [MainThread]: SQL status: COMMIT in 0.046 seconds
[0m21:24:51.516008 [debug] [MainThread]: On master: Close
[0m21:24:51.516411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:51.516607 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m21:24:51.516773 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:24:51.516927 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:24:51.517073 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:24:51.517400 [info ] [MainThread]: 
[0m21:24:51.517666 [info ] [MainThread]: Finished running 3 view models, 8 table models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m21:24:51.519027 [debug] [MainThread]: Command end result
[0m21:24:51.538281 [info ] [MainThread]: 
[0m21:24:51.538576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:51.538996 [info ] [MainThread]: 
[0m21:24:51.539320 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m21:24:51.540750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.804196, "process_user_time": 1.573611, "process_kernel_time": 0.228483, "process_mem_max_rss": "126681088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:24:51.541079 [debug] [MainThread]: Command `dbt run` succeeded at 21:24:51.541025 after 3.80 seconds
[0m21:24:51.541307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11009bad0>]}
[0m21:24:51.541504 [debug] [MainThread]: Flushing usage events
[0m21:24:51.638450 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:25:07.642734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3ed0>]}


============================== 21:25:07.645437 | bde5a5fd-17f0-43dd-b976-dcd1a546bc04 ==============================
[0m21:25:07.645437 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:25:07.645891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt show --select top_10_customers_by_revenue --limit=100', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:07.681951 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:25:07.682236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e8510>]}
[0m21:25:07.730985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f7ce0>]}
[0m21:25:07.760305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062efa50>]}
[0m21:25:07.760912 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:25:07.771076 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:25:07.834944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:07.835242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:07.838241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:25:07.859080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be6210>]}
[0m21:25:07.915184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a0210>]}
[0m21:25:07.915474 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:25:07.915642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106743ee0>]}
[0m21:25:07.916540 [info ] [MainThread]: 
[0m21:25:07.916852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:07.919153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:25:07.925598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:25:07.949566 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:25:07.949866 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:25:07.950097 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:25:07.950286 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:25:07.950436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:07.950601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:08.352788 [debug] [ThreadPool]: SQL status: BEGIN in 0.402 seconds
[0m21:25:08.353206 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:25:08.353469 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:25:08.375846 [debug] [ThreadPool]: SQL status: BEGIN in 0.425 seconds
[0m21:25:08.376143 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:25:08.376350 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:25:08.384237 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.030 seconds
[0m21:25:08.385481 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:25:08.407285 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.031 seconds
[0m21:25:08.408635 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:25:08.416322 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:25:08.435617 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:25:08.441373 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:08.441613 [debug] [MainThread]: On master: BEGIN
[0m21:25:08.441777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:08.717344 [debug] [MainThread]: SQL status: BEGIN in 0.275 seconds
[0m21:25:08.717759 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:08.718033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:08.757752 [debug] [MainThread]: SQL status: SELECT 3 in 0.039 seconds
[0m21:25:08.759404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bde5a5fd-17f0-43dd-b976-dcd1a546bc04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c2c90>]}
[0m21:25:08.759742 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:08.789485 [debug] [MainThread]: On master: Close
[0m21:25:08.793892 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:08.794648 [info ] [MainThread]: 
[0m21:25:08.796705 [debug] [Thread-1 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:08.797027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:25:08.797257 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:08.806406 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:25:08.807350 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:08.812343 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:25:08.812795 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
  SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
LIMIT 10
  
  limit 100

[0m21:25:08.813141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:09.078142 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "limit"
LINE 13:   limit 100
           ^

[0m21:25:09.078687 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:25:09.083894 [debug] [Thread-1 (]: Database Error in model top_10_customers_by_revenue (models/marts/sales_reporting/top_10_customers_by_revenue.sql)
  syntax error at or near "limit"
  LINE 13:   limit 100
             ^
[0m21:25:09.084454 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:09.085303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:09.085631 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:25:09.085890 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m21:25:09.086252 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model top_10_customers_by_revenue (models/marts/sales_reporting/top_10_customers_by_revenue.sql)
    syntax error at or near "limit"
    LINE 13:   limit 100
               ^
[0m21:25:09.087447 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 1.4853591, "process_user_time": 0.998371, "process_kernel_time": 0.143952, "process_mem_max_rss": "119717888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:25:09.087851 [debug] [MainThread]: Command `dbt show` failed at 21:25:09.087783 after 1.49 seconds
[0m21:25:09.088117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757e490>]}
[0m21:25:09.088358 [debug] [MainThread]: Flushing usage events
[0m21:25:09.123684 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:25:18.202996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027dd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3ed0>]}


============================== 21:25:18.205667 | 20cb1fcf-7c1c-4919-858e-fd32e1cff814 ==============================
[0m21:25:18.205667 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:25:18.206011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt show --select top_10_customers_by_revenue', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:25:18.243221 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:25:18.243513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ec510>]}
[0m21:25:18.292161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f7ce0>]}
[0m21:25:18.320373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b3a50>]}
[0m21:25:18.320858 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:25:18.330759 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:25:18.394563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:18.394865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:18.398110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:25:18.417936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daa210>]}
[0m21:25:18.473864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a0210>]}
[0m21:25:18.474133 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:25:18.474301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104743ee0>]}
[0m21:25:18.475184 [info ] [MainThread]: 
[0m21:25:18.475505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:18.477965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:25:18.479036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:25:18.508178 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:25:18.508501 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:25:18.508694 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:25:18.508863 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:25:18.509035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:18.509174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:18.802132 [debug] [ThreadPool]: SQL status: BEGIN in 0.293 seconds
[0m21:25:18.802559 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:25:18.802841 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:25:18.828520 [debug] [ThreadPool]: SQL status: BEGIN in 0.319 seconds
[0m21:25:18.830119 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:25:18.831141 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:25:18.839080 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.036 seconds
[0m21:25:18.841577 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:25:18.872573 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.040 seconds
[0m21:25:18.873880 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:25:18.876372 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:25:18.912084 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:25:18.920113 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:18.920386 [debug] [MainThread]: On master: BEGIN
[0m21:25:18.920567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:19.230010 [debug] [MainThread]: SQL status: BEGIN in 0.309 seconds
[0m21:25:19.231214 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:19.232751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:19.276199 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m21:25:19.279526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20cb1fcf-7c1c-4919-858e-fd32e1cff814', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105512c90>]}
[0m21:25:19.280311 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:19.314025 [debug] [MainThread]: On master: Close
[0m21:25:19.316623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:19.317822 [info ] [MainThread]: 
[0m21:25:19.320835 [debug] [Thread-1 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:19.321207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:25:19.321457 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:19.328733 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:25:19.329698 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:19.336249 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:25:19.336648 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
  SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
LIMIT 10
  
  limit 5

[0m21:25:19.336970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:19.661780 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "limit"
LINE 13:   limit 5
           ^

[0m21:25:19.663669 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:25:19.667779 [debug] [Thread-1 (]: Database Error in model top_10_customers_by_revenue (models/marts/sales_reporting/top_10_customers_by_revenue.sql)
  syntax error at or near "limit"
  LINE 13:   limit 5
             ^
[0m21:25:19.668341 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:25:19.669216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:19.669513 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:25:19.669762 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:25:19.670080 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model top_10_customers_by_revenue (models/marts/sales_reporting/top_10_customers_by_revenue.sql)
    syntax error at or near "limit"
    LINE 13:   limit 5
               ^
[0m21:25:19.671400 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 1.5086114, "process_user_time": 1.017024, "process_kernel_time": 0.147032, "process_mem_max_rss": "122847232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:25:19.671794 [debug] [MainThread]: Command `dbt show` failed at 21:25:19.671732 after 1.51 seconds
[0m21:25:19.672064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105840260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d2490>]}
[0m21:25:19.672352 [debug] [MainThread]: Flushing usage events
[0m21:25:19.676573 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:26:15.565348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd7ed0>]}


============================== 21:26:15.569019 | 2cc99fe5-7190-4ac7-b9b5-24a93597b1d2 ==============================
[0m21:26:15.569019 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:26:15.569363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:15.619725 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:26:15.620064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0c510>]}
[0m21:26:15.669426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adfce0>]}
[0m21:26:15.697196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9fa50>]}
[0m21:26:15.697874 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:26:15.708744 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:26:15.780802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:15.781210 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/top_10_customers_by_revenue.sql
[0m21:26:15.898967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:26:15.905993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3b020>]}
[0m21:26:15.962035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c151d0>]}
[0m21:26:15.962370 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:26:15.962598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b35570>]}
[0m21:26:15.963832 [info ] [MainThread]: 
[0m21:26:15.964195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:15.966407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:26:15.999913 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:26:16.000220 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:26:16.000394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:16.572295 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.572 seconds
[0m21:26:16.573729 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:26:16.575369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m21:26:16.575807 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:26:16.581582 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:26:16.583023 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:26:16.583329 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:26:16.583544 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:26:16.583729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:16.583915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:16.882268 [debug] [ThreadPool]: SQL status: BEGIN in 0.298 seconds
[0m21:26:16.883776 [debug] [ThreadPool]: SQL status: BEGIN in 0.300 seconds
[0m21:26:16.884628 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:26:16.885178 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:26:16.885895 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:26:16.886642 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:26:16.922208 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m21:26:16.923463 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.036 seconds
[0m21:26:16.926275 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:26:16.927414 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:26:16.957721 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:26:16.958261 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:26:16.967070 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:16.967337 [debug] [MainThread]: On master: BEGIN
[0m21:26:16.967521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:17.281642 [debug] [MainThread]: SQL status: BEGIN in 0.314 seconds
[0m21:26:17.282482 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:17.283352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:17.327160 [debug] [MainThread]: SQL status: SELECT 3 in 0.043 seconds
[0m21:26:17.330998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b87b90>]}
[0m21:26:17.331916 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:17.365748 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:17.366734 [debug] [MainThread]: On master: BEGIN
[0m21:26:17.429736 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m21:26:17.430529 [debug] [MainThread]: On master: COMMIT
[0m21:26:17.430925 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:17.431305 [debug] [MainThread]: On master: COMMIT
[0m21:26:17.465793 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m21:26:17.466987 [debug] [MainThread]: On master: Close
[0m21:26:17.468911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:17.469768 [info ] [MainThread]: 
[0m21:26:17.472312 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:26:17.472659 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:26:17.472901 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:26:17.473210 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m21:26:17.473583 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_products ............................... [RUN]
[0m21:26:17.473937 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m21:26:17.474252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m21:26:17.474495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m21:26:17.474744 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:26:17.474961 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:26:17.475216 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:26:17.475493 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:26:17.479535 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:26:17.481186 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:26:17.482404 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:26:17.483146 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:26:17.489276 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:26:17.495917 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:26:17.512825 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:26:17.514312 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:26:17.516217 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:26:17.516847 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:17.517030 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:26:17.517192 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:26:17.517547 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:17.517741 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:26:17.517941 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:17.518209 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:17.518372 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:26:17.518515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:17.818372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.299 seconds
[0m21:26:17.820299 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:17.821135 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:26:17.828295 [debug] [Thread-3 (]: SQL status: BEGIN in 0.311 seconds
[0m21:26:17.829199 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:17.829949 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:26:17.836025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.318 seconds
[0m21:26:17.837015 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:17.838108 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:26:17.880905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.058 seconds
[0m21:26:17.889645 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:17.889968 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:26:17.898834 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m21:26:17.899091 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.069 seconds
[0m21:26:17.901314 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:17.903130 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:17.903379 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:26:17.903604 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:26:17.923950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:17.929228 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:17.929500 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:26:17.940545 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:26:17.941637 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m21:26:17.945583 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:17.947232 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:17.947475 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:26:17.947697 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:26:17.962027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:26:17.979779 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:26:17.980309 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:26:17.980731 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:17.981085 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:17.982512 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:26:17.983939 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:26:17.984328 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:26:17.984653 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:17.984957 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:17.985404 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:26:17.985757 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:26:18.019944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m21:26:18.025908 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:26:18.026313 [debug] [Thread-3 (]: SQL status: COMMIT in 0.040 seconds
[0m21:26:18.026560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.040 seconds
[0m21:26:18.030016 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:26:18.031244 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:26:18.032307 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:26:18.032527 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:26:18.032824 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:26:18.033100 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:26:18.033441 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:26:18.033753 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:26:18.069237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.036 seconds
[0m21:26:18.071392 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:26:18.071685 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.038 seconds
[0m21:26:18.071947 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.038 seconds
[0m21:26:18.072939 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:26:18.074043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbc940>]}
[0m21:26:18.075373 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:26:18.075921 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.60s]
[0m21:26:18.076293 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107070550>]}
[0m21:26:18.076880 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:26:18.077452 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.60s]
[0m21:26:18.077883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5d450>]}
[0m21:26:18.078476 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:26:18.078915 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.60s]
[0m21:26:18.079486 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:26:18.079764 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:26:18.079993 [debug] [Thread-4 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:26:18.080222 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:26:18.080423 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:26:18.080811 [info ] [Thread-3 (]: 6 of 11 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:26:18.081198 [info ] [Thread-4 (]: 4 of 11 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:26:18.081509 [info ] [Thread-2 (]: 7 of 11 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:26:18.081798 [info ] [Thread-1 (]: 5 of 11 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:26:18.082102 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m21:26:18.082385 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.customer_lifetime_value'
[0m21:26:18.082600 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.orders_by_customer)
[0m21:26:18.082854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_order_frequency)
[0m21:26:18.083110 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:26:18.083350 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:26:18.083544 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:26:18.083770 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:26:18.086321 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.088052 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.089458 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:26:18.091006 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.091786 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:26:18.092126 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:26:18.092417 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:26:18.092694 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:26:18.116401 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:26:18.117603 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.119268 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.120930 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.121704 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.122025 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.122246 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.122439 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:26:18.122620 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.122842 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:26:18.123080 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:26:18.123306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:18.123531 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:26:18.123712 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:18.123896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:18.124144 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:26:18.433816 [debug] [Thread-2 (]: SQL status: BEGIN in 0.310 seconds
[0m21:26:18.434227 [debug] [Thread-4 (]: SQL status: BEGIN in 0.310 seconds
[0m21:26:18.434472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.311 seconds
[0m21:26:18.434690 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.434997 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.435310 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.435575 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:26:18.435827 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:26:18.436079 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(order_date) as first_order,
    MAX(order_date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:26:18.446674 [debug] [Thread-3 (]: SQL status: BEGIN in 0.323 seconds
[0m21:26:18.447592 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.448350 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:26:18.500578 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.063 seconds
[0m21:26:18.505223 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.505476 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency" rename to "customer_order_frequency__dbt_backup"
[0m21:26:18.515076 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.078 seconds
[0m21:26:18.520270 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.520539 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:26:18.522263 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.073 seconds
[0m21:26:18.524318 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.524589 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:26:18.526054 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.090 seconds
[0m21:26:18.527755 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.527997 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:26:18.538461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:26:18.544071 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.544348 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp" rename to "customer_order_frequency"
[0m21:26:18.554474 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:18.555350 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:26:18.559876 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.561575 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.561886 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:26:18.562120 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:26:18.562349 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:26:18.564006 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.564569 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:26:18.578042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:18.583312 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:26:18.583712 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.584049 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:26:18.593993 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:26:18.594327 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:26:18.595384 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:26:18.595635 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:26:18.596892 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:26:18.597142 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.597970 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:26:18.598219 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.598454 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:26:18.598668 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.598869 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:26:18.599116 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:26:18.618198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m21:26:18.619602 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup"
[0m21:26:18.621654 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:26:18.621897 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup" cascade
[0m21:26:18.630727 [debug] [Thread-2 (]: SQL status: COMMIT in 0.032 seconds
[0m21:26:18.631999 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:26:18.632339 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:26:18.632594 [debug] [Thread-3 (]: SQL status: COMMIT in 0.033 seconds
[0m21:26:18.632828 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:26:18.633043 [debug] [Thread-4 (]: SQL status: COMMIT in 0.034 seconds
[0m21:26:18.637678 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:26:18.639171 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:26:18.639556 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:26:18.639869 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:26:18.640093 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:26:18.640314 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:26:18.657039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m21:26:18.658615 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:26:18.659340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f1860>]}
[0m21:26:18.659984 [info ] [Thread-1 (]: 5 of 11 OK created sql table model public.customer_order_frequency ............. [[32mSELECT 642[0m in 0.58s]
[0m21:26:18.660566 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:26:18.660948 [debug] [Thread-1 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:26:18.661303 [info ] [Thread-1 (]: 8 of 11 START sql table model public.orders_by_day ............................. [RUN]
[0m21:26:18.661646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.orders_by_day)
[0m21:26:18.661885 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:26:18.663461 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:26:18.663986 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:26:18.704518 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.066 seconds
[0m21:26:18.706434 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:26:18.706650 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.066 seconds
[0m21:26:18.707427 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:26:18.707612 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.067 seconds
[0m21:26:18.708592 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:26:18.709493 [debug] [Thread-4 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:26:18.709804 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb7dd0>]}
[0m21:26:18.710123 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:18.710458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb69f0>]}
[0m21:26:18.710700 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad08f0>]}
[0m21:26:18.710902 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:26:18.711276 [info ] [Thread-2 (]: 7 of 11 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.63s]
[0m21:26:18.711680 [info ] [Thread-4 (]: 4 of 11 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.63s]
[0m21:26:18.712061 [info ] [Thread-3 (]: 6 of 11 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.63s]
[0m21:26:18.712280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:18.712628 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:26:18.712939 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:26:18.713245 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:26:18.713567 [debug] [Thread-2 (]: Began running node model.ecommerce_project.product_performance
[0m21:26:18.713826 [debug] [Thread-4 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:18.714116 [debug] [Thread-3 (]: Began running node model.ecommerce_project.category_performance
[0m21:26:18.714420 [info ] [Thread-2 (]: 9 of 11 START sql table model public.product_performance ....................... [RUN]
[0m21:26:18.714708 [info ] [Thread-4 (]: 10 of 11 START sql table model public.top_10_customers_by_revenue .............. [RUN]
[0m21:26:18.714996 [info ] [Thread-3 (]: 11 of 11 START sql table model public.category_performance ..................... [RUN]
[0m21:26:18.715271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.orders_by_customer, now model.ecommerce_project.product_performance)
[0m21:26:18.715535 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:26:18.715779 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.category_performance)
[0m21:26:18.715996 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:26:18.716199 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:18.716408 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:26:18.717764 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:26:18.719200 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:18.721135 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:26:18.721661 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.product_performance
[0m21:26:18.723297 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:26:18.723563 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:18.725451 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:18.725752 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.category_performance
[0m21:26:18.727138 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:26:18.727534 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:18.727782 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:18.728084 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: BEGIN
[0m21:26:18.728333 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:26:18.728563 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:18.728751 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:26:18.728956 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:26:18.729165 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:26:18.729498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:26:19.020068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.291 seconds
[0m21:26:19.020437 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:19.020921 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
-- LIMIT 10
  );
  
[0m21:26:19.025795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.297 seconds
[0m21:26:19.026131 [debug] [Thread-3 (]: SQL status: BEGIN in 0.297 seconds
[0m21:26:19.026401 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:19.026718 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:19.027011 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:26:19.027303 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:26:19.040696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.328 seconds
[0m21:26:19.041529 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:19.042147 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:26:19.123942 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.096 seconds
[0m21:26:19.125045 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.097 seconds
[0m21:26:19.131108 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:19.131407 [debug] [Thread-4 (]: SQL status: SELECT 642 in 0.110 seconds
[0m21:26:19.133658 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:19.133940 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:26:19.135628 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:19.135871 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:26:19.136173 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue" rename to "top_10_customers_by_revenue__dbt_backup"
[0m21:26:19.141017 [debug] [Thread-1 (]: SQL status: SELECT 282 in 0.098 seconds
[0m21:26:19.142979 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:19.143272 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:26:19.166788 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:26:19.167879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:26:19.171335 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:19.171593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:26:19.173292 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:19.173541 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:26:19.175331 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:19.175604 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:26:19.175878 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp" rename to "top_10_customers_by_revenue"
[0m21:26:19.176146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:19.177719 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:19.177968 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:26:19.207561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:26:19.208028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:26:19.208951 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:26:19.209169 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:26:19.209360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:26:19.210177 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:26:19.210398 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:19.211208 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:26:19.212351 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:26:19.212716 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:19.212961 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:26:19.213208 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:19.213463 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:19.213714 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:26:19.213969 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:26:19.214188 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:26:19.246784 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m21:26:19.251892 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:26:19.252589 [debug] [Thread-3 (]: SQL status: COMMIT in 0.038 seconds
[0m21:26:19.253140 [debug] [Thread-4 (]: SQL status: COMMIT in 0.039 seconds
[0m21:26:19.253500 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:26:19.253702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.039 seconds
[0m21:26:19.254979 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:26:19.256189 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup"
[0m21:26:19.256428 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:26:19.257740 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:26:19.258065 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:26:19.258367 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:19.258713 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:26:19.258958 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:26:19.259170 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
drop table if exists "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup" cascade
[0m21:26:19.259383 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:26:19.294874 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.036 seconds
[0m21:26:19.298726 [debug] [Thread-2 (]: On model.ecommerce_project.product_performance: Close
[0m21:26:19.300030 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.040 seconds
[0m21:26:19.302393 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:26:19.302936 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.043 seconds
[0m21:26:19.303388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e7650>]}
[0m21:26:19.303615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:26:19.304714 [debug] [Thread-3 (]: On model.ecommerce_project.category_performance: Close
[0m21:26:19.305008 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df0110>]}
[0m21:26:19.306643 [debug] [Thread-1 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:26:19.305440 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public.product_performance .................. [[32mSELECT 4[0m in 0.59s]
[0m21:26:19.307378 [info ] [Thread-4 (]: 10 of 11 OK created sql table model public.top_10_customers_by_revenue ......... [[32mSELECT 642[0m in 0.59s]
[0m21:26:19.307729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0e2d0>]}
[0m21:26:19.308151 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.product_performance
[0m21:26:19.308424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc99fe5-7190-4ac7-b9b5-24a93597b1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df0410>]}
[0m21:26:19.308820 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:19.309185 [info ] [Thread-3 (]: 11 of 11 OK created sql table model public.category_performance ................ [[32mSELECT 2[0m in 0.59s]
[0m21:26:19.309626 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.65s]
[0m21:26:19.310112 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.category_performance
[0m21:26:19.310425 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:26:19.311499 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:19.311743 [debug] [MainThread]: On master: BEGIN
[0m21:26:19.311926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:19.624007 [debug] [MainThread]: SQL status: BEGIN in 0.312 seconds
[0m21:26:19.625098 [debug] [MainThread]: On master: COMMIT
[0m21:26:19.625554 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:19.625997 [debug] [MainThread]: On master: COMMIT
[0m21:26:19.664459 [debug] [MainThread]: SQL status: COMMIT in 0.038 seconds
[0m21:26:19.665449 [debug] [MainThread]: On master: Close
[0m21:26:19.667518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:19.668282 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:26:19.668684 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:26:19.669050 [debug] [MainThread]: Connection 'model.ecommerce_project.category_performance' was properly closed.
[0m21:26:19.669413 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:26:19.670239 [info ] [MainThread]: 
[0m21:26:19.671144 [info ] [MainThread]: Finished running 3 view models, 8 table models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m21:26:19.674451 [debug] [MainThread]: Command end result
[0m21:26:19.701547 [info ] [MainThread]: 
[0m21:26:19.701920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:19.702299 [info ] [MainThread]: 
[0m21:26:19.702575 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m21:26:19.704192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1825137, "process_user_time": 1.629154, "process_kernel_time": 0.225968, "process_mem_max_rss": "127959040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:19.704571 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:19.704505 after 4.18 seconds
[0m21:26:19.704833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107167950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071678f0>]}
[0m21:26:19.705080 [debug] [MainThread]: Flushing usage events
[0m21:26:19.947989 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:26:23.375350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7b3ed0>]}


============================== 21:26:23.378208 | 3dbcd772-7db2-45a7-8865-15cd7a59b8bf ==============================
[0m21:26:23.378208 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:26:23.378582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt show --select top_10_customers_by_revenue', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:26:23.415993 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:26:23.416325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8e8510>]}
[0m21:26:23.465721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1f7ce0>]}
[0m21:26:23.494438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a6b3a50>]}
[0m21:26:23.494978 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:26:23.504146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:26:23.569240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:23.569503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:23.572681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:26:23.593994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adfa210>]}
[0m21:26:23.650963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8a0210>]}
[0m21:26:23.651317 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:26:23.651538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a843ee0>]}
[0m21:26:23.652624 [info ] [MainThread]: 
[0m21:26:23.653080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:23.655475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:26:23.655816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:26:23.690003 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:26:23.690288 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:26:23.690460 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:26:23.690628 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:26:23.690794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:23.690949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:23.994088 [debug] [ThreadPool]: SQL status: BEGIN in 0.303 seconds
[0m21:26:23.994998 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:26:23.995546 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:26:24.012154 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m21:26:24.012882 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:26:24.013428 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:26:24.033936 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.036 seconds
[0m21:26:24.038602 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:26:24.047615 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.033 seconds
[0m21:26:24.050979 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:26:24.070049 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:26:24.088084 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:26:24.100900 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:24.101357 [debug] [MainThread]: On master: BEGIN
[0m21:26:24.101682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:24.393977 [debug] [MainThread]: SQL status: BEGIN in 0.292 seconds
[0m21:26:24.396451 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:24.397169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:24.438882 [debug] [MainThread]: SQL status: SELECT 3 in 0.041 seconds
[0m21:26:24.442710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dbcd772-7db2-45a7-8865-15cd7a59b8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b716c90>]}
[0m21:26:24.443499 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:24.473508 [debug] [MainThread]: On master: Close
[0m21:26:24.476216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:24.477056 [info ] [MainThread]: 
[0m21:26:24.480670 [debug] [Thread-1 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:24.481083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:26:24.481334 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:24.491029 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:24.491760 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:24.496544 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:26:24.496819 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
  SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
-- LIMIT 10
  
  limit 5

[0m21:26:24.497054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:24.805725 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.308 seconds
[0m21:26:24.811000 [debug] [Thread-1 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:26:24.811848 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:26:24.813086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:24.813293 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:26:24.813473 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_public' was properly closed.
[0m21:26:24.813903 [debug] [MainThread]: Command end result
[0m21:26:24.839149 [info ] [MainThread]: Previewing node 'top_10_customers_by_revenue':
| customer_id | total_orders | total_revenue |
| ----------- | ------------ | ------------- |
|         252 |            5 |      3,809.58 |
|          14 |            4 |      3,316.07 |
|         216 |            4 |      2,848.88 |
|          32 |            4 |      2,777.22 |
|         352 |            3 |      2,640.54 |

[0m21:26:24.840661 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.5054743, "process_user_time": 1.053883, "process_kernel_time": 0.146035, "process_mem_max_rss": "122961920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:24.841143 [debug] [MainThread]: Command `dbt show` succeeded at 21:26:24.841065 after 1.51 seconds
[0m21:26:24.841441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b5f2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bacddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bacdf90>]}
[0m21:26:24.841699 [debug] [MainThread]: Flushing usage events
[0m21:26:24.846759 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:27:01.212795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698bed0>]}


============================== 21:27:01.215441 | c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05 ==============================
[0m21:27:01.215441 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:01.216006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:27:01.252405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:27:01.252688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac0510>]}
[0m21:27:01.303168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106693ce0>]}
[0m21:27:01.331488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674fa50>]}
[0m21:27:01.332064 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:27:01.342505 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:01.406822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:01.407265 [debug] [MainThread]: Partial parsing: updated file: ecommerce_project://models/marts/sales_reporting/top_10_customers_by_revenue.sql
[0m21:27:01.529787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:27:01.536629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ef020>]}
[0m21:27:01.589576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cd1d0>]}
[0m21:27:01.589883 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:27:01.590060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e9570>]}
[0m21:27:01.591211 [info ] [MainThread]: 
[0m21:27:01.591520 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:01.593682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:27:01.622701 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:27:01.623023 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:27:01.623293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:02.080093 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.457 seconds
[0m21:27:02.081260 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:27:02.082979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_snapshots)
[0m21:27:02.087683 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:02.088091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_public'
[0m21:27:02.088352 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:27:02.089443 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:02.089646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:02.089818 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:27:02.090209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:02.406927 [debug] [ThreadPool]: SQL status: BEGIN in 0.317 seconds
[0m21:27:02.407284 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:02.407502 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:27:02.415151 [debug] [ThreadPool]: SQL status: BEGIN in 0.325 seconds
[0m21:27:02.415545 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:02.415775 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:27:02.442485 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.035 seconds
[0m21:27:02.443843 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:27:02.450353 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.034 seconds
[0m21:27:02.451448 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:27:02.474705 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:27:02.483294 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:27:02.488976 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:02.489387 [debug] [MainThread]: On master: BEGIN
[0m21:27:02.489670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:02.824957 [debug] [MainThread]: SQL status: BEGIN in 0.335 seconds
[0m21:27:02.825313 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:02.825599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:02.875139 [debug] [MainThread]: SQL status: SELECT 3 in 0.049 seconds
[0m21:27:02.877307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773b890>]}
[0m21:27:02.877788 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:02.916939 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:02.917236 [debug] [MainThread]: On master: BEGIN
[0m21:27:02.988977 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m21:27:02.989452 [debug] [MainThread]: On master: COMMIT
[0m21:27:02.989762 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:02.990046 [debug] [MainThread]: On master: COMMIT
[0m21:27:03.029000 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m21:27:03.029339 [debug] [MainThread]: On master: Close
[0m21:27:03.029896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:03.030186 [info ] [MainThread]: 
[0m21:27:03.032029 [debug] [Thread-2 (]: Began running node model.ecommerce_project.stg_products
[0m21:27:03.032679 [debug] [Thread-3 (]: Began running node model.ecommerce_project.stg_sales
[0m21:27:03.032438 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_products ............................... [RUN]
[0m21:27:03.033059 [debug] [Thread-1 (]: Began running node model.ecommerce_project.stg_customers
[0m21:27:03.033415 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m21:27:03.033773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now model.ecommerce_project.stg_products)
[0m21:27:03.034141 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m21:27:03.034549 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_project.stg_sales'
[0m21:27:03.034773 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.stg_products
[0m21:27:03.035099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_snapshots, now model.ecommerce_project.stg_customers)
[0m21:27:03.035411 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.stg_sales
[0m21:27:03.040366 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.stg_products"
[0m21:27:03.040668 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.stg_customers
[0m21:27:03.042288 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.stg_sales"
[0m21:27:03.043969 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.stg_customers"
[0m21:27:03.044549 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.stg_products
[0m21:27:03.068188 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.stg_products"
[0m21:27:03.068680 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.stg_customers
[0m21:27:03.068947 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.stg_sales
[0m21:27:03.070656 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.stg_customers"
[0m21:27:03.072547 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.stg_sales"
[0m21:27:03.072847 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.073210 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: BEGIN
[0m21:27:03.073412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:03.073745 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.073960 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.074158 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: BEGIN
[0m21:27:03.074368 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: BEGIN
[0m21:27:03.074547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:27:03.074722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:03.373191 [debug] [Thread-2 (]: SQL status: BEGIN in 0.300 seconds
[0m21:27:03.373588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.299 seconds
[0m21:27:03.373837 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.374061 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.374281 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */

  create view "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp"
    
    
  as (
    WITH raw_products AS (
    SELECT
        product_id,
        product_name,
        category,
        price
    FROM "d9snqvovhsjpqs"."public"."products"
)
SELECT
    product_id,
    product_name,
    category,
    price::decimal AS price
FROM raw_products
  );
[0m21:27:03.374501 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */

  create view "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp"
    
    
  as (
    WITH raw_customers AS (
    SELECT
        customer_id,
        first_name,
        last_name,
        email,
        address,
        city,
        state,
        postal_code
    FROM "d9snqvovhsjpqs"."public"."customers"
)
SELECT
    customer_id,
    first_name,
    last_name,
    email,
    state
FROM raw_customers
  );
[0m21:27:03.381029 [debug] [Thread-3 (]: SQL status: BEGIN in 0.306 seconds
[0m21:27:03.381369 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.381748 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */

  create view "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp"
    
    
  as (
    WITH raw_sales AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        order_date,
        quantity,
        total_price
    FROM "d9snqvovhsjpqs"."public"."sales"
)
SELECT
    order_id,
    customer_id,
    product_id,
    order_date::date AS order_date,
    quantity::int AS quantity,
    total_price::decimal AS total_price
FROM raw_sales
  );
[0m21:27:03.424850 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m21:27:03.429354 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.429695 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m21:27:03.429989 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m21:27:03.431957 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.432415 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m21:27:03.437182 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.055 seconds
[0m21:27:03.439575 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.439860 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:27:03.461468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:27:03.461765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:27:03.463761 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.465319 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.465542 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
alter table "d9snqvovhsjpqs"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:27:03.465745 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
alter table "d9snqvovhsjpqs"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m21:27:03.469437 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m21:27:03.471447 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.471721 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
alter table "d9snqvovhsjpqs"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:27:03.497787 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:27:03.498118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:27:03.508950 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:27:03.509782 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:27:03.510063 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.038 seconds
[0m21:27:03.510386 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.510600 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.511468 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:27:03.511670 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: COMMIT
[0m21:27:03.511843 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: COMMIT
[0m21:27:03.512023 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.512334 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: COMMIT
[0m21:27:03.546475 [debug] [Thread-3 (]: SQL status: COMMIT in 0.034 seconds
[0m21:27:03.546790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.035 seconds
[0m21:27:03.546993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m21:27:03.550963 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup"
[0m21:27:03.552065 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup"
[0m21:27:03.553002 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."stg_products__dbt_backup"
[0m21:27:03.555589 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.stg_sales"
[0m21:27:03.555874 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.stg_customers"
[0m21:27:03.556131 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.stg_products"
[0m21:27:03.556312 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_sales"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_sales__dbt_backup" cascade
[0m21:27:03.556488 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_customers"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_customers__dbt_backup" cascade
[0m21:27:03.556659 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.stg_products"} */
drop view if exists "d9snqvovhsjpqs"."public"."stg_products__dbt_backup" cascade
[0m21:27:03.589001 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.032 seconds
[0m21:27:03.589319 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.032 seconds
[0m21:27:03.590946 [debug] [Thread-2 (]: On model.ecommerce_project.stg_products: Close
[0m21:27:03.591160 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.034 seconds
[0m21:27:03.592081 [debug] [Thread-1 (]: On model.ecommerce_project.stg_customers: Close
[0m21:27:03.592971 [debug] [Thread-3 (]: On model.ecommerce_project.stg_sales: Close
[0m21:27:03.594032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b70890>]}
[0m21:27:03.594290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8c550>]}
[0m21:27:03.595002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac2cc0>]}
[0m21:27:03.594713 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.56s]
[0m21:27:03.595405 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.56s]
[0m21:27:03.595746 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.56s]
[0m21:27:03.596065 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.stg_products
[0m21:27:03.596336 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.stg_customers
[0m21:27:03.596599 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.stg_sales
[0m21:27:03.597190 [debug] [Thread-2 (]: Began running node model.ecommerce_project.customer_lifetime_value
[0m21:27:03.597431 [debug] [Thread-4 (]: Began running node model.ecommerce_project.category_performance
[0m21:27:03.597613 [debug] [Thread-3 (]: Began running node model.ecommerce_project.monthly_revenue_orders
[0m21:27:03.597847 [info ] [Thread-2 (]: 5 of 11 START sql table model public.customer_lifetime_value ................... [RUN]
[0m21:27:03.598179 [info ] [Thread-4 (]: 4 of 11 START sql table model public.category_performance ...................... [RUN]
[0m21:27:03.598465 [debug] [Thread-1 (]: Began running node model.ecommerce_project.customer_order_frequency
[0m21:27:03.598711 [info ] [Thread-3 (]: 7 of 11 START sql table model public.monthly_revenue_orders .................... [RUN]
[0m21:27:03.598942 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_products, now model.ecommerce_project.customer_lifetime_value)
[0m21:27:03.599184 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_project.category_performance'
[0m21:27:03.599412 [info ] [Thread-1 (]: 6 of 11 START sql table model public.customer_order_frequency .................. [RUN]
[0m21:27:03.599619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_sales, now model.ecommerce_project.monthly_revenue_orders)
[0m21:27:03.599806 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.customer_lifetime_value
[0m21:27:03.599979 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.category_performance
[0m21:27:03.600156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.stg_customers, now model.ecommerce_project.customer_order_frequency)
[0m21:27:03.600331 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.monthly_revenue_orders
[0m21:27:03.602026 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.customer_lifetime_value"
[0m21:27:03.603361 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.category_performance"
[0m21:27:03.603562 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.customer_order_frequency
[0m21:27:03.604667 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:03.606237 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.customer_order_frequency"
[0m21:27:03.606852 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.monthly_revenue_orders
[0m21:27:03.607162 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.customer_lifetime_value
[0m21:27:03.613453 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.category_performance
[0m21:27:03.619605 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:03.621685 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.customer_lifetime_value"
[0m21:27:03.621941 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.customer_order_frequency
[0m21:27:03.623659 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.category_performance"
[0m21:27:03.625506 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.customer_order_frequency"
[0m21:27:03.626092 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:03.626368 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: BEGIN
[0m21:27:03.626563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:27:03.626897 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:03.627121 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: BEGIN
[0m21:27:03.627300 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:03.627726 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:03.627940 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: BEGIN
[0m21:27:03.628107 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:27:03.628390 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:03.628623 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: BEGIN
[0m21:27:03.628807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:03.936595 [debug] [Thread-2 (]: SQL status: BEGIN in 0.309 seconds
[0m21:27:03.936958 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:03.937196 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp"
  
  
    as
  
  (
    WITH customer_revenue AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(total_price) AS total_revenue,
        AVG(total_price) AS avg_order_value
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
    GROUP BY customer_id
)
SELECT
    customer_id,
    total_orders,
    total_revenue,
    avg_order_value
FROM customer_revenue
ORDER BY total_revenue DESC
  );
  
[0m21:27:03.955418 [debug] [Thread-4 (]: SQL status: BEGIN in 0.327 seconds
[0m21:27:03.955774 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:03.956013 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    stg_products.category as category,
    SUM(stg_sales.quantity) as total_sales,
    SUM(stg_sales.total_price) as total_revenue,
    AVG(stg_sales.total_price) as avg_price
FROM "d9snqvovhsjpqs"."public"."stg_products" as stg_products
INNER JOIN "d9snqvovhsjpqs"."public"."stg_sales" as stg_sales
ON stg_products.product_id = stg_sales.product_id
GROUP BY category
  );
  
[0m21:27:03.960947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.334 seconds
[0m21:27:03.961229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.332 seconds
[0m21:27:03.961465 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:03.961681 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:03.961903 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp"
  
  
    as
  
  (
    SELECT
    TO_CHAR(DATE_TRUNC('month', order_date), 'YYYY-MM') as month,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY month
ORDER BY month DESC
  );
  
[0m21:27:03.962143 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    MIN(order_date) as first_order,
    MAX(order_date) as last_order,
    AVG(order_date - prior_date)
FROM (
    SELECT
        customer_id,
        order_id,
        order_date,
        LAG(order_date, 1) OVER (PARTITION BY customer_id ORDER BY order_date) as prior_date
    FROM "d9snqvovhsjpqs"."public"."stg_sales"
)
GROUP BY customer_id
  );
  
[0m21:27:04.053250 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.116 seconds
[0m21:27:04.055065 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:04.055302 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value" rename to "customer_lifetime_value__dbt_backup"
[0m21:27:04.069395 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.107 seconds
[0m21:27:04.071582 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:04.071869 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders" rename to "monthly_revenue_orders__dbt_backup"
[0m21:27:04.088990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.091006 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:04.091241 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
alter table "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_tmp" rename to "customer_lifetime_value"
[0m21:27:04.096554 [debug] [Thread-4 (]: SQL status: SELECT 2 in 0.140 seconds
[0m21:27:04.098899 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:04.099308 [debug] [Thread-1 (]: SQL status: SELECT 642 in 0.137 seconds
[0m21:27:04.099627 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance" rename to "category_performance__dbt_backup"
[0m21:27:04.101861 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:04.102196 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency" rename to "customer_order_frequency__dbt_backup"
[0m21:27:04.104979 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.107254 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:04.107594 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
alter table "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_tmp" rename to "monthly_revenue_orders"
[0m21:27:04.124940 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.128571 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:27:04.128865 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:04.129066 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: COMMIT
[0m21:27:04.133232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:27:04.135066 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:04.135336 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
alter table "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_tmp" rename to "customer_order_frequency"
[0m21:27:04.135585 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.137265 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:04.137514 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
alter table "d9snqvovhsjpqs"."public"."category_performance__dbt_tmp" rename to "category_performance"
[0m21:27:04.141158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.142345 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:27:04.142612 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:04.142837 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: COMMIT
[0m21:27:04.167857 [debug] [Thread-2 (]: SQL status: COMMIT in 0.039 seconds
[0m21:27:04.169557 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup"
[0m21:27:04.171624 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.customer_lifetime_value"
[0m21:27:04.171883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:27:04.172109 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_lifetime_value"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_lifetime_value__dbt_backup" cascade
[0m21:27:04.173073 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:27:04.173364 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:04.173630 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: COMMIT
[0m21:27:04.173992 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.036 seconds
[0m21:27:04.174963 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:27:04.175211 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:04.175423 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: COMMIT
[0m21:27:04.179539 [debug] [Thread-3 (]: SQL status: COMMIT in 0.036 seconds
[0m21:27:04.180865 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup"
[0m21:27:04.181203 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.monthly_revenue_orders"
[0m21:27:04.181461 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.monthly_revenue_orders"} */
drop table if exists "d9snqvovhsjpqs"."public"."monthly_revenue_orders__dbt_backup" cascade
[0m21:27:04.210730 [debug] [Thread-4 (]: SQL status: COMMIT in 0.035 seconds
[0m21:27:04.215407 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."category_performance__dbt_backup"
[0m21:27:04.215720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.041 seconds
[0m21:27:04.216177 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.category_performance"
[0m21:27:04.217656 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup"
[0m21:27:04.217928 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.category_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."category_performance__dbt_backup" cascade
[0m21:27:04.218296 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.customer_order_frequency"
[0m21:27:04.218621 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.customer_order_frequency"} */
drop table if exists "d9snqvovhsjpqs"."public"."customer_order_frequency__dbt_backup" cascade
[0m21:27:04.224423 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.051 seconds
[0m21:27:04.225493 [debug] [Thread-2 (]: On model.ecommerce_project.customer_lifetime_value: Close
[0m21:27:04.225726 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.044 seconds
[0m21:27:04.226692 [debug] [Thread-3 (]: On model.ecommerce_project.monthly_revenue_orders: Close
[0m21:27:04.227024 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d20910>]}
[0m21:27:04.227851 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6b710>]}
[0m21:27:04.227531 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public.customer_lifetime_value .............. [[32mSELECT 642[0m in 0.63s]
[0m21:27:04.228331 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public.monthly_revenue_orders ............... [[32mSELECT 10[0m in 0.63s]
[0m21:27:04.228735 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.customer_lifetime_value
[0m21:27:04.229039 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.monthly_revenue_orders
[0m21:27:04.229304 [debug] [Thread-2 (]: Began running node model.ecommerce_project.orders_by_customer
[0m21:27:04.229581 [debug] [Thread-3 (]: Began running node model.ecommerce_project.orders_by_day
[0m21:27:04.229895 [info ] [Thread-2 (]: 8 of 11 START sql table model public.orders_by_customer ........................ [RUN]
[0m21:27:04.230298 [info ] [Thread-3 (]: 9 of 11 START sql table model public.orders_by_day ............................. [RUN]
[0m21:27:04.230724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_lifetime_value, now model.ecommerce_project.orders_by_customer)
[0m21:27:04.230979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.monthly_revenue_orders, now model.ecommerce_project.orders_by_day)
[0m21:27:04.231209 [debug] [Thread-2 (]: Began compiling node model.ecommerce_project.orders_by_customer
[0m21:27:04.231420 [debug] [Thread-3 (]: Began compiling node model.ecommerce_project.orders_by_day
[0m21:27:04.233005 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_customer"
[0m21:27:04.234368 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_project.orders_by_day"
[0m21:27:04.235009 [debug] [Thread-2 (]: Began executing node model.ecommerce_project.orders_by_customer
[0m21:27:04.274077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.055 seconds
[0m21:27:04.274414 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.056 seconds
[0m21:27:04.276044 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_customer"
[0m21:27:04.276804 [debug] [Thread-1 (]: On model.ecommerce_project.customer_order_frequency: Close
[0m21:27:04.276985 [debug] [Thread-3 (]: Began executing node model.ecommerce_project.orders_by_day
[0m21:27:04.277595 [debug] [Thread-4 (]: On model.ecommerce_project.category_performance: Close
[0m21:27:04.279203 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_project.orders_by_day"
[0m21:27:04.279503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3410>]}
[0m21:27:04.280208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd3410>]}
[0m21:27:04.279941 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public.customer_order_frequency ............. [[32mSELECT 642[0m in 0.68s]
[0m21:27:04.280927 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.customer_order_frequency
[0m21:27:04.281173 [debug] [Thread-1 (]: Began running node model.ecommerce_project.product_performance
[0m21:27:04.280505 [info ] [Thread-4 (]: 4 of 11 OK created sql table model public.category_performance ................. [[32mSELECT 2[0m in 0.68s]
[0m21:27:04.281473 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.281694 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.281981 [info ] [Thread-1 (]: 10 of 11 START sql table model public.product_performance ...................... [RUN]
[0m21:27:04.282290 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.category_performance
[0m21:27:04.282485 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: BEGIN
[0m21:27:04.282669 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: BEGIN
[0m21:27:04.283180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.customer_order_frequency, now model.ecommerce_project.product_performance)
[0m21:27:04.283420 [debug] [Thread-4 (]: Began running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:27:04.283618 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:27:04.283798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:27:04.283975 [debug] [Thread-1 (]: Began compiling node model.ecommerce_project.product_performance
[0m21:27:04.284220 [info ] [Thread-4 (]: 11 of 11 START sql table model public.top_10_customers_by_revenue .............. [RUN]
[0m21:27:04.285769 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_project.product_performance"
[0m21:27:04.286085 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.ecommerce_project.category_performance, now model.ecommerce_project.top_10_customers_by_revenue)
[0m21:27:04.286379 [debug] [Thread-4 (]: Began compiling node model.ecommerce_project.top_10_customers_by_revenue
[0m21:27:04.287728 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.288115 [debug] [Thread-1 (]: Began executing node model.ecommerce_project.product_performance
[0m21:27:04.290044 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_project.product_performance"
[0m21:27:04.290341 [debug] [Thread-4 (]: Began executing node model.ecommerce_project.top_10_customers_by_revenue
[0m21:27:04.292059 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.292428 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.292683 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: BEGIN
[0m21:27:04.292859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:04.293179 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.293402 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: BEGIN
[0m21:27:04.293630 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:27:04.591115 [debug] [Thread-3 (]: SQL status: BEGIN in 0.307 seconds
[0m21:27:04.591568 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.591851 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp"
  
  
    as
  
  (
    SELECT
    order_date,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY order_date
ORDER BY order_date
  );
  
[0m21:27:04.596637 [debug] [Thread-4 (]: SQL status: BEGIN in 0.303 seconds
[0m21:27:04.596976 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.597322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.304 seconds
[0m21:27:04.597674 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) as total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
LIMIT 10
  );
  
[0m21:27:04.597963 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.598340 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_id,
    COUNT(order_id) AS total_sales,
    SUM(total_price) AS revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY product_id
ORDER BY revenue DESC
  );
  
[0m21:27:04.606728 [debug] [Thread-2 (]: SQL status: BEGIN in 0.323 seconds
[0m21:27:04.607071 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.607350 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */

  
    

  create  table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_id,
    COUNT(order_id) AS total_orders,
    SUM(total_price) AS total_revenue
FROM "d9snqvovhsjpqs"."public"."stg_sales"
GROUP BY customer_id
ORDER BY total_revenue DESC
  );
  
[0m21:27:04.666005 [debug] [Thread-3 (]: SQL status: SELECT 282 in 0.074 seconds
[0m21:27:04.668263 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.668537 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day" rename to "orders_by_day__dbt_backup"
[0m21:27:04.686548 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.088 seconds
[0m21:27:04.688877 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.689220 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.091 seconds
[0m21:27:04.689505 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:27:04.691264 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.691540 [debug] [Thread-2 (]: SQL status: SELECT 642 in 0.084 seconds
[0m21:27:04.691866 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue" rename to "top_10_customers_by_revenue__dbt_backup"
[0m21:27:04.693697 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.693983 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer" rename to "orders_by_customer__dbt_backup"
[0m21:27:04.699166 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m21:27:04.701110 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.701315 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_day__dbt_tmp" rename to "orders_by_day"
[0m21:27:04.724988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.031 seconds
[0m21:27:04.726681 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.726948 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
alter table "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_tmp" rename to "top_10_customers_by_revenue"
[0m21:27:04.727219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.035 seconds
[0m21:27:04.727473 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.728872 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.730261 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.730454 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
alter table "d9snqvovhsjpqs"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:27:04.730628 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
alter table "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_tmp" rename to "orders_by_customer"
[0m21:27:04.734987 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.735952 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:27:04.736232 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.736441 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: COMMIT
[0m21:27:04.761129 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m21:27:04.762182 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:27:04.762434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m21:27:04.762662 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.763519 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:27:04.763752 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.033 seconds
[0m21:27:04.763994 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: COMMIT
[0m21:27:04.764214 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.765059 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:27:04.765372 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: COMMIT
[0m21:27:04.765667 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.765920 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: COMMIT
[0m21:27:04.775906 [debug] [Thread-3 (]: SQL status: COMMIT in 0.039 seconds
[0m21:27:04.777296 [debug] [Thread-3 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup"
[0m21:27:04.777622 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_project.orders_by_day"
[0m21:27:04.777814 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_day"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_day__dbt_backup" cascade
[0m21:27:04.798062 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m21:27:04.799810 [debug] [Thread-4 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup"
[0m21:27:04.800061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m21:27:04.800474 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_project.top_10_customers_by_revenue"
[0m21:27:04.800690 [debug] [Thread-2 (]: SQL status: COMMIT in 0.035 seconds
[0m21:27:04.801868 [debug] [Thread-1 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."product_performance__dbt_backup"
[0m21:27:04.802121 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.top_10_customers_by_revenue"} */
drop table if exists "d9snqvovhsjpqs"."public"."top_10_customers_by_revenue__dbt_backup" cascade
[0m21:27:04.803365 [debug] [Thread-2 (]: Applying DROP to: "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup"
[0m21:27:04.803636 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_project.product_performance"
[0m21:27:04.803963 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_project.orders_by_customer"
[0m21:27:04.804177 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.product_performance"} */
drop table if exists "d9snqvovhsjpqs"."public"."product_performance__dbt_backup" cascade
[0m21:27:04.804374 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "model.ecommerce_project.orders_by_customer"} */
drop table if exists "d9snqvovhsjpqs"."public"."orders_by_customer__dbt_backup" cascade
[0m21:27:04.818415 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.040 seconds
[0m21:27:04.819456 [debug] [Thread-3 (]: On model.ecommerce_project.orders_by_day: Close
[0m21:27:04.819928 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ad430>]}
[0m21:27:04.820312 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public.orders_by_day ........................ [[32mSELECT 282[0m in 0.59s]
[0m21:27:04.820737 [debug] [Thread-3 (]: Finished running node model.ecommerce_project.orders_by_day
[0m21:27:04.844018 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.040 seconds
[0m21:27:04.845060 [debug] [Thread-4 (]: On model.ecommerce_project.top_10_customers_by_revenue: Close
[0m21:27:04.845520 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd2390>]}
[0m21:27:04.845900 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public.top_10_customers_by_revenue ......... [[32mSELECT 10[0m in 0.56s]
[0m21:27:04.846249 [debug] [Thread-4 (]: Finished running node model.ecommerce_project.top_10_customers_by_revenue
[0m21:27:04.846451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.042 seconds
[0m21:27:04.846727 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m21:27:04.847680 [debug] [Thread-1 (]: On model.ecommerce_project.product_performance: Close
[0m21:27:04.848466 [debug] [Thread-2 (]: On model.ecommerce_project.orders_by_customer: Close
[0m21:27:04.848845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107650d10>]}
[0m21:27:04.849190 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c57c4b4c-7dbb-4c1a-bac3-cada68ef3e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107683590>]}
[0m21:27:04.849633 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public.product_performance ................. [[32mSELECT 4[0m in 0.57s]
[0m21:27:04.850023 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public.orders_by_customer ................... [[32mSELECT 642[0m in 0.62s]
[0m21:27:04.850430 [debug] [Thread-1 (]: Finished running node model.ecommerce_project.product_performance
[0m21:27:04.850751 [debug] [Thread-2 (]: Finished running node model.ecommerce_project.orders_by_customer
[0m21:27:04.851737 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:04.851988 [debug] [MainThread]: On master: BEGIN
[0m21:27:04.852153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:05.140860 [debug] [MainThread]: SQL status: BEGIN in 0.289 seconds
[0m21:27:05.141263 [debug] [MainThread]: On master: COMMIT
[0m21:27:05.141527 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:05.141731 [debug] [MainThread]: On master: COMMIT
[0m21:27:05.172755 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m21:27:05.173060 [debug] [MainThread]: On master: Close
[0m21:27:05.173464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:05.173645 [debug] [MainThread]: Connection 'model.ecommerce_project.product_performance' was properly closed.
[0m21:27:05.173805 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_customer' was properly closed.
[0m21:27:05.173953 [debug] [MainThread]: Connection 'model.ecommerce_project.orders_by_day' was properly closed.
[0m21:27:05.174103 [debug] [MainThread]: Connection 'model.ecommerce_project.top_10_customers_by_revenue' was properly closed.
[0m21:27:05.174348 [info ] [MainThread]: 
[0m21:27:05.174551 [info ] [MainThread]: Finished running 3 view models, 8 table models in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m21:27:05.176297 [debug] [MainThread]: Command end result
[0m21:27:05.197404 [info ] [MainThread]: 
[0m21:27:05.197730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:05.197931 [info ] [MainThread]: 
[0m21:27:05.198130 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m21:27:05.199176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0277185, "process_user_time": 1.473524, "process_kernel_time": 0.183504, "process_mem_max_rss": "127582208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:05.199518 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:05.199460 after 4.03 seconds
[0m21:27:05.199756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105311310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d07a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d07a10>]}
[0m21:27:05.199979 [debug] [MainThread]: Flushing usage events
[0m21:27:05.238027 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:27:13.399883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104773c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104773ed0>]}


============================== 21:27:13.402521 | 93db4245-1ed1-4bf4-8cd3-457efbcc295a ==============================
[0m21:27:13.402521 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:13.402852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:27:13.440441 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:27:13.440780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a8510>]}
[0m21:27:13.489378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447bce0>]}
[0m21:27:13.518987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453ba50>]}
[0m21:27:13.519588 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:27:13.528978 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:13.592252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:13.592518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:13.595759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:27:13.617436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e62210>]}
[0m21:27:13.680644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105609550>]}
[0m21:27:13.680929 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:27:13.681098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93db4245-1ed1-4bf4-8cd3-457efbcc295a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105611090>]}
[0m21:27:13.682240 [info ] [MainThread]: 
[0m21:27:13.682410 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:27:13.683314 [debug] [MainThread]: Command end result
[0m21:27:13.697694 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.33808175, "process_user_time": 0.931053, "process_kernel_time": 0.116274, "process_mem_max_rss": "112377856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:13.698166 [debug] [MainThread]: Command `dbt test` succeeded at 21:27:13.698096 after 0.34 seconds
[0m21:27:13.698417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550bcd0>]}
[0m21:27:13.698614 [debug] [MainThread]: Flushing usage events
[0m21:27:13.705455 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m21:27:26.047954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3ed0>]}


============================== 21:27:26.050817 | 1848d315-4c7a-48e4-8984-8f490705d4e7 ==============================
[0m21:27:26.050817 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:26.051186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/11nho/Developer/DataEngineering/dbt-project', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/11nho/Developer/DataEngineering/dbt-project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:26.088184 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:27:26.088482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e8510>]}
[0m21:27:26.137764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af7ce0>]}
[0m21:27:26.165923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106defa50>]}
[0m21:27:26.166435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:27:26.176788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:26.242013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:26.242306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:26.245405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:27:26.265875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12048a210>]}
[0m21:27:26.322127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a25f0>]}
[0m21:27:26.322405 [info ] [MainThread]: Found 11 models, 1 snapshot, 3 sources, 424 macros
[0m21:27:26.322573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107943ee0>]}
[0m21:27:26.323608 [info ] [MainThread]: 
[0m21:27:26.323926 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:26.324338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs'
[0m21:27:26.353168 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs"
[0m21:27:26.353441 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs"} */

    select distinct nspname from pg_namespace
  
[0m21:27:26.353603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:26.930627 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.577 seconds
[0m21:27:26.934151 [debug] [ThreadPool]: On list_d9snqvovhsjpqs: Close
[0m21:27:26.938186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs, now list_d9snqvovhsjpqs_public)
[0m21:27:26.938569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_d9snqvovhsjpqs_snapshots'
[0m21:27:26.942866 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:26.943881 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:26.944090 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: BEGIN
[0m21:27:26.944349 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: BEGIN
[0m21:27:26.944562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:26.944754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:27.248875 [debug] [ThreadPool]: SQL status: BEGIN in 0.304 seconds
[0m21:27:27.250023 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_snapshots"
[0m21:27:27.250506 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_snapshots"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m21:27:27.288559 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.037 seconds
[0m21:27:27.291864 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: ROLLBACK
[0m21:27:27.295065 [debug] [ThreadPool]: SQL status: BEGIN in 0.350 seconds
[0m21:27:27.295903 [debug] [ThreadPool]: Using postgres connection "list_d9snqvovhsjpqs_public"
[0m21:27:27.296801 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "list_d9snqvovhsjpqs_public"} */
select
      'd9snqvovhsjpqs' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'd9snqvovhsjpqs' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:27:27.325268 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_snapshots: Close
[0m21:27:27.339220 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.042 seconds
[0m21:27:27.342344 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: ROLLBACK
[0m21:27:27.379647 [debug] [ThreadPool]: On list_d9snqvovhsjpqs_public: Close
[0m21:27:27.391180 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:27.391674 [debug] [MainThread]: On master: BEGIN
[0m21:27:27.392000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:27.727914 [debug] [MainThread]: SQL status: BEGIN in 0.336 seconds
[0m21:27:27.728738 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:27.729610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:27.776579 [debug] [MainThread]: SQL status: SELECT 3 in 0.046 seconds
[0m21:27:27.780504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12061ec90>]}
[0m21:27:27.780907 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:27.816608 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:27.817282 [debug] [MainThread]: On master: BEGIN
[0m21:27:27.891379 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:27:27.891711 [debug] [MainThread]: On master: COMMIT
[0m21:27:27.891896 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:27.892057 [debug] [MainThread]: On master: COMMIT
[0m21:27:27.923452 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m21:27:27.924349 [debug] [MainThread]: On master: Close
[0m21:27:27.925655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:27.926356 [info ] [MainThread]: 
[0m21:27:27.929256 [debug] [Thread-1 (]: Began running node snapshot.ecommerce_project.sales_snapshot
[0m21:27:27.929698 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.sales_snapshot ................................. [RUN]
[0m21:27:27.930060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_d9snqvovhsjpqs_public, now snapshot.ecommerce_project.sales_snapshot)
[0m21:27:27.930308 [debug] [Thread-1 (]: Began compiling node snapshot.ecommerce_project.sales_snapshot
[0m21:27:27.937199 [debug] [Thread-1 (]: Began executing node snapshot.ecommerce_project.sales_snapshot
[0m21:27:27.978997 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:27.979355 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: BEGIN
[0m21:27:27.979564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:28.277852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.298 seconds
[0m21:27:28.279399 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.280152 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:27:28.323789 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.043 seconds
[0m21:27:28.346641 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.347045 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

        
  
    

  create temporary table "sales_snapshot__dbt_tmp212728341445"
  
  
    as
  
  (
    

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m21:27:28.394932 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.047 seconds
[0m21:27:28.396760 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.397045 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp212728341445'
        
      order by ordinal_position

  
[0m21:27:28.436148 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.039 seconds
[0m21:27:28.441271 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.442009 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:27:28.475772 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.033 seconds
[0m21:27:28.478444 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.478743 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp212728341445'
        
      order by ordinal_position

  
[0m21:27:28.515862 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.036 seconds
[0m21:27:28.519935 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.520205 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "d9snqvovhsjpqs".INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m21:27:28.556241 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.035 seconds
[0m21:27:28.564280 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.564589 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sales_snapshot__dbt_tmp212728341445'
        
      order by ordinal_position

  
[0m21:27:28.596284 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.031 seconds
[0m21:27:28.609780 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.610126 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        

    with snapshot_query as (

        
    

    SELECT * FROM "d9snqvovhsjpqs"."public"."stg_sales"


    ),

    snapshotted_data as (

        select *,
            order_id as dbt_unique_key

        from "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            nullif(order_date, order_date) as dbt_valid_to,
            md5(coalesce(cast(order_id as varchar ), '')
         || '|' || coalesce(cast(order_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            order_id as dbt_unique_key,
            order_date as dbt_updated_at,
            order_date as dbt_valid_from,
            order_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.order_date)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.order_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m21:27:28.641975 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m21:27:28.645778 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.646069 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m21:27:28.682011 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m21:27:28.683457 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.685350 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.685713 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.ecommerce_project.sales_snapshot"} */

      update "d9snqvovhsjpqs"."snapshots"."sales_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "sales_snapshot__dbt_tmp212728341445" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "d9snqvovhsjpqs"."snapshots"."sales_snapshot".dbt_valid_to is null;

    insert into "d9snqvovhsjpqs"."snapshots"."sales_snapshot" ("order_id", "customer_id", "product_id", "order_date", "quantity", "total_price", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."order_id",DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."product_id",DBT_INTERNAL_SOURCE."order_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."total_price",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "sales_snapshot__dbt_tmp212728341445" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m21:27:28.718346 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.032 seconds
[0m21:27:28.731849 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m21:27:28.732186 [debug] [Thread-1 (]: Using postgres connection "snapshot.ecommerce_project.sales_snapshot"
[0m21:27:28.732403 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: COMMIT
[0m21:27:28.761920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m21:27:28.764472 [debug] [Thread-1 (]: On snapshot.ecommerce_project.sales_snapshot: Close
[0m21:27:28.765934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1848d315-4c7a-48e4-8984-8f490705d4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209c95a0>]}
[0m21:27:28.766473 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.sales_snapshot ................................. [[32mINSERT 0 0[0m in 0.83s]
[0m21:27:28.766900 [debug] [Thread-1 (]: Finished running node snapshot.ecommerce_project.sales_snapshot
[0m21:27:28.767945 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.768170 [debug] [MainThread]: On master: BEGIN
[0m21:27:28.768382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:29.059183 [debug] [MainThread]: SQL status: BEGIN in 0.290 seconds
[0m21:27:29.060279 [debug] [MainThread]: On master: COMMIT
[0m21:27:29.060951 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:29.061231 [debug] [MainThread]: On master: COMMIT
[0m21:27:29.092536 [debug] [MainThread]: SQL status: COMMIT in 0.031 seconds
[0m21:27:29.093199 [debug] [MainThread]: On master: Close
[0m21:27:29.094324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:29.094815 [debug] [MainThread]: Connection 'snapshot.ecommerce_project.sales_snapshot' was properly closed.
[0m21:27:29.095234 [debug] [MainThread]: Connection 'list_d9snqvovhsjpqs_snapshots' was properly closed.
[0m21:27:29.095752 [info ] [MainThread]: 
[0m21:27:29.096451 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m21:27:29.097695 [debug] [MainThread]: Command end result
[0m21:27:29.126153 [info ] [MainThread]: 
[0m21:27:29.126513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:29.126718 [info ] [MainThread]: 
[0m21:27:29.126916 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:27:29.128013 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 3.1185865, "process_user_time": 1.211721, "process_kernel_time": 0.158568, "process_mem_max_rss": "122306560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:29.128561 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:27:29.128422 after 3.12 seconds
[0m21:27:29.128939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12090f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12082b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120525bd0>]}
[0m21:27:29.129217 [debug] [MainThread]: Flushing usage events
[0m21:27:29.221917 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
